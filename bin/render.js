"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.render = render;
exports.renderPlainGlyph = renderPlainGlyph;
exports.renderText = renderText;
exports.renderImage = renderImage;

var _path = require("./path");

var _v = _interopRequireDefault(require("uuid/v4"));

var _svgPathParser = require("svg-path-parser");

var _helper = require("./helper");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance"); }

function _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function render(dom, baseDom) {
  if (dom instanceof SVGTextElement || dom instanceof SVGImageElement) {
    return [];
  } else if (dom instanceof SVGGElement) {
    return renderGroup(dom, baseDom);
  } else {
    return renderGlyph(dom, baseDom);
  }
}

function addVisualEncodings(items, styles, dom, baseDom) {
  if (styles.stroke && styles.stroke !== 'none') {
    items.push({
      ty: 'st',
      c: {
        k: styles.stroke.split('(')[1].split(')')[0].split(',').slice(0, 3).map(function (raw) {
          return parseInt(raw) / 255;
        }).concat(1)
      },
      o: {
        k: parseFloat(styles.strokeOpacity || '1') * 100
      },
      w: {
        k: parseFloat(styles.strokeWidth || '1')
      },
      lc: (0, _helper.encodeLineCap)(styles.strokeLinecap),
      lj: (0, _helper.encodeLineJoin)(styles.strokeLinejoin)
    });
  }

  if (styles.fill && styles.fill !== 'none') {
    items.push({
      ty: 'fl',
      c: {
        k: styles.fill.split('(')[1].split(')')[0].split(',').slice(0, 3).map(function (raw) {
          return parseInt(raw) / 255;
        }).concat(1)
      },
      o: {
        k: parseFloat(styles.fillOpacity || '1') * 100
      }
    });
  }

  var posX = 0,
      posY = 0;

  if (dom && baseDom) {
    var baseTransform = (0, _helper.calculateBaseTransform)(dom, baseDom);
    var baseBBox = baseDom.getBBox();
    var refBBox = dom.getBBox();
    posX = baseTransform.e + refBBox.x - baseBBox.x;
    posY = baseTransform.f + refBBox.y - baseBBox.y;
  }

  items.push({
    ty: "tr",
    p: {
      k: [posX, posY]
    },
    a: {
      k: [0, 0]
    },
    s: {
      k: [100, 100]
    },
    r: {
      k: 0
    },
    o: {
      k: parseFloat(styles.opacity || '1') * 100
    },
    sk: {
      k: 0
    },
    sa: {
      k: 0
    }
  });
}

function renderGlyph(dom, baseDom) {
  var group = {
    ty: "gr",
    it: [],
    bm: 0,
    hd: false
  };

  var postActions = function postActions(pathMaker) {
    pathMaker.uniform();
    group.it.push({
      ty: 'sh',
      ks: {
        k: pathMaker.path,
        a: 0
      },
      nm: dom.id,
      hd: false
    });
    var styles = window.getComputedStyle(dom);
    addVisualEncodings(group.it, styles, dom, baseDom);
  };

  if (dom instanceof SVGCircleElement) {
    var svgLength = dom.r.baseVal;
    svgLength.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
    var r = svgLength.valueInSpecifiedUnits;
    var pathMaker = new _path.PathMaker();
    pathMaker.moveTo(r, 0);
    pathMaker.arcTo(r, r, 0, 1, 0, r, 2 * r);
    pathMaker.arcTo(r, r, 0, 1, 0, r, 0);
    pathMaker.closePath();
    postActions(pathMaker);
  } else if (dom instanceof SVGEllipseElement) {
    var mapKey = ['rx', 'ry'];

    var _mapKey$map = mapKey.map(function (key) {
      var svgLength = dom[key].baseVal;
      svgLength.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
      return svgLength.valueInSpecifiedUnits;
    }),
        _mapKey$map2 = _slicedToArray(_mapKey$map, 2),
        rx = _mapKey$map2[0],
        ry = _mapKey$map2[1];

    var _pathMaker = new _path.PathMaker();

    _pathMaker.moveTo(rx, 0);

    _pathMaker.arcTo(rx, ry, 0, 1, 0, rx, 2 * ry);

    _pathMaker.arcTo(rx, ry, 0, 1, 0, rx, 0);

    _pathMaker.closePath();

    postActions(_pathMaker);
  } else if (dom instanceof SVGLineElement) {
    var _mapKey = ['x1', 'x2', 'y1', 'y2'];

    var _mapKey$map3 = _mapKey.map(function (key) {
      var svgLength = dom[key].baseVal;
      svgLength.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
      return svgLength.valueInSpecifiedUnits;
    }),
        _mapKey$map4 = _slicedToArray(_mapKey$map3, 4),
        x1 = _mapKey$map4[0],
        x2 = _mapKey$map4[1],
        y1 = _mapKey$map4[2],
        y2 = _mapKey$map4[3];

    var offsetX = Math.min(x1, x2);
    var offsetY = Math.min(y1, y2);

    var _pathMaker2 = new _path.PathMaker();

    _pathMaker2.moveTo(x1 - offsetX, y1 - offsetY);

    _pathMaker2.lineTo(x2 - offsetX, y2 - offsetY);

    postActions(_pathMaker2);
  } else if (dom instanceof SVGPathElement) {
    var pathData = dom.getAttribute('d') || '';
    var pathDataSeries = (0, _svgPathParser.parseSVG)(pathData);

    var _pathMaker3 = new _path.PathMaker();

    var pathDataWithType;
    pathDataSeries.forEach(function (pathDataItem) {
      switch (pathDataItem.code) {
        case 'M':
          pathDataWithType = pathDataItem;

          _pathMaker3.moveTo(pathDataWithType.x, pathDataWithType.y);

          break;

        case 'L':
          pathDataWithType = pathDataItem;

          _pathMaker3.lineTo(pathDataWithType.x, pathDataWithType.y);

          break;

        case 'l':
          pathDataWithType = pathDataItem;

          _pathMaker3.lineToRelative(pathDataWithType.x, pathDataWithType.y);

          break;

        case 'H':
          pathDataWithType = pathDataItem;

          _pathMaker3.horizontalTo(pathDataWithType.x);

          break;

        case 'h':
          pathDataWithType = pathDataItem;

          _pathMaker3.horizontalToRelative(pathDataWithType.x);

          break;

        case 'V':
          pathDataWithType = pathDataItem;

          _pathMaker3.verticalTo(pathDataWithType.y);

          break;

        case 'v':
          pathDataWithType = pathDataItem;

          _pathMaker3.verticalToRelative(pathDataWithType.y);

          break;

        case 'C':
          pathDataWithType = pathDataItem;

          _pathMaker3.cubicBezierCurveTo(pathDataWithType.x1, pathDataWithType.y1, pathDataWithType.x2, pathDataWithType.y2, pathDataWithType.x, pathDataWithType.y);

          break;

        case 'c':
          pathDataWithType = pathDataItem;

          _pathMaker3.cubicBezierCurveToRelative(pathDataWithType.x1, pathDataWithType.y1, pathDataWithType.x2, pathDataWithType.y2, pathDataWithType.x, pathDataWithType.y);

          break;

        case 'Q':
          pathDataWithType = pathDataItem;

          _pathMaker3.quadraticBezierCurveTo(pathDataWithType.x1, pathDataWithType.y1, pathDataWithType.x, pathDataWithType.y);

          break;

        case 'q':
          pathDataWithType = pathDataItem;

          _pathMaker3.quadraticBezierCurveToRelative(pathDataWithType.x1, pathDataWithType.y1, pathDataWithType.x, pathDataWithType.y);

          break;

        case 'A':
          pathDataWithType = pathDataItem;

          _pathMaker3.arcTo(pathDataWithType.rx, pathDataWithType.ry, pathDataWithType.xAxisRotation, ~~pathDataWithType.largeArc, ~~pathDataWithType.sweep, pathDataWithType.x, pathDataWithType.y);

          break;

        case 'a':
          pathDataWithType = pathDataItem;

          _pathMaker3.arcToRelative(pathDataWithType.rx, pathDataWithType.ry, pathDataWithType.xAxisRotation, ~~pathDataWithType.largeArc, ~~pathDataWithType.sweep, pathDataWithType.x, pathDataWithType.y);

          break;

        case 'Z':
        case 'z':
          _pathMaker3.closePath();

          break;

        default:
          console.error(pathDataItem);
          throw new Error('No implementation found for this path command.');
      }
    });
    postActions(_pathMaker3);
  } else if (dom instanceof SVGPolygonElement || dom instanceof SVGPolylineElement) {
    var points = dom.points;

    if (points.length) {
      var iterablePoints = Array.prototype.slice.call(points);

      var _offsetX = iterablePoints.reduce(function (p, v) {
        return Math.min(p, v.x);
      }, 0);

      var _offsetY = iterablePoints.reduce(function (p, v) {
        return Math.min(p, v.y);
      }, 0);

      var _pathMaker4 = new _path.PathMaker();

      _pathMaker4.moveTo(points[0].x - _offsetX, points[0].y - _offsetY);

      iterablePoints.forEach(function (v, i) {
        if (i <= 0) return;

        _pathMaker4.lineTo(v.x - _offsetX, v.y - _offsetY);
      });

      if (dom instanceof SVGPolygonElement) {
        _pathMaker4.closePath();
      }

      postActions(_pathMaker4);
    }
  } else if (dom instanceof SVGRectElement) {
    var _mapKey2 = ['width', 'height'];

    var _mapKey2$map = _mapKey2.map(function (key) {
      var svgLength = dom[key].baseVal;
      svgLength.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
      return svgLength.valueInSpecifiedUnits;
    }),
        _mapKey2$map2 = _slicedToArray(_mapKey2$map, 2),
        width = _mapKey2$map2[0],
        height = _mapKey2$map2[1];

    var _pathMaker5 = new _path.PathMaker();

    _pathMaker5.moveTo(0, 0);

    _pathMaker5.lineTo(width, 0);

    _pathMaker5.lineTo(width, height);

    _pathMaker5.lineTo(0, height);

    _pathMaker5.closePath();

    postActions(_pathMaker5);
  } else {
    console.error(dom);
    throw new Error('No implementation found for svg graphics element.');
  }

  return [group];
}

function renderGroup(dom, baseDom) {
  var items = [];
  dom.childNodes.forEach(function (node) {
    if (node instanceof SVGGraphicsElement) {
      items = render(node, baseDom || dom).concat(items);
    }
  });
  return items;
}

function renderPlainGlyph(type, args) {
  var group = {
    ty: "gr",
    it: [{
      ty: 'sh',
      ks: {
        k: null,
        a: 0
      },
      hd: false
    }, {
      ty: 'st',
      c: {
        k: [1, 1, 1, 1]
      },
      w: {
        k: 1
      },
      o: {
        k: 100
      },
      lc: (0, _helper.encodeLineCap)('butt'),
      lj: (0, _helper.encodeLineJoin)('miter')
    }, {
      ty: 'fl',
      c: {
        k: [1, 1, 1, 1]
      },
      o: {
        k: 100
      }
    }, {
      ty: 'tr',
      p: {
        k: [0, 0]
      },
      a: {
        k: [0, 0]
      },
      s: {
        k: [100, 100]
      },
      r: {
        k: 0
      },
      o: {
        k: 100
      },
      sk: {
        k: 0
      },
      sa: {
        k: 0
      }
    }],
    bm: 0,
    hd: false
  };
  var pathMaker = new _path.PathMaker();

  switch (type) {
    case 'rect':
      pathMaker.moveTo(0, 0);
      pathMaker.lineTo(args[0], 0);
      pathMaker.lineTo(args[0], args[1]);
      pathMaker.lineTo(0, args[1]);
      pathMaker.closePath();
      break;

    case 'ellipse':
      pathMaker.moveTo(args[0], 0);
      pathMaker.arcTo(args[0], args[1], 0, 1, 0, args[0], 2 * args[1]);
      pathMaker.arcTo(args[0], args[1], 0, 1, 0, args[0], 0);
      pathMaker.closePath();
  }

  pathMaker.uniform();
  group.it[0].ks.k = pathMaker.path;
  return group;
}

function renderText(dom, fontList) {
  var computedStyle = getComputedStyle(dom);
  var fontSize = parseFloat(computedStyle.fontSize),
      fontFamily = computedStyle.fontFamily.split(',')[0].trim(),
      fontStyle = computedStyle.fontStyle,
      fontWeight = computedStyle.fontWeight,
      fontColor = (computedStyle.color || 'rgb(0,0,0)').split('(')[1].split(')')[0].split(',').map(function (i) {
    return parseInt(i) / 255;
  });
  var fontName = (0, _v["default"])();

  if (fontList) {
    var fontExist = fontList.list.filter(function (font) {
      return font.fFamily == fontFamily && font.fStyle == fontStyle && font.fWeight == fontWeight;
    });
    if (fontExist.length) fontName = fontExist[0].fName;
  }

  var textData = {
    d: {
      k: [{
        t: 0,
        s: {
          s: fontSize,
          f: fontName,
          t: dom.innerHTML,
          j: 0,
          tr: 0,
          ls: 0,
          fc: fontColor
        }
      }]
    },
    p: {},
    m: {
      a: {
        k: [0, 0]
      }
    },
    a: []
  };
  var fontDef = {
    fFamily: fontFamily,
    fWeight: "".concat(fontWeight),
    fStyle: fontStyle,
    fName: fontName
  };
  return [textData, fontDef];
}

function renderImage(dom, assetList) {
  var id = (0, _v["default"])();
  var domHeightVal = dom.height.baseVal;
  domHeightVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
  var domWidthVal = dom.width.baseVal;
  domWidthVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
  var canvas = document.createElement('canvas');
  var ctx = canvas.getContext('2d');
  canvas.width = domWidthVal.valueInSpecifiedUnits * 3;
  canvas.height = domHeightVal.valueInSpecifiedUnits * 3;
  ctx.drawImage(dom, 0, 0, canvas.width, canvas.height);
  var dataUrl = canvas.toDataURL();

  if (assetList) {
    var assetExist = assetList.filter(function (asset) {
      return asset.p == dataUrl;
    });
    if (assetExist.length) id = assetExist[0].id;
  }

  var asset = {
    h: domHeightVal.valueInSpecifiedUnits,
    w: domWidthVal.valueInSpecifiedUnits,
    id: id,
    p: dataUrl,
    e: 1
  };
  return [id, asset];
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9yZW5kZXIudHMiXSwibmFtZXMiOlsicmVuZGVyIiwiZG9tIiwiYmFzZURvbSIsIlNWR1RleHRFbGVtZW50IiwiU1ZHSW1hZ2VFbGVtZW50IiwiU1ZHR0VsZW1lbnQiLCJyZW5kZXJHcm91cCIsInJlbmRlckdseXBoIiwiYWRkVmlzdWFsRW5jb2RpbmdzIiwiaXRlbXMiLCJzdHlsZXMiLCJzdHJva2UiLCJwdXNoIiwidHkiLCJjIiwiayIsInNwbGl0Iiwic2xpY2UiLCJtYXAiLCJyYXciLCJwYXJzZUludCIsImNvbmNhdCIsIm8iLCJwYXJzZUZsb2F0Iiwic3Ryb2tlT3BhY2l0eSIsInciLCJzdHJva2VXaWR0aCIsImxjIiwic3Ryb2tlTGluZWNhcCIsImxqIiwic3Ryb2tlTGluZWpvaW4iLCJmaWxsIiwiZmlsbE9wYWNpdHkiLCJwb3NYIiwicG9zWSIsImJhc2VUcmFuc2Zvcm0iLCJiYXNlQkJveCIsImdldEJCb3giLCJyZWZCQm94IiwiZSIsIngiLCJmIiwieSIsInAiLCJhIiwicyIsInIiLCJvcGFjaXR5Iiwic2siLCJzYSIsImdyb3VwIiwiaXQiLCJibSIsImhkIiwicG9zdEFjdGlvbnMiLCJwYXRoTWFrZXIiLCJ1bmlmb3JtIiwia3MiLCJwYXRoIiwibm0iLCJpZCIsIndpbmRvdyIsImdldENvbXB1dGVkU3R5bGUiLCJTVkdDaXJjbGVFbGVtZW50Iiwic3ZnTGVuZ3RoIiwiYmFzZVZhbCIsImNvbnZlcnRUb1NwZWNpZmllZFVuaXRzIiwiU1ZHTGVuZ3RoIiwiU1ZHX0xFTkdUSFRZUEVfUFgiLCJ2YWx1ZUluU3BlY2lmaWVkVW5pdHMiLCJQYXRoTWFrZXIiLCJtb3ZlVG8iLCJhcmNUbyIsImNsb3NlUGF0aCIsIlNWR0VsbGlwc2VFbGVtZW50IiwibWFwS2V5Iiwia2V5IiwicngiLCJyeSIsIlNWR0xpbmVFbGVtZW50IiwieDEiLCJ4MiIsInkxIiwieTIiLCJvZmZzZXRYIiwiTWF0aCIsIm1pbiIsIm9mZnNldFkiLCJsaW5lVG8iLCJTVkdQYXRoRWxlbWVudCIsInBhdGhEYXRhIiwiZ2V0QXR0cmlidXRlIiwicGF0aERhdGFTZXJpZXMiLCJwYXRoRGF0YVdpdGhUeXBlIiwiZm9yRWFjaCIsInBhdGhEYXRhSXRlbSIsImNvZGUiLCJsaW5lVG9SZWxhdGl2ZSIsImhvcml6b250YWxUbyIsImhvcml6b250YWxUb1JlbGF0aXZlIiwidmVydGljYWxUbyIsInZlcnRpY2FsVG9SZWxhdGl2ZSIsImN1YmljQmV6aWVyQ3VydmVUbyIsImN1YmljQmV6aWVyQ3VydmVUb1JlbGF0aXZlIiwicXVhZHJhdGljQmV6aWVyQ3VydmVUbyIsInF1YWRyYXRpY0JlemllckN1cnZlVG9SZWxhdGl2ZSIsInhBeGlzUm90YXRpb24iLCJsYXJnZUFyYyIsInN3ZWVwIiwiYXJjVG9SZWxhdGl2ZSIsImNvbnNvbGUiLCJlcnJvciIsIkVycm9yIiwiU1ZHUG9seWdvbkVsZW1lbnQiLCJTVkdQb2x5bGluZUVsZW1lbnQiLCJwb2ludHMiLCJsZW5ndGgiLCJpdGVyYWJsZVBvaW50cyIsIkFycmF5IiwicHJvdG90eXBlIiwiY2FsbCIsInJlZHVjZSIsInYiLCJpIiwiU1ZHUmVjdEVsZW1lbnQiLCJ3aWR0aCIsImhlaWdodCIsImNoaWxkTm9kZXMiLCJub2RlIiwiU1ZHR3JhcGhpY3NFbGVtZW50IiwicmVuZGVyUGxhaW5HbHlwaCIsInR5cGUiLCJhcmdzIiwicmVuZGVyVGV4dCIsImZvbnRMaXN0IiwiY29tcHV0ZWRTdHlsZSIsImZvbnRTaXplIiwiZm9udEZhbWlseSIsInRyaW0iLCJmb250U3R5bGUiLCJmb250V2VpZ2h0IiwiZm9udENvbG9yIiwiY29sb3IiLCJmb250TmFtZSIsImZvbnRFeGlzdCIsImxpc3QiLCJmaWx0ZXIiLCJmb250IiwiZkZhbWlseSIsImZTdHlsZSIsImZXZWlnaHQiLCJmTmFtZSIsInRleHREYXRhIiwiZCIsInQiLCJpbm5lckhUTUwiLCJqIiwidHIiLCJscyIsImZjIiwibSIsImZvbnREZWYiLCJyZW5kZXJJbWFnZSIsImFzc2V0TGlzdCIsImRvbUhlaWdodFZhbCIsImRvbVdpZHRoVmFsIiwiY2FudmFzIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY3R4IiwiZ2V0Q29udGV4dCIsImRyYXdJbWFnZSIsImRhdGFVcmwiLCJ0b0RhdGFVUkwiLCJhc3NldEV4aXN0IiwiYXNzZXQiLCJoIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7Ozs7Ozs7OztBQUdPLFNBQVNBLE1BQVQsQ0FBZ0JDLEdBQWhCLEVBQXlDQyxPQUF6QyxFQUFxRjtBQUN4RixNQUFJRCxHQUFHLFlBQVlFLGNBQWYsSUFBaUNGLEdBQUcsWUFBWUcsZUFBcEQsRUFBcUU7QUFDakUsV0FBTyxFQUFQO0FBQ0gsR0FGRCxNQUVPLElBQUlILEdBQUcsWUFBWUksV0FBbkIsRUFBZ0M7QUFDbkMsV0FBT0MsV0FBVyxDQUFDTCxHQUFELEVBQU1DLE9BQU4sQ0FBbEI7QUFDSCxHQUZNLE1BRUE7QUFDSCxXQUFPSyxXQUFXLENBQUNOLEdBQUQsRUFBTUMsT0FBTixDQUFsQjtBQUNIO0FBQ0o7O0FBSUQsU0FBU00sa0JBQVQsQ0FBNEJDLEtBQTVCLEVBQXNEQyxNQUF0RCxFQUFtRlQsR0FBbkYsRUFBNkdDLE9BQTdHLEVBQTJJO0FBQ3ZJLE1BQUlRLE1BQU0sQ0FBQ0MsTUFBUCxJQUFpQkQsTUFBTSxDQUFDQyxNQUFQLEtBQWtCLE1BQXZDLEVBQStDO0FBQzNDRixJQUFBQSxLQUFLLENBQUNHLElBQU4sQ0FBVztBQUNQQyxNQUFBQSxFQUFFLEVBQUUsSUFERztBQUVQQyxNQUFBQSxDQUFDLEVBQUU7QUFDQ0MsUUFBQUEsQ0FBQyxFQUFFTCxNQUFNLENBQUNDLE1BQVAsQ0FBZUssS0FBZixDQUFxQixHQUFyQixFQUEwQixDQUExQixFQUE2QkEsS0FBN0IsQ0FBbUMsR0FBbkMsRUFBd0MsQ0FBeEMsRUFBMkNBLEtBQTNDLENBQWlELEdBQWpELEVBQXNEQyxLQUF0RCxDQUE0RCxDQUE1RCxFQUErRCxDQUEvRCxFQUFrRUMsR0FBbEUsQ0FBc0UsVUFB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QixDQUF2QixFQUEwQnFLLE1BQU0sQ0FBQ3pDLEtBQWpDLEVBQXdDeUMsTUFBTSxDQUFDeEMsTUFBL0M7QUFFQSxNQUFNOEMsT0FBTyxHQUFHTixNQUFNLENBQUNPLFNBQVAsRUFBaEI7O0FBQ0EsTUFBSVYsU0FBSixFQUFlO0FBQ1gsUUFBTVcsVUFBVSxHQUFHWCxTQUFTLENBQUVqQixNQUFYLENBQWtCLFVBQUE2QixLQUFLO0FBQUEsYUFBSUEsS0FBSyxDQUFDcEksQ0FBTixJQUFXaUksT0FBZjtBQUFBLEtBQXZCLENBQW5CO0FBQ0EsUUFBSUUsVUFBVSxDQUFDMUQsTUFBZixFQUNJeEQsRUFBRSxHQUFHa0gsVUFBVSxDQUFDLENBQUQsQ0FBVixDQUFjbEgsRUFBbkI7QUFDUDs7QUFDRCxNQUFNbUgsS0FBSyxHQUFHO0FBQ1ZDLElBQUFBLENBQUMsRUFBRVosWUFBWSxDQUFDL0YscUJBRE47QUFFVjVDLElBQUFBLENBQUMsRUFBRTRJLFdBQVcsQ0FBQ2hHLHFCQUZMO0FBR1ZULElBQUFBLEVBQUUsRUFBRkEsRUFIVTtBQUlWakIsSUFBQUEsQ0FBQyxFQUFFaUksT0FKTztBQUtWckksSUFBQUEsQ0FBQyxFQUFFO0FBTE8sR0FBZDtBQU9BLFNBQU8sQ0FBQ3FCLEVBQUQsRUFBS21ILEtBQUwsQ0FBUDtBQUNIIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgR3JvdXBTaGFwZSwgVGV4dERhdGEsIFJlZmVyZW5jZUlELCBQYXRoU2hhcGUsIEZpbGxTaGFwZSwgU3Ryb2tlU2hhcGUsIFRyYW5zZm9ybVNoYXBlLCBJbWFnZUFzc2V0LCBGb250MSwgRm9udHMsIEFzc2V0cyB9IGZyb20gJy4vYW5pbWF0aW9uJ1xyXG5pbXBvcnQgeyBQYXRoTWFrZXIgfSBmcm9tICcuL3BhdGgnXHJcbmltcG9ydCB1dWlkIGZyb20gJ3V1aWQvdjQnXHJcbmltcG9ydCB7IHBhcnNlU1ZHLCBNb3ZlVG9Db21tYW5kLCBMaW5lVG9Db21tYW5kLCBIb3Jpem9udGFsTGluZVRvQ29tbWFuZCwgVmVydGljYWxMaW5lVG9Db21tYW5kLCBDdXJ2ZVRvQ29tbWFuZCwgUXVhZHJhdGljQ3VydmVUb0NvbW1hbmQsIEVsbGlwdGljYWxBcmNDb21tYW5kIH0gZnJvbSAnc3ZnLXBhdGgtcGFyc2VyJ1xyXG5pbXBvcnQgeyBjYWxjdWxhdGVCYXNlVHJhbnNmb3JtLCBlbmNvZGVMaW5lSm9pbiwgZW5jb2RlTGluZUNhcCB9IGZyb20gJy4vaGVscGVyJ1xyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXIoZG9tOiBTVkdHcmFwaGljc0VsZW1lbnQsIGJhc2VEb20/OiBTVkdHcmFwaGljc0VsZW1lbnQpOiBHcm91cFNoYXBlW10ge1xyXG4gICAgaWYgKGRvbSBpbnN0YW5jZW9mIFNWR1RleHRFbGVtZW50IHx8IGRvbSBpbnN0YW5jZW9mIFNWR0ltYWdlRWxlbWVudCkge1xyXG4gICAgICAgIHJldHVybiBbXVxyXG4gICAgfSBlbHNlIGlmIChkb20gaW5zdGFuY2VvZiBTVkdHRWxlbWVudCkge1xyXG4gICAgICAgIHJldHVybiByZW5kZXJHcm91cChkb20sIGJhc2VEb20pXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiByZW5kZXJHbHlwaChkb20sIGJhc2VEb20pXHJcbiAgICB9XHJcbn1cclxuXHJcbnR5cGUgVmlzdWFsR3JvdXBJdGVtID0gUGF0aFNoYXBlIHwgRmlsbFNoYXBlIHwgU3Ryb2tlU2hhcGUgfCBUcmFuc2Zvcm1TaGFwZVxyXG5cclxuZnVuY3Rpb24gYWRkVmlzdWFsRW5jb2RpbmdzKGl0ZW1zOiBWaXN1YWxHcm91cEl0ZW1bXSwgc3R5bGVzOiBDU1NTdHlsZURlY2xhcmF0aW9uLCBkb20/OiBTVkdHcmFwaGljc0VsZW1lbnQsIGJhc2VEb20/OiBTVkdHcmFwaGljc0VsZW1lbnQpIHtcclxuICAgIGlmIChzdHlsZXMuc3Ryb2tlICYmIHN0eWxlcy5zdHJva2UgIT09ICdub25lJykge1xyXG4gICAgICAgIGl0ZW1zLnB1c2goe1xyXG4gICAgICAgICAgICB0eTogJ3N0JyxcclxuICAgICAgICAgICAgYzoge1xyXG4gICAgICAgICAgICAgICAgazogc3R5bGVzLnN0cm9rZSEuc3BsaXQoJygnKVsxXS5zcGxpdCgnKScpWzBdLnNwbGl0KCcsJykuc2xpY2UoMCwgMykubWFwKChyYXc6IHN0cmluZykgPT4gcGFyc2VJbnQocmF3KSAvIDI1NSkuY29uY2F0KDEpXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG86IHtcclxuICAgICAgICAgICAgICAgIGs6IHBhcnNlRmxvYXQoc3R5bGVzLnN0cm9rZU9wYWNpdHkgfHwgJzEnKSAqIDEwMFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB3OiB7XHJcbiAgICAgICAgICAgICAgICBrOiBwYXJzZUZsb2F0KHN0eWxlcy5zdHJva2VXaWR0aCB8fCAnMScpXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxjOiBlbmNvZGVMaW5lQ2FwKHN0eWxlcy5zdHJva2VMaW5lY2FwKSxcclxuICAgICAgICAgICAgbGo6IGVuY29kZUxpbmVKb2luKHN0eWxlcy5zdHJva2VMaW5lam9pbilcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG4gICAgaWYgKHN0eWxlcy5maWxsICYmIHN0eWxlcy5maWxsICE9PSAnbm9uZScpIHtcclxuICAgICAgICBpdGVtcy5wdXNoKHtcclxuICAgICAgICAgICAgdHk6ICdmbCcsXHJcbiAgICAgICAgICAgIGM6IHtcclxuICAgICAgICAgICAgICAgIGs6IHN0eWxlcy5maWxsIS5zcGxpdCgnKCcpWzFdLnNwbGl0KCcpJylbMF0uc3BsaXQoJywnKS5zbGljZSgwLCAzKS5tYXAoKHJhdzogc3RyaW5nKSA9PiBwYXJzZUludChyYXcpIC8gMjU1KS5jb25jYXQoMSlcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbzoge1xyXG4gICAgICAgICAgICAgICAgazogcGFyc2VGbG9hdChzdHlsZXMuZmlsbE9wYWNpdHkgfHwgJzEnKSAqIDEwMFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuICAgIGxldCBwb3NYID0gMCwgcG9zWSA9IDBcclxuICAgIGlmIChkb20gJiYgYmFzZURvbSkge1xyXG4gICAgICAgIGNvbnN0IGJhc2VUcmFuc2Zvcm0gPSBjYWxjdWxhdGVCYXNlVHJhbnNmb3JtKGRvbSwgYmFzZURvbSlcclxuICAgICAgICBjb25zdCBiYXNlQkJveCA9IGJhc2VEb20uZ2V0QkJveCgpXHJcbiAgICAgICAgY29uc3QgcmVmQkJveCA9IGRvbS5nZXRCQm94KClcclxuICAgICAgICBwb3NYID0gYmFzZVRyYW5zZm9ybS5lICsgcmVmQkJveC54IC0gYmFzZUJCb3gueFxyXG4gICAgICAgIHBvc1kgPSBiYXNlVHJhbnNmb3JtLmYgKyByZWZCQm94LnkgLSBiYXNlQkJveC55XHJcbiAgICB9XHJcbiAgICBpdGVtcy5wdXNoKHtcclxuICAgICAgICB0eTogXCJ0clwiLFxyXG4gICAgICAgIHA6IHtcclxuICAgICAgICAgICAgazogW1xyXG4gICAgICAgICAgICAgICAgcG9zWCxcclxuICAgICAgICAgICAgICAgIHBvc1lcclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYToge1xyXG4gICAgICAgICAgICBrOiBbXHJcbiAgICAgICAgICAgICAgICAwLFxyXG4gICAgICAgICAgICAgICAgMFxyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzOiB7XHJcbiAgICAgICAgICAgIGs6IFtcclxuICAgICAgICAgICAgICAgIDEwMCxcclxuICAgICAgICAgICAgICAgIDEwMFxyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgfSxcclxuICAgICAgICByOiB7XHJcbiAgICAgICAgICAgIGs6IDBcclxuICAgICAgICB9LFxyXG4gICAgICAgIG86IHtcclxuICAgICAgICAgICAgazogcGFyc2VGbG9hdChzdHlsZXMub3BhY2l0eSB8fCAnMScpICogMTAwXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzazoge1xyXG4gICAgICAgICAgICBrOiAwXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzYToge1xyXG4gICAgICAgICAgICBrOiAwXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlckdseXBoKGRvbTogU1ZHR3JhcGhpY3NFbGVtZW50LCBiYXNlRG9tPzogU1ZHR3JhcGhpY3NFbGVtZW50KTogR3JvdXBTaGFwZVtdIHtcclxuICAgIGNvbnN0IGdyb3VwOiBHcm91cFNoYXBlID0ge1xyXG4gICAgICAgIHR5OiBcImdyXCIsXHJcbiAgICAgICAgaXQ6IFtdLFxyXG4gICAgICAgIGJtOiAwLFxyXG4gICAgICAgIGhkOiBmYWxzZVxyXG4gICAgfVxyXG4gICAgY29uc3QgcG9zdEFjdGlvbnMgPSAocGF0aE1ha2VyOiBQYXRoTWFrZXIpID0+IHtcclxuICAgICAgICBwYXRoTWFrZXIudW5pZm9ybSgpXHJcbiAgICAgICAgZ3JvdXAuaXQhLnB1c2goe1xyXG4gICAgICAgICAgICB0eTogJ3NoJyxcclxuICAgICAgICAgICAga3M6IHtcclxuICAgICAgICAgICAgICAgIGs6IHBhdGhNYWtlci5wYXRoLFxyXG4gICAgICAgICAgICAgICAgYTogMFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBubTogZG9tLmlkLFxyXG4gICAgICAgICAgICBoZDogZmFsc2VcclxuICAgICAgICB9KVxyXG4gICAgICAgIGNvbnN0IHN0eWxlcyA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGRvbSlcclxuICAgICAgICBhZGRWaXN1YWxFbmNvZGluZ3MoZ3JvdXAuaXQhIGFzIFZpc3VhbEdyb3VwSXRlbVtdLCBzdHlsZXMsIGRvbSwgYmFzZURvbSlcclxuICAgIH1cclxuICAgIGlmIChkb20gaW5zdGFuY2VvZiBTVkdDaXJjbGVFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3Qgc3ZnTGVuZ3RoID0gZG9tLnIuYmFzZVZhbFxyXG4gICAgICAgIHN2Z0xlbmd0aC5jb252ZXJ0VG9TcGVjaWZpZWRVbml0cyhTVkdMZW5ndGguU1ZHX0xFTkdUSFRZUEVfUFgpXHJcbiAgICAgICAgY29uc3QgciA9IHN2Z0xlbmd0aC52YWx1ZUluU3BlY2lmaWVkVW5pdHNcclxuICAgICAgICBjb25zdCBwYXRoTWFrZXIgPSBuZXcgUGF0aE1ha2VyKClcclxuICAgICAgICBwYXRoTWFrZXIubW92ZVRvKHIsIDApXHJcbiAgICAgICAgcGF0aE1ha2VyLmFyY1RvKHIsIHIsIDAsIDEsIDAsIHIsIDIgKiByKVxyXG4gICAgICAgIHBhdGhNYWtlci5hcmNUbyhyLCByLCAwLCAxLCAwLCByLCAwKVxyXG4gICAgICAgIHBhdGhNYWtlci5jbG9zZVBhdGgoKVxyXG4gICAgICAgIHBvc3RBY3Rpb25zKHBhdGhNYWtlcilcclxuICAgIH0gZWxzZSBpZiAoZG9tIGluc3RhbmNlb2YgU1ZHRWxsaXBzZUVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBtYXBLZXk6ICgncngnIHwgJ3J5JylbXSA9IFsncngnLCAncnknXVxyXG4gICAgICAgIGNvbnN0IFtyeCwgcnldID0gbWFwS2V5Lm1hcChrZXkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzdmdMZW5ndGggPSBkb21ba2V5XS5iYXNlVmFsXHJcbiAgICAgICAgICAgIHN2Z0xlbmd0aC5jb252ZXJ0VG9TcGVjaWZpZWRVbml0cyhTVkdMZW5ndGguU1ZHX0xFTkdUSFRZUEVfUFgpXHJcbiAgICAgICAgICAgIHJldHVybiBzdmdMZW5ndGgudmFsdWVJblNwZWNpZmllZFVuaXRzXHJcbiAgICAgICAgfSlcclxuICAgICAgICBjb25zdCBwYXRoTWFrZXIgPSBuZXcgUGF0aE1ha2VyKClcclxuICAgICAgICBwYXRoTWFrZXIubW92ZVRvKHJ4LCAwKVxyXG4gICAgICAgIHBhdGhNYWtlci5hcmNUbyhyeCwgcnksIDAsIDEsIDAsIHJ4LCAyICogcnkpXHJcbiAgICAgICAgcGF0aE1ha2VyLmFyY1RvKHJ4LCByeSwgMCwgMSwgMCwgcngsIDApXHJcbiAgICAgICAgcGF0aE1ha2VyLmNsb3NlUGF0aCgpXHJcbiAgICAgICAgcG9zdEFjdGlvbnMocGF0aE1ha2VyKVxyXG4gICAgfSBlbHNlIGlmIChkb20gaW5zdGFuY2VvZiBTVkdMaW5lRWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IG1hcEtleTogKCd4MScgfCAneDInIHwgJ3kxJyB8ICd5MicpW10gPSBbJ3gxJywgJ3gyJywgJ3kxJywgJ3kyJ11cclxuICAgICAgICBjb25zdCBbeDEsIHgyLCB5MSwgeTJdID0gbWFwS2V5Lm1hcChrZXkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzdmdMZW5ndGggPSBkb21ba2V5XS5iYXNlVmFsXHJcbiAgICAgICAgICAgIHN2Z0xlbmd0aC5jb252ZXJ0VG9TcGVjaWZpZWRVbml0cyhTVkdMZW5ndGguU1ZHX0xFTkdUSFRZUEVfUFgpXHJcbiAgICAgICAgICAgIHJldHVybiBzdmdMZW5ndGgudmFsdWVJblNwZWNpZmllZFVuaXRzXHJcbiAgICAgICAgfSlcclxuICAgICAgICBjb25zdCBvZmZzZXRYID0gTWF0aC5taW4oeDEsIHgyKVxyXG4gICAgICAgIGNvbnN0IG9mZnNldFkgPSBNYXRoLm1pbih5MSwgeTIpXHJcbiAgICAgICAgY29uc3QgcGF0aE1ha2VyID0gbmV3IFBhdGhNYWtlcigpXHJcbiAgICAgICAgcGF0aE1ha2VyLm1vdmVUbyh4MSAtIG9mZnNldFgsIHkxIC0gb2Zmc2V0WSlcclxuICAgICAgICBwYXRoTWFrZXIubGluZVRvKHgyIC0gb2Zmc2V0WCwgeTIgLSBvZmZzZXRZKVxyXG4gICAgICAgIHBvc3RBY3Rpb25zKHBhdGhNYWtlcilcclxuICAgIH0gZWxzZSBpZiAoZG9tIGluc3RhbmNlb2YgU1ZHUGF0aEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBwYXRoRGF0YSA9IGRvbS5nZXRBdHRyaWJ1dGUoJ2QnKSB8fCAnJ1xyXG4gICAgICAgIGNvbnN0IHBhdGhEYXRhU2VyaWVzID0gcGFyc2VTVkcocGF0aERhdGEpXHJcbiAgICAgICAgY29uc3QgcGF0aE1ha2VyID0gbmV3IFBhdGhNYWtlcigpXHJcbiAgICAgICAgbGV0IHBhdGhEYXRhV2l0aFR5cGU7XHJcbiAgICAgICAgcGF0aERhdGFTZXJpZXMuZm9yRWFjaChwYXRoRGF0YUl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHBhdGhEYXRhSXRlbS5jb2RlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdNJzpcclxuICAgICAgICAgICAgICAgICAgICBwYXRoRGF0YVdpdGhUeXBlID0gcGF0aERhdGFJdGVtIGFzIE1vdmVUb0NvbW1hbmRcclxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIubW92ZVRvKHBhdGhEYXRhV2l0aFR5cGUueCwgcGF0aERhdGFXaXRoVHlwZS55KVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICBjYXNlICdMJzpcclxuICAgICAgICAgICAgICAgICAgICBwYXRoRGF0YVdpdGhUeXBlID0gcGF0aERhdGFJdGVtIGFzIExpbmVUb0NvbW1hbmRcclxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIubGluZVRvKHBhdGhEYXRhV2l0aFR5cGUueCwgcGF0aERhdGFXaXRoVHlwZS55KVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICBjYXNlICdsJzpcclxuICAgICAgICAgICAgICAgICAgICBwYXRoRGF0YVdpdGhUeXBlID0gcGF0aERhdGFJdGVtIGFzIExpbmVUb0NvbW1hbmRcclxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIubGluZVRvUmVsYXRpdmUocGF0aERhdGFXaXRoVHlwZS54LCBwYXRoRGF0YVdpdGhUeXBlLnkpXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0gnOlxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhEYXRhV2l0aFR5cGUgPSBwYXRoRGF0YUl0ZW0gYXMgSG9yaXpvbnRhbExpbmVUb0NvbW1hbmRcclxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIuaG9yaXpvbnRhbFRvKHBhdGhEYXRhV2l0aFR5cGUueClcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnaCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aERhdGFXaXRoVHlwZSA9IHBhdGhEYXRhSXRlbSBhcyBIb3Jpem9udGFsTGluZVRvQ29tbWFuZFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5ob3Jpem9udGFsVG9SZWxhdGl2ZShwYXRoRGF0YVdpdGhUeXBlLngpXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ1YnOlxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhEYXRhV2l0aFR5cGUgPSBwYXRoRGF0YUl0ZW0gYXMgVmVydGljYWxMaW5lVG9Db21tYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aE1ha2VyLnZlcnRpY2FsVG8ocGF0aERhdGFXaXRoVHlwZS55KVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICBjYXNlICd2JzpcclxuICAgICAgICAgICAgICAgICAgICBwYXRoRGF0YVdpdGhUeXBlID0gcGF0aERhdGFJdGVtIGFzIFZlcnRpY2FsTGluZVRvQ29tbWFuZFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci52ZXJ0aWNhbFRvUmVsYXRpdmUocGF0aERhdGFXaXRoVHlwZS55KVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICBjYXNlICdDJzpcclxuICAgICAgICAgICAgICAgICAgICBwYXRoRGF0YVdpdGhUeXBlID0gcGF0aERhdGFJdGVtIGFzIEN1cnZlVG9Db21tYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aE1ha2VyLmN1YmljQmV6aWVyQ3VydmVUbyhwYXRoRGF0YVdpdGhUeXBlLngxLCBwYXRoRGF0YVdpdGhUeXBlLnkxLCBwYXRoRGF0YVdpdGhUeXBlLngyLCBwYXRoRGF0YVdpdGhUeXBlLnkyLCBwYXRoRGF0YVdpdGhUeXBlLngsIHBhdGhEYXRhV2l0aFR5cGUueSlcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnYyc6XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aERhdGFXaXRoVHlwZSA9IHBhdGhEYXRhSXRlbSBhcyBDdXJ2ZVRvQ29tbWFuZFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5jdWJpY0JlemllckN1cnZlVG9SZWxhdGl2ZShwYXRoRGF0YVdpdGhUeXBlLngxLCBwYXRoRGF0YVdpdGhUeXBlLnkxLCBwYXRoRGF0YVdpdGhUeXBlLngyLCBwYXRoRGF0YVdpdGhUeXBlLnkyLCBwYXRoRGF0YVdpdGhUeXBlLngsIHBhdGhEYXRhV2l0aFR5cGUueSlcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnUSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aERhdGFXaXRoVHlwZSA9IHBhdGhEYXRhSXRlbSBhcyBRdWFkcmF0aWNDdXJ2ZVRvQ29tbWFuZFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5xdWFkcmF0aWNCZXppZXJDdXJ2ZVRvKHBhdGhEYXRhV2l0aFR5cGUueDEsIHBhdGhEYXRhV2l0aFR5cGUueTEsIHBhdGhEYXRhV2l0aFR5cGUueCwgcGF0aERhdGFXaXRoVHlwZS55KVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICBjYXNlICdxJzpcclxuICAgICAgICAgICAgICAgICAgICBwYXRoRGF0YVdpdGhUeXBlID0gcGF0aERhdGFJdGVtIGFzIFF1YWRyYXRpY0N1cnZlVG9Db21tYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aE1ha2VyLnF1YWRyYXRpY0JlemllckN1cnZlVG9SZWxhdGl2ZShwYXRoRGF0YVdpdGhUeXBlLngxLCBwYXRoRGF0YVdpdGhUeXBlLnkxLCBwYXRoRGF0YVdpdGhUeXBlLngsIHBhdGhEYXRhV2l0aFR5cGUueSlcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnQSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aERhdGFXaXRoVHlwZSA9IHBhdGhEYXRhSXRlbSBhcyBFbGxpcHRpY2FsQXJjQ29tbWFuZFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5hcmNUbyhwYXRoRGF0YVdpdGhUeXBlLnJ4LCBwYXRoRGF0YVdpdGhUeXBlLnJ5LCBwYXRoRGF0YVdpdGhUeXBlLnhBeGlzUm90YXRpb24sIH5+cGF0aERhdGFXaXRoVHlwZS5sYXJnZUFyYywgfn5wYXRoRGF0YVdpdGhUeXBlLnN3ZWVwLCBwYXRoRGF0YVdpdGhUeXBlLngsIHBhdGhEYXRhV2l0aFR5cGUueSlcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnYSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aERhdGFXaXRoVHlwZSA9IHBhdGhEYXRhSXRlbSBhcyBFbGxpcHRpY2FsQXJjQ29tbWFuZFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5hcmNUb1JlbGF0aXZlKHBhdGhEYXRhV2l0aFR5cGUucngsIHBhdGhEYXRhV2l0aFR5cGUucnksIHBhdGhEYXRhV2l0aFR5cGUueEF4aXNSb3RhdGlvbiwgfn5wYXRoRGF0YVdpdGhUeXBlLmxhcmdlQXJjLCB+fnBhdGhEYXRhV2l0aFR5cGUuc3dlZXAsIHBhdGhEYXRhV2l0aFR5cGUueCwgcGF0aERhdGFXaXRoVHlwZS55KVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICBjYXNlICdaJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3onOlxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5jbG9zZVBhdGgoKVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IocGF0aERhdGFJdGVtKVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gaW1wbGVtZW50YXRpb24gZm91bmQgZm9yIHRoaXMgcGF0aCBjb21tYW5kLicpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIHBvc3RBY3Rpb25zKHBhdGhNYWtlcilcclxuICAgIH0gZWxzZSBpZiAoZG9tIGluc3RhbmNlb2YgU1ZHUG9seWdvbkVsZW1lbnQgfHwgZG9tIGluc3RhbmNlb2YgU1ZHUG9seWxpbmVFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgcG9pbnRzID0gZG9tLnBvaW50c1xyXG4gICAgICAgIGlmIChwb2ludHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGl0ZXJhYmxlUG9pbnRzOiBET01Qb2ludFtdID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwocG9pbnRzKVxyXG4gICAgICAgICAgICBjb25zdCBvZmZzZXRYID0gaXRlcmFibGVQb2ludHMucmVkdWNlKChwLCB2KSA9PiBNYXRoLm1pbihwLCB2LngpLCAwKVxyXG4gICAgICAgICAgICBjb25zdCBvZmZzZXRZID0gaXRlcmFibGVQb2ludHMucmVkdWNlKChwLCB2KSA9PiBNYXRoLm1pbihwLCB2LnkpLCAwKVxyXG4gICAgICAgICAgICBjb25zdCBwYXRoTWFrZXIgPSBuZXcgUGF0aE1ha2VyKClcclxuICAgICAgICAgICAgcGF0aE1ha2VyLm1vdmVUbyhwb2ludHNbMF0ueCAtIG9mZnNldFgsIHBvaW50c1swXS55IC0gb2Zmc2V0WSlcclxuICAgICAgICAgICAgaXRlcmFibGVQb2ludHMuZm9yRWFjaCgodiwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgPD0gMCkgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICBwYXRoTWFrZXIubGluZVRvKHYueCAtIG9mZnNldFgsIHYueSAtIG9mZnNldFkpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIGlmIChkb20gaW5zdGFuY2VvZiBTVkdQb2x5Z29uRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgcGF0aE1ha2VyLmNsb3NlUGF0aCgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcG9zdEFjdGlvbnMocGF0aE1ha2VyKVxyXG4gICAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAoZG9tIGluc3RhbmNlb2YgU1ZHUmVjdEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBtYXBLZXk6ICgnd2lkdGgnIHwgJ2hlaWdodCcpW10gPSBbJ3dpZHRoJywgJ2hlaWdodCddXHJcbiAgICAgICAgY29uc3QgW3dpZHRoLCBoZWlnaHRdID0gbWFwS2V5Lm1hcChrZXkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzdmdMZW5ndGggPSBkb21ba2V5XS5iYXNlVmFsXHJcbiAgICAgICAgICAgIHN2Z0xlbmd0aC5jb252ZXJ0VG9TcGVjaWZpZWRVbml0cyhTVkdMZW5ndGguU1ZHX0xFTkdUSFRZUEVfUFgpXHJcbiAgICAgICAgICAgIHJldHVybiBzdmdMZW5ndGgudmFsdWVJblNwZWNpZmllZFVuaXRzXHJcbiAgICAgICAgfSlcclxuICAgICAgICBjb25zdCBwYXRoTWFrZXIgPSBuZXcgUGF0aE1ha2VyKClcclxuICAgICAgICBwYXRoTWFrZXIubW92ZVRvKDAsIDApXHJcbiAgICAgICAgcGF0aE1ha2VyLmxpbmVUbyh3aWR0aCwgMClcclxuICAgICAgICBwYXRoTWFrZXIubGluZVRvKHdpZHRoLCBoZWlnaHQpXHJcbiAgICAgICAgcGF0aE1ha2VyLmxpbmVUbygwLCBoZWlnaHQpXHJcbiAgICAgICAgcGF0aE1ha2VyLmNsb3NlUGF0aCgpXHJcbiAgICAgICAgcG9zdEFjdGlvbnMocGF0aE1ha2VyKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGRvbSlcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGltcGxlbWVudGF0aW9uIGZvdW5kIGZvciBzdmcgZ3JhcGhpY3MgZWxlbWVudC4nKVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIFtncm91cF1cclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyR3JvdXAoZG9tOiBTVkdHRWxlbWVudCwgYmFzZURvbT86IFNWR0dyYXBoaWNzRWxlbWVudCk6IEdyb3VwU2hhcGVbXSB7XHJcbiAgICBsZXQgaXRlbXM6IEdyb3VwU2hhcGVbXSA9IFtdXHJcbiAgICBkb20uY2hpbGROb2Rlcy5mb3JFYWNoKG5vZGUgPT4ge1xyXG4gICAgICAgIGlmIChub2RlIGluc3RhbmNlb2YgU1ZHR3JhcGhpY3NFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGl0ZW1zID0gcmVuZGVyKG5vZGUsIGJhc2VEb20gfHwgZG9tKS5jb25jYXQoaXRlbXMpXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuICAgIHJldHVybiBpdGVtc1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyUGxhaW5HbHlwaCh0eXBlOiAncmVjdCcgfCAnZWxsaXBzZScsIGFyZ3M6IG51bWJlcltdKTogR3JvdXBTaGFwZSB7XHJcbiAgICBjb25zdCBncm91cDogR3JvdXBTaGFwZSA9IHtcclxuICAgICAgICB0eTogXCJnclwiLFxyXG4gICAgICAgIGl0OiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHR5OiAnc2gnLFxyXG4gICAgICAgICAgICAgICAga3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBrOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGE6IDBcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBoZDogZmFsc2VcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdHk6ICdzdCcsXHJcbiAgICAgICAgICAgICAgICBjOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgazogWzEsIDEsIDEsIDFdXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgdzoge1xyXG4gICAgICAgICAgICAgICAgICAgIGs6IDFcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBvOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgazogMTAwXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgbGM6IGVuY29kZUxpbmVDYXAoJ2J1dHQnKSxcclxuICAgICAgICAgICAgICAgIGxqOiBlbmNvZGVMaW5lSm9pbignbWl0ZXInKVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0eTogJ2ZsJyxcclxuICAgICAgICAgICAgICAgIGM6IHtcclxuICAgICAgICAgICAgICAgICAgICBrOiBbMSwgMSwgMSwgMV1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBvOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgazogMTAwXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHR5OiAndHInLFxyXG4gICAgICAgICAgICAgICAgcDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGs6IFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgMFxyXG4gICAgICAgICAgICAgICAgICAgIF1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgazogW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAwXHJcbiAgICAgICAgICAgICAgICAgICAgXVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHM6IHtcclxuICAgICAgICAgICAgICAgICAgICBrOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDEwMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgMTAwXHJcbiAgICAgICAgICAgICAgICAgICAgXVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHI6IHtcclxuICAgICAgICAgICAgICAgICAgICBrOiAwXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgbzoge1xyXG4gICAgICAgICAgICAgICAgICAgIGs6IDEwMFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNrOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgazogMFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgazogMFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXSxcclxuICAgICAgICBibTogMCxcclxuICAgICAgICBoZDogZmFsc2VcclxuICAgIH1cclxuICAgIGNvbnN0IHBhdGhNYWtlciA9IG5ldyBQYXRoTWFrZXIoKVxyXG4gICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgY2FzZSAncmVjdCc6XHJcbiAgICAgICAgICAgIHBhdGhNYWtlci5tb3ZlVG8oMCwgMClcclxuICAgICAgICAgICAgcGF0aE1ha2VyLmxpbmVUbyhhcmdzWzBdLCAwKVxyXG4gICAgICAgICAgICBwYXRoTWFrZXIubGluZVRvKGFyZ3NbMF0sIGFyZ3NbMV0pXHJcbiAgICAgICAgICAgIHBhdGhNYWtlci5saW5lVG8oMCwgYXJnc1sxXSlcclxuICAgICAgICAgICAgcGF0aE1ha2VyLmNsb3NlUGF0aCgpXHJcbiAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgY2FzZSAnZWxsaXBzZSc6XHJcbiAgICAgICAgICAgIHBhdGhNYWtlci5tb3ZlVG8oYXJnc1swXSwgMClcclxuICAgICAgICAgICAgcGF0aE1ha2VyLmFyY1RvKGFyZ3NbMF0sIGFyZ3NbMV0sIDAsIDEsIDAsIGFyZ3NbMF0sIDIgKiBhcmdzWzFdKVxyXG4gICAgICAgICAgICBwYXRoTWFrZXIuYXJjVG8oYXJnc1swXSwgYXJnc1sxXSwgMCwgMSwgMCwgYXJnc1swXSwgMClcclxuICAgICAgICAgICAgcGF0aE1ha2VyLmNsb3NlUGF0aCgpXHJcbiAgICB9XHJcbiAgICBwYXRoTWFrZXIudW5pZm9ybSgpO1xyXG4gICAgKGdyb3VwLml0IVswXSBhcyBQYXRoU2hhcGUpLmtzIS5rID0gcGF0aE1ha2VyLnBhdGhcclxuICAgIHJldHVybiBncm91cFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyVGV4dChkb206IFNWR1RleHRFbGVtZW50LCBmb250TGlzdD86IEZvbnRzKTogW1RleHREYXRhLCBGb250MV0ge1xyXG4gICAgY29uc3QgY29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZG9tKVxyXG4gICAgY29uc3QgZm9udFNpemUgPSBwYXJzZUZsb2F0KGNvbXB1dGVkU3R5bGUuZm9udFNpemUpLFxyXG4gICAgICAgIGZvbnRGYW1pbHkgPSBjb21wdXRlZFN0eWxlLmZvbnRGYW1pbHkuc3BsaXQoJywnKVswXS50cmltKCksXHJcbiAgICAgICAgZm9udFN0eWxlID0gY29tcHV0ZWRTdHlsZS5mb250U3R5bGUsXHJcbiAgICAgICAgZm9udFdlaWdodCA9IGNvbXB1dGVkU3R5bGUuZm9udFdlaWdodCxcclxuICAgICAgICBmb250Q29sb3IgPSAoY29tcHV0ZWRTdHlsZS5jb2xvciB8fCAncmdiKDAsMCwwKScpLnNwbGl0KCcoJylbMV0uc3BsaXQoJyknKVswXS5zcGxpdCgnLCcpLm1hcChpID0+IHBhcnNlSW50KGkpIC8gMjU1KVxyXG4gICAgbGV0IGZvbnROYW1lID0gdXVpZCgpXHJcbiAgICBpZiAoZm9udExpc3QpIHtcclxuICAgICAgICBjb25zdCBmb250RXhpc3QgPSBmb250TGlzdC5saXN0IS5maWx0ZXIoZm9udCA9PiBmb250LmZGYW1pbHkgPT0gZm9udEZhbWlseSAmJiBmb250LmZTdHlsZSA9PSBmb250U3R5bGUgJiYgZm9udC5mV2VpZ2h0ID09IGZvbnRXZWlnaHQpXHJcbiAgICAgICAgaWYgKGZvbnRFeGlzdC5sZW5ndGgpXHJcbiAgICAgICAgICAgIGZvbnROYW1lID0gZm9udEV4aXN0WzBdLmZOYW1lIVxyXG4gICAgfVxyXG4gICAgY29uc3QgdGV4dERhdGE6IFRleHREYXRhID0ge1xyXG4gICAgICAgIGQ6IHtcclxuICAgICAgICAgICAgazogW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzOiBmb250U2l6ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZjogZm9udE5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQ6IGRvbS5pbm5lckhUTUwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGo6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsczogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmM6IGZvbnRDb2xvclxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcDoge30sXHJcbiAgICAgICAgbToge1xyXG4gICAgICAgICAgICBhOiB7XHJcbiAgICAgICAgICAgICAgICBrOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgMCxcclxuICAgICAgICAgICAgICAgICAgICAwXHJcbiAgICAgICAgICAgICAgICBdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGE6IFtdXHJcbiAgICB9XHJcbiAgICBjb25zdCBmb250RGVmOiBGb250MSA9IHtcclxuICAgICAgICBmRmFtaWx5OiBmb250RmFtaWx5LFxyXG4gICAgICAgIGZXZWlnaHQ6IGAke2ZvbnRXZWlnaHR9YCxcclxuICAgICAgICBmU3R5bGU6IGZvbnRTdHlsZSxcclxuICAgICAgICBmTmFtZTogZm9udE5hbWVcclxuICAgIH1cclxuICAgIHJldHVybiBbdGV4dERhdGEsIGZvbnREZWZdXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJJbWFnZShkb206IFNWR0ltYWdlRWxlbWVudCwgYXNzZXRMaXN0PzogQXNzZXRzKTogW1JlZmVyZW5jZUlELCBJbWFnZUFzc2V0XSB7XHJcbiAgICBsZXQgaWQgPSB1dWlkKClcclxuICAgIGNvbnN0IGRvbUhlaWdodFZhbCA9IGRvbS5oZWlnaHQuYmFzZVZhbFxyXG4gICAgZG9tSGVpZ2h0VmFsLmNvbnZlcnRUb1NwZWNpZmllZFVuaXRzKFNWR0xlbmd0aC5TVkdfTEVOR1RIVFlQRV9QWClcclxuICAgIGNvbnN0IGRvbVdpZHRoVmFsID0gZG9tLndpZHRoLmJhc2VWYWxcclxuICAgIGRvbVdpZHRoVmFsLmNvbnZlcnRUb1NwZWNpZmllZFVuaXRzKFNWR0xlbmd0aC5TVkdfTEVOR1RIVFlQRV9QWClcclxuICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpXHJcbiAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKVxyXG5cclxuICAgIGNhbnZhcy53aWR0aCA9IGRvbVdpZHRoVmFsLnZhbHVlSW5TcGVjaWZpZWRVbml0cyAqIDNcclxuICAgIGNhbnZhcy5oZWlnaHQgPSBkb21IZWlnaHRWYWwudmFsdWVJblNwZWNpZmllZFVuaXRzICogM1xyXG4gICAgY3R4IS5kcmF3SW1hZ2UoZG9tLCAwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpXHJcblxyXG4gICAgY29uc3QgZGF0YVVybCA9IGNhbnZhcy50b0RhdGFVUkwoKVxyXG4gICAgaWYgKGFzc2V0TGlzdCkge1xyXG4gICAgICAgIGNvbnN0IGFzc2V0RXhpc3QgPSBhc3NldExpc3QhLmZpbHRlcihhc3NldCA9PiBhc3NldC5wID09IGRhdGFVcmwpXHJcbiAgICAgICAgaWYgKGFzc2V0RXhpc3QubGVuZ3RoKVxyXG4gICAgICAgICAgICBpZCA9IGFzc2V0RXhpc3RbMF0uaWQhXHJcbiAgICB9XHJcbiAgICBjb25zdCBhc3NldCA9IHtcclxuICAgICAgICBoOiBkb21IZWlnaHRWYWwudmFsdWVJblNwZWNpZmllZFVuaXRzLFxyXG4gICAgICAgIHc6IGRvbVdpZHRoVmFsLnZhbHVlSW5TcGVjaWZpZWRVbml0cyxcclxuICAgICAgICBpZCxcclxuICAgICAgICBwOiBkYXRhVXJsLFxyXG4gICAgICAgIGU6IDFcclxuICAgIH1cclxuICAgIHJldHVybiBbaWQsIGFzc2V0XVxyXG59Il19
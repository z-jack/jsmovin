"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.render = render;
exports.renderPlainGlyph = renderPlainGlyph;
exports.renderText = renderText;
exports.renderImage = renderImage;

var _path = require("./path");

var _v = _interopRequireDefault(require("uuid/v4"));

var _svgPathParser = require("svg-path-parser");

var _helper = require("./helper");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance"); }

function _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function render(dom, baseDom) {
  if (dom instanceof SVGTextElement || dom instanceof SVGImageElement) {
    return [];
  } else if (dom instanceof SVGGElement) {
    return renderGroup(dom, baseDom);
  } else {
    return renderGlyph(dom, baseDom);
  }
}

function addVisualEncodings(items, styles, dom, baseDom) {
  if (styles.stroke && styles.stroke !== 'none') {
    items.push({
      ty: 'st',
      c: {
        k: styles.stroke.split('(')[1].split(')')[0].split(',').slice(0, 3).map(function (raw) {
          return parseInt(raw) / 255;
        }).concat(1)
      },
      o: {
        k: parseFloat(styles.strokeOpacity || '1') * 100
      },
      w: {
        k: parseFloat(styles.strokeWidth || '1')
      },
      lc: (0, _helper.encodeLineCap)(styles.strokeLinecap),
      lj: (0, _helper.encodeLineJoin)(styles.strokeLinejoin)
    });
  }

  if (styles.fill && styles.fill !== 'none') {
    items.push({
      ty: 'fl',
      c: {
        k: styles.fill.split('(')[1].split(')')[0].split(',').slice(0, 3).map(function (raw) {
          return parseInt(raw) / 255;
        }).concat(1)
      },
      o: {
        k: parseFloat(styles.fillOpacity || '1') * 100
      }
    });
  }

  var posX = 0,
      posY = 0;

  if (dom && baseDom) {
    var baseTransform = (0, _helper.calculateBaseTransform)(dom, baseDom);
    var baseBBox = baseDom.getBBox();
    var refBBox = dom.getBBox();
    posX = baseTransform.e + refBBox.x - baseBBox.x;
    posY = baseTransform.f + refBBox.y - baseBBox.y;
  }

  items.push({
    ty: "tr",
    p: {
      k: [posX, posY]
    },
    a: {
      k: [0, 0]
    },
    s: {
      k: [100, 100]
    },
    r: {
      k: 0
    },
    o: {
      k: parseFloat(styles.opacity || '1') * 100
    },
    sk: {
      k: 0
    },
    sa: {
      k: 0
    }
  });
}

function renderGlyph(dom, baseDom) {
  var group = {
    ty: "gr",
    it: [],
    bm: 0,
    hd: false
  };

  var postActions = function postActions(pathMaker) {
    pathMaker.uniform();
    group.it.push({
      ty: 'sh',
      ks: {
        k: pathMaker.path,
        a: 0
      },
      nm: dom.id,
      hd: false
    });
    var styles = window.getComputedStyle(dom);
    addVisualEncodings(group.it, styles, dom, baseDom);
  };

  if (dom instanceof SVGCircleElement) {
    var svgLength = dom.r.baseVal;
    svgLength.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
    var r = svgLength.valueInSpecifiedUnits;
    var pathMaker = new _path.PathMaker();
    pathMaker.moveTo(r, 0);
    pathMaker.arcTo(r, r, 0, 1, 0, r, 2 * r);
    pathMaker.arcTo(r, r, 0, 1, 0, r, 0);
    pathMaker.closePath();
    postActions(pathMaker);
  } else if (dom instanceof SVGEllipseElement) {
    var mapKey = ['rx', 'ry'];

    var _mapKey$map = mapKey.map(function (key) {
      var svgLength = dom[key].baseVal;
      svgLength.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
      return svgLength.valueInSpecifiedUnits;
    }),
        _mapKey$map2 = _slicedToArray(_mapKey$map, 2),
        rx = _mapKey$map2[0],
        ry = _mapKey$map2[1];

    var _pathMaker = new _path.PathMaker();

    _pathMaker.moveTo(rx, 0);

    _pathMaker.arcTo(rx, ry, 0, 1, 0, rx, 2 * ry);

    _pathMaker.arcTo(rx, ry, 0, 1, 0, rx, 0);

    _pathMaker.closePath();

    postActions(_pathMaker);
  } else if (dom instanceof SVGLineElement) {
    var _mapKey = ['x1', 'x2', 'y1', 'y2'];

    var _mapKey$map3 = _mapKey.map(function (key) {
      var svgLength = dom[key].baseVal;
      svgLength.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
      return svgLength.valueInSpecifiedUnits;
    }),
        _mapKey$map4 = _slicedToArray(_mapKey$map3, 4),
        x1 = _mapKey$map4[0],
        x2 = _mapKey$map4[1],
        y1 = _mapKey$map4[2],
        y2 = _mapKey$map4[3];

    var offsetX = Math.min(x1, x2);
    var offsetY = Math.min(y1, y2);

    var _pathMaker2 = new _path.PathMaker();

    _pathMaker2.moveTo(x1 - offsetX, y1 - offsetY);

    _pathMaker2.lineTo(x2 - offsetX, y2 - offsetY);

    postActions(_pathMaker2);
  } else if (dom instanceof SVGPathElement) {
    var pathData = dom.getAttribute('d') || '';
    var pathDataSeries = (0, _svgPathParser.parseSVG)(pathData);

    var _pathMaker3 = new _path.PathMaker();

    var pathDataWithType;
    pathDataSeries.forEach(function (pathDataItem) {
      switch (pathDataItem.code) {
        case 'M':
          pathDataWithType = pathDataItem;

          _pathMaker3.moveTo(pathDataWithType.x, pathDataWithType.y);

          break;

        case 'L':
          pathDataWithType = pathDataItem;

          _pathMaker3.lineTo(pathDataWithType.x, pathDataWithType.y);

          break;

        case 'l':
          pathDataWithType = pathDataItem;

          _pathMaker3.lineToRelative(pathDataWithType.x, pathDataWithType.y);

          break;

        case 'H':
          pathDataWithType = pathDataItem;

          _pathMaker3.horizontalTo(pathDataWithType.x);

          break;

        case 'h':
          pathDataWithType = pathDataItem;

          _pathMaker3.horizontalToRelative(pathDataWithType.x);

          break;

        case 'V':
          pathDataWithType = pathDataItem;

          _pathMaker3.verticalTo(pathDataWithType.y);

          break;

        case 'v':
          pathDataWithType = pathDataItem;

          _pathMaker3.verticalToRelative(pathDataWithType.y);

          break;

        case 'C':
          pathDataWithType = pathDataItem;

          _pathMaker3.cubicBezierCurveTo(pathDataWithType.x1, pathDataWithType.y1, pathDataWithType.x2, pathDataWithType.y2, pathDataWithType.x, pathDataWithType.y);

          break;

        case 'c':
          pathDataWithType = pathDataItem;

          _pathMaker3.cubicBezierCurveToRelative(pathDataWithType.x1, pathDataWithType.y1, pathDataWithType.x2, pathDataWithType.y2, pathDataWithType.x, pathDataWithType.y);

          break;

        case 'Q':
          pathDataWithType = pathDataItem;

          _pathMaker3.quadraticBezierCurveTo(pathDataWithType.x1, pathDataWithType.y1, pathDataWithType.x, pathDataWithType.y);

          break;

        case 'q':
          pathDataWithType = pathDataItem;

          _pathMaker3.quadraticBezierCurveToRelative(pathDataWithType.x1, pathDataWithType.y1, pathDataWithType.x, pathDataWithType.y);

          break;

        case 'A':
          pathDataWithType = pathDataItem;

          _pathMaker3.arcTo(pathDataWithType.rx, pathDataWithType.ry, pathDataWithType.xAxisRotation, ~~pathDataWithType.largeArc, ~~pathDataWithType.sweep, pathDataWithType.x, pathDataWithType.y);

          break;

        case 'a':
          pathDataWithType = pathDataItem;

          _pathMaker3.arcToRelative(pathDataWithType.rx, pathDataWithType.ry, pathDataWithType.xAxisRotation, ~~pathDataWithType.largeArc, ~~pathDataWithType.sweep, pathDataWithType.x, pathDataWithType.y);

          break;

        case 'Z':
        case 'z':
          _pathMaker3.closePath();

          break;

        default:
          console.error(pathDataItem);
          throw new Error('No implementation found for this path command.');
      }
    });
    postActions(_pathMaker3);
  } else if (dom instanceof SVGPolygonElement || dom instanceof SVGPolylineElement) {
    var points = dom.points;

    if (points.length) {
      var iterablePoints = Array.prototype.slice.call(points);

      var _offsetX = iterablePoints.reduce(function (p, v) {
        return Math.min(p, v.x);
      }, 0);

      var _offsetY = iterablePoints.reduce(function (p, v) {
        return Math.min(p, v.y);
      }, 0);

      var _pathMaker4 = new _path.PathMaker();

      _pathMaker4.moveTo(points[0].x - _offsetX, points[0].y - _offsetY);

      iterablePoints.forEach(function (v, i) {
        if (i <= 0) return;

        _pathMaker4.lineTo(v.x - _offsetX, v.y - _offsetY);
      });

      if (dom instanceof SVGPolygonElement) {
        _pathMaker4.closePath();
      }

      postActions(_pathMaker4);
    }
  } else if (dom instanceof SVGRectElement) {
    var _mapKey2 = ['width', 'height'];

    var _mapKey2$map = _mapKey2.map(function (key) {
      var svgLength = dom[key].baseVal;
      svgLength.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
      return svgLength.valueInSpecifiedUnits;
    }),
        _mapKey2$map2 = _slicedToArray(_mapKey2$map, 2),
        width = _mapKey2$map2[0],
        height = _mapKey2$map2[1];

    var _pathMaker5 = new _path.PathMaker();

    _pathMaker5.moveTo(0, 0);

    _pathMaker5.lineTo(width, 0);

    _pathMaker5.lineTo(width, height);

    _pathMaker5.lineTo(0, height);

    _pathMaker5.closePath();

    postActions(_pathMaker5);
  } else {
    console.error(dom);
    throw new Error('No implementation found for svg graphics element.');
  }

  return [group];
}

function renderGroup(dom, baseDom) {
  var items = [];
  dom.childNodes.forEach(function (node) {
    if (node instanceof SVGGraphicsElement) {
      items = render(node, baseDom || dom).concat(items);
    }
  });
  return items;
}

function renderPlainGlyph(type, args) {
  var group = {
    ty: "gr",
    it: [{
      ty: 'sh',
      ks: {
        k: null,
        a: 0
      },
      hd: false
    }, {
      ty: 'st',
      c: {
        k: [1, 1, 1, 1]
      },
      w: {
        k: 1
      },
      o: {
        k: 100
      },
      lc: (0, _helper.encodeLineCap)('butt'),
      lj: (0, _helper.encodeLineJoin)('miter')
    }, {
      ty: 'fl',
      c: {
        k: [1, 1, 1, 1]
      },
      o: {
        k: 100
      }
    }, {
      ty: 'tr',
      p: {
        k: [0, 0]
      },
      a: {
        k: [0, 0]
      },
      s: {
        k: [100, 100]
      },
      r: {
        k: 0
      },
      o: {
        k: 100
      },
      sk: {
        k: 0
      },
      sa: {
        k: 0
      }
    }],
    bm: 0,
    hd: false
  };
  var pathMaker = new _path.PathMaker();

  switch (type) {
    case 'rect':
      pathMaker.moveTo(0, 0);
      pathMaker.lineTo(args[0], 0);
      pathMaker.lineTo(args[0], args[1]);
      pathMaker.lineTo(0, args[1]);
      pathMaker.closePath();
      break;

    case 'ellipse':
      pathMaker.moveTo(args[0], 0);
      pathMaker.arcTo(args[0], args[1], 0, 1, 0, args[0], 2 * args[1]);
      pathMaker.arcTo(args[0], args[1], 0, 1, 0, args[0], 0);
      pathMaker.closePath();
  }

  pathMaker.uniform();
  group.it[0].ks.k = pathMaker.path;
  return group;
}

function renderText(dom, fontList) {
  var computedStyle = getComputedStyle(dom);
  var fontSize = parseFloat(computedStyle.fontSize),
      fontFamily = computedStyle.fontFamily.split(',')[0].trim(),
      fontStyle = computedStyle.fontStyle,
      fontWeight = computedStyle.fontWeight,
      fontColor = (computedStyle.fill || 'rgb(0,0,0)').split('(')[1].split(')')[0].split(',').map(function (i) {
    return parseInt(i) / 255;
  });
  var fontName = (0, _v["default"])();

  if (fontList) {
    var fontExist = fontList.list.filter(function (font) {
      return font.fFamily == fontFamily && font.fStyle == fontStyle && font.fWeight == fontWeight;
    });
    if (fontExist.length) fontName = fontExist[0].fName;
  }

  var textData = {
    d: {
      k: [{
        t: 0,
        s: {
          s: fontSize,
          f: fontName,
          t: dom.innerHTML,
          j: 0,
          tr: 0,
          ls: 0,
          fc: fontColor
        }
      }]
    },
    p: {},
    m: {
      a: {
        k: [0, 0]
      }
    },
    a: []
  };
  var fontDef = {
    fFamily: fontFamily,
    fWeight: "".concat(fontWeight),
    fStyle: fontStyle,
    fName: fontName
  };
  return [textData, fontDef];
}

function renderImage(dom, assetList) {
  var id = (0, _v["default"])();
  var domHeightVal = dom.height.baseVal;
  domHeightVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
  var domWidthVal = dom.width.baseVal;
  domWidthVal.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
  var canvas = document.createElement('canvas');
  var ctx = canvas.getContext('2d');
  canvas.width = domWidthVal.valueInSpecifiedUnits * 3;
  canvas.height = domHeightVal.valueInSpecifiedUnits * 3;
  ctx.drawImage(dom, 0, 0, canvas.width, canvas.height);
  var dataUrl = canvas.toDataURL();

  if (assetList) {
    var assetExist = assetList.filter(function (asset) {
      return asset.p == dataUrl;
    });
    if (assetExist.length) id = assetExist[0].id;
  }

  var asset = {
    h: domHeightVal.valueInSpecifiedUnits,
    w: domWidthVal.valueInSpecifiedUnits,
    id: id,
    p: dataUrl,
    e: 1
  };
  return [id, asset];
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9yZW5kZXIudHMiXSwibmFtZXMiOlsicmVuZGVyIiwiZG9tIiwiYmFzZURvbSIsIlNWR1RleHRFbGVtZW50IiwiU1ZHSW1hZ2VFbGVtZW50IiwiU1ZHR0VsZW1lbnQiLCJyZW5kZXJHcm91cCIsInJlbmRlckdseXBoIiwiYWRkVmlzdWFsRW5jb2RpbmdzIiwiaXRlbXMiLCJzdHlsZXMiLCJzdHJva2UiLCJwdXNoIiwidHkiLCJjIiwiayIsInNwbGl0Iiwic2xpY2UiLCJtYXAiLCJyYXciLCJwYXJzZUludCIsImNvbmNhdCIsIm8iLCJwYXJzZUZsb2F0Iiwic3Ryb2tlT3BhY2l0eSIsInciLCJzdHJva2VXaWR0aCIsImxjIiwic3Ryb2tlTGluZWNhcCIsImxqIiwic3Ryb2tlTGluZWpvaW4iLCJmaWxsIiwiZmlsbE9wYWNpdHkiLCJwb3NYIiwicG9zWSIsImJhc2VUcmFuc2Zvcm0iLCJiYXNlQkJveCIsImdldEJCb3giLCJyZWZCQm94IiwiZSIsIngiLCJmIiwieSIsInAiLCJhIiwicyIsInIiLCJvcGFjaXR5Iiwic2siLCJzYSIsImdyb3VwIiwiaXQiLCJibSIsImhkIiwicG9zdEFjdGlvbnMiLCJwYXRoTWFrZXIiLCJ1bmlmb3JtIiwia3MiLCJwYXRoIiwibm0iLCJpZCIsIndpbmRvdyIsImdldENvbXB1dGVkU3R5bGUiLCJTVkdDaXJjbGVFbGVtZW50Iiwic3ZnTGVuZ3RoIiwiYmFzZVZhbCIsImNvbnZlcnRUb1NwZWNpZmllZFVuaXRzIiwiU1ZHTGVuZ3RoIiwiU1ZHX0xFTkdUSFRZUEVfUFgiLCJ2YWx1ZUluU3BlY2lmaWVkVW5pdHMiLCJQYXRoTWFrZXIiLCJtb3ZlVG8iLCJhcmNUbyIsImNsb3NlUGF0aCIsIlNWR0VsbGlwc2VFbGVtZW50IiwibWFwS2V5Iiwia2V5IiwicngiLCJyeSIsIlNWR0xpbmVFbGVtZW50IiwieDEiLCJ4MiIsInkxIiwieTIiLCJvZmZzZXRYIiwiTWF0aCIsIm1pbiIsIm9mZnNldFkiLCJsaW5lVG8iLCJTVkdQYXRoRWxlbWVudCIsInBhdGhEYXRhIiwiZ2V0QXR0cmlidXRlIiwicGF0aERhdGFTZXJpZXMiLCJwYXRoRGF0YVdpdGhUeXBlIiwiZm9yRWFjaCIsInBhdGhEYXRhSXRlbSIsImNvZGUiLCJsaW5lVG9SZWxhdGl2ZSIsImhvcml6b250YWxUbyIsImhvcml6b250YWxUb1JlbGF0aXZlIiwidmVydGljYWxUbyIsInZlcnRpY2FsVG9SZWxhdGl2ZSIsImN1YmljQmV6aWVyQ3VydmVUbyIsImN1YmljQmV6aWVyQ3VydmVUb1JlbGF0aXZlIiwicXVhZHJhdGljQmV6aWVyQ3VydmVUbyIsInF1YWRyYXRpY0JlemllckN1cnZlVG9SZWxhdGl2ZSIsInhBeGlzUm90YXRpb24iLCJsYXJnZUFyYyIsInN3ZWVwIiwiYXJjVG9SZWxhdGl2ZSIsImNvbnNvbGUiLCJlcnJvciIsIkVycm9yIiwiU1ZHUG9seWdvbkVsZW1lbnQiLCJTVkdQb2x5bGluZUVsZW1lbnQiLCJwb2ludHMiLCJsZW5ndGgiLCJpdGVyYWJsZVBvaW50cyIsIkFycmF5IiwicHJvdG90eXBlIiwiY2FsbCIsInJlZHVjZSIsInYiLCJpIiwiU1ZHUmVjdEVsZW1lbnQiLCJ3aWR0aCIsImhlaWdodCIsImNoaWxkTm9kZXMiLCJub2RlIiwiU1ZHR3JhcGhpY3NFbGVtZW50IiwicmVuZGVyUGxhaW5HbHlwaCIsInR5cGUiLCJhcmdzIiwicmVuZGVyVGV4dCIsImZvbnRMaXN0IiwiY29tcHV0ZWRTdHlsZSIsImZvbnRTaXplIiwiZm9udEZhbWlseSIsInRyaW0iLCJmb250U3R5bGUiLCJmb250V2VpZ2h0IiwiZm9udENvbG9yIiwiZm9udE5hbWUiLCJmb250RXhpc3QiLCJsaXN0IiwiZmlsdGVyIiwiZm9udCIsImZGYW1pbHkiLCJmU3R5bGUiLCJmV2VpZ2h0IiwiZk5hbWUiLCJ0ZXh0RGF0YSIsImQiLCJ0IiwiaW5uZXJIVE1MIiwiaiIsInRyIiwibHMiLCJmYyIsIm0iLCJmb250RGVmIiwicmVuZGVySW1hZ2UiLCJhc3NldExpc3QiLCJkb21IZWlnaHRWYWwiLCJkb21XaWR0aFZhbCIsImNhbnZhcyIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImN0eCIsImdldENvbnRleHQiLCJkcmF3SW1hZ2UiLCJkYXRhVXJsIiwidG9EYXRhVVJMIiwiYXNzZXRFeGlzdCIsImFzc2V0IiwiaCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7Ozs7Ozs7QUFHTyxTQUFTQSxNQUFULENBQWdCQyxHQUFoQixFQUF5Q0MsT0FBekMsRUFBcUY7QUFDeEYsTUFBSUQsR0FBRyxZQUFZRSxjQUFmLElBQWlDRixHQUFHLFlBQVlHLGVBQXBELEVBQXFFO0FBQ2pFLFdBQU8sRUFBUDtBQUNILEdBRkQsTUFFTyxJQUFJSCxHQUFHLFlBQVlJLFdBQW5CLEVBQWdDO0FBQ25DLFdBQU9DLFdBQVcsQ0FBQ0wsR0FBRCxFQUFNQyxPQUFOLENBQWxCO0FBQ0gsR0FGTSxNQUVBO0FBQ0gsV0FBT0ssV0FBVyxDQUFDTixHQUFELEVBQU1DLE9BQU4sQ0FBbEI7QUFDSDtBQUNKOztBQUlELFNBQVNNLGtCQUFULENBQTRCQyxLQUE1QixFQUFzREMsTUFBdEQsRUFBbUZULEdBQW5GLEVBQTZHQyxPQUE3RyxFQUEySTtBQUN2SSxNQUFJUSxNQUFNLENBQUNDLE1BQVAsSUFBaUJELE1BQU0sQ0FBQ0MsTUFBUCxLQUFrQixNQUF2QyxFQUErQztBQUMzQ0YsSUFBQUEsS0FBSyxDQUFDRyxJQUFOLENBQVc7QUFDUEMsTUFBQUEsRUFBRSxFQUFFLElBREc7QUFFUEMsTUFBQUEsQ0FBQyxFQUFFO0FBQ0NDLFFBQUFBLENBQUMsRUFBRUwsTUFBTSxDQUFDQyxNQUFQLENBQWVLLEtBQWYsQ0FBcUIsR0FBckIsRUFBMEIsQ0FBMUIsRUFBNkJBLEtBQTdCLENBQW1DLEdBQW5DLEVBQXdDLENBQXhDLEVBQTJDQSxLQUEzQyxDQUFpRCxHQUFqRCxFQUFzREMsS0FBdEQsQ0FBNEQsQ0FBNUQsRUFBK0QsQ0FBL0QsRUFBa0VDLEdBQWxFLENBQXNFLFVBQUNDLEdBQUQ7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RUFBMEJvSyxNQUFNLENBQUN4QyxLQUFqQyxFQUF3Q3dDLE1BQU0sQ0FBQ3ZDLE1BQS9DO0FBRUEsTUFBTTZDLE9BQU8sR0FBR04sTUFBTSxDQUFDTyxTQUFQLEVBQWhCOztBQUNBLE1BQUlWLFNBQUosRUFBZTtBQUNYLFFBQU1XLFVBQVUsR0FBR1gsU0FBUyxDQUFFakIsTUFBWCxDQUFrQixVQUFBNkIsS0FBSztBQUFBLGFBQUlBLEtBQUssQ0FBQ25JLENBQU4sSUFBV2dJLE9BQWY7QUFBQSxLQUF2QixDQUFuQjtBQUNBLFFBQUlFLFVBQVUsQ0FBQ3pELE1BQWYsRUFDSXhELEVBQUUsR0FBR2lILFVBQVUsQ0FBQyxDQUFELENBQVYsQ0FBY2pILEVBQW5CO0FBQ1A7O0FBQ0QsTUFBTWtILEtBQUssR0FBRztBQUNWQyxJQUFBQSxDQUFDLEVBQUVaLFlBQVksQ0FBQzlGLHFCQUROO0FBRVY1QyxJQUFBQSxDQUFDLEVBQUUySSxXQUFXLENBQUMvRixxQkFGTDtBQUdWVCxJQUFBQSxFQUFFLEVBQUZBLEVBSFU7QUFJVmpCLElBQUFBLENBQUMsRUFBRWdJLE9BSk87QUFLVnBJLElBQUFBLENBQUMsRUFBRTtBQUxPLEdBQWQ7QUFPQSxTQUFPLENBQUNxQixFQUFELEVBQUtrSCxLQUFMLENBQVA7QUFDSCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEdyb3VwU2hhcGUsIFRleHREYXRhLCBSZWZlcmVuY2VJRCwgUGF0aFNoYXBlLCBGaWxsU2hhcGUsIFN0cm9rZVNoYXBlLCBUcmFuc2Zvcm1TaGFwZSwgSW1hZ2VBc3NldCwgRm9udDEsIEZvbnRzLCBBc3NldHMgfSBmcm9tICcuL2FuaW1hdGlvbidcclxuaW1wb3J0IHsgUGF0aE1ha2VyIH0gZnJvbSAnLi9wYXRoJ1xyXG5pbXBvcnQgdXVpZCBmcm9tICd1dWlkL3Y0J1xyXG5pbXBvcnQgeyBwYXJzZVNWRywgTW92ZVRvQ29tbWFuZCwgTGluZVRvQ29tbWFuZCwgSG9yaXpvbnRhbExpbmVUb0NvbW1hbmQsIFZlcnRpY2FsTGluZVRvQ29tbWFuZCwgQ3VydmVUb0NvbW1hbmQsIFF1YWRyYXRpY0N1cnZlVG9Db21tYW5kLCBFbGxpcHRpY2FsQXJjQ29tbWFuZCB9IGZyb20gJ3N2Zy1wYXRoLXBhcnNlcidcclxuaW1wb3J0IHsgY2FsY3VsYXRlQmFzZVRyYW5zZm9ybSwgZW5jb2RlTGluZUpvaW4sIGVuY29kZUxpbmVDYXAgfSBmcm9tICcuL2hlbHBlcidcclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyKGRvbTogU1ZHR3JhcGhpY3NFbGVtZW50LCBiYXNlRG9tPzogU1ZHR3JhcGhpY3NFbGVtZW50KTogR3JvdXBTaGFwZVtdIHtcclxuICAgIGlmIChkb20gaW5zdGFuY2VvZiBTVkdUZXh0RWxlbWVudCB8fCBkb20gaW5zdGFuY2VvZiBTVkdJbWFnZUVsZW1lbnQpIHtcclxuICAgICAgICByZXR1cm4gW11cclxuICAgIH0gZWxzZSBpZiAoZG9tIGluc3RhbmNlb2YgU1ZHR0VsZW1lbnQpIHtcclxuICAgICAgICByZXR1cm4gcmVuZGVyR3JvdXAoZG9tLCBiYXNlRG9tKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gcmVuZGVyR2x5cGgoZG9tLCBiYXNlRG9tKVxyXG4gICAgfVxyXG59XHJcblxyXG50eXBlIFZpc3VhbEdyb3VwSXRlbSA9IFBhdGhTaGFwZSB8IEZpbGxTaGFwZSB8IFN0cm9rZVNoYXBlIHwgVHJhbnNmb3JtU2hhcGVcclxuXHJcbmZ1bmN0aW9uIGFkZFZpc3VhbEVuY29kaW5ncyhpdGVtczogVmlzdWFsR3JvdXBJdGVtW10sIHN0eWxlczogQ1NTU3R5bGVEZWNsYXJhdGlvbiwgZG9tPzogU1ZHR3JhcGhpY3NFbGVtZW50LCBiYXNlRG9tPzogU1ZHR3JhcGhpY3NFbGVtZW50KSB7XHJcbiAgICBpZiAoc3R5bGVzLnN0cm9rZSAmJiBzdHlsZXMuc3Ryb2tlICE9PSAnbm9uZScpIHtcclxuICAgICAgICBpdGVtcy5wdXNoKHtcclxuICAgICAgICAgICAgdHk6ICdzdCcsXHJcbiAgICAgICAgICAgIGM6IHtcclxuICAgICAgICAgICAgICAgIGs6IHN0eWxlcy5zdHJva2UhLnNwbGl0KCcoJylbMV0uc3BsaXQoJyknKVswXS5zcGxpdCgnLCcpLnNsaWNlKDAsIDMpLm1hcCgocmF3OiBzdHJpbmcpID0+IHBhcnNlSW50KHJhdykgLyAyNTUpLmNvbmNhdCgxKVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvOiB7XHJcbiAgICAgICAgICAgICAgICBrOiBwYXJzZUZsb2F0KHN0eWxlcy5zdHJva2VPcGFjaXR5IHx8ICcxJykgKiAxMDBcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdzoge1xyXG4gICAgICAgICAgICAgICAgazogcGFyc2VGbG9hdChzdHlsZXMuc3Ryb2tlV2lkdGggfHwgJzEnKVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBsYzogZW5jb2RlTGluZUNhcChzdHlsZXMuc3Ryb2tlTGluZWNhcCksXHJcbiAgICAgICAgICAgIGxqOiBlbmNvZGVMaW5lSm9pbihzdHlsZXMuc3Ryb2tlTGluZWpvaW4pXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuICAgIGlmIChzdHlsZXMuZmlsbCAmJiBzdHlsZXMuZmlsbCAhPT0gJ25vbmUnKSB7XHJcbiAgICAgICAgaXRlbXMucHVzaCh7XHJcbiAgICAgICAgICAgIHR5OiAnZmwnLFxyXG4gICAgICAgICAgICBjOiB7XHJcbiAgICAgICAgICAgICAgICBrOiBzdHlsZXMuZmlsbCEuc3BsaXQoJygnKVsxXS5zcGxpdCgnKScpWzBdLnNwbGl0KCcsJykuc2xpY2UoMCwgMykubWFwKChyYXc6IHN0cmluZykgPT4gcGFyc2VJbnQocmF3KSAvIDI1NSkuY29uY2F0KDEpXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG86IHtcclxuICAgICAgICAgICAgICAgIGs6IHBhcnNlRmxvYXQoc3R5bGVzLmZpbGxPcGFjaXR5IHx8ICcxJykgKiAxMDBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbiAgICBsZXQgcG9zWCA9IDAsIHBvc1kgPSAwXHJcbiAgICBpZiAoZG9tICYmIGJhc2VEb20pIHtcclxuICAgICAgICBjb25zdCBiYXNlVHJhbnNmb3JtID0gY2FsY3VsYXRlQmFzZVRyYW5zZm9ybShkb20sIGJhc2VEb20pXHJcbiAgICAgICAgY29uc3QgYmFzZUJCb3ggPSBiYXNlRG9tLmdldEJCb3goKVxyXG4gICAgICAgIGNvbnN0IHJlZkJCb3ggPSBkb20uZ2V0QkJveCgpXHJcbiAgICAgICAgcG9zWCA9IGJhc2VUcmFuc2Zvcm0uZSArIHJlZkJCb3gueCAtIGJhc2VCQm94LnhcclxuICAgICAgICBwb3NZID0gYmFzZVRyYW5zZm9ybS5mICsgcmVmQkJveC55IC0gYmFzZUJCb3gueVxyXG4gICAgfVxyXG4gICAgaXRlbXMucHVzaCh7XHJcbiAgICAgICAgdHk6IFwidHJcIixcclxuICAgICAgICBwOiB7XHJcbiAgICAgICAgICAgIGs6IFtcclxuICAgICAgICAgICAgICAgIHBvc1gsXHJcbiAgICAgICAgICAgICAgICBwb3NZXHJcbiAgICAgICAgICAgIF1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGE6IHtcclxuICAgICAgICAgICAgazogW1xyXG4gICAgICAgICAgICAgICAgMCxcclxuICAgICAgICAgICAgICAgIDBcclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgczoge1xyXG4gICAgICAgICAgICBrOiBbXHJcbiAgICAgICAgICAgICAgICAxMDAsXHJcbiAgICAgICAgICAgICAgICAxMDBcclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcjoge1xyXG4gICAgICAgICAgICBrOiAwXHJcbiAgICAgICAgfSxcclxuICAgICAgICBvOiB7XHJcbiAgICAgICAgICAgIGs6IHBhcnNlRmxvYXQoc3R5bGVzLm9wYWNpdHkgfHwgJzEnKSAqIDEwMFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2s6IHtcclxuICAgICAgICAgICAgazogMFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2E6IHtcclxuICAgICAgICAgICAgazogMFxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcblxyXG59XHJcblxyXG5mdW5jdGlvbiByZW5kZXJHbHlwaChkb206IFNWR0dyYXBoaWNzRWxlbWVudCwgYmFzZURvbT86IFNWR0dyYXBoaWNzRWxlbWVudCk6IEdyb3VwU2hhcGVbXSB7XHJcbiAgICBjb25zdCBncm91cDogR3JvdXBTaGFwZSA9IHtcclxuICAgICAgICB0eTogXCJnclwiLFxyXG4gICAgICAgIGl0OiBbXSxcclxuICAgICAgICBibTogMCxcclxuICAgICAgICBoZDogZmFsc2VcclxuICAgIH1cclxuICAgIGNvbnN0IHBvc3RBY3Rpb25zID0gKHBhdGhNYWtlcjogUGF0aE1ha2VyKSA9PiB7XHJcbiAgICAgICAgcGF0aE1ha2VyLnVuaWZvcm0oKVxyXG4gICAgICAgIGdyb3VwLml0IS5wdXNoKHtcclxuICAgICAgICAgICAgdHk6ICdzaCcsXHJcbiAgICAgICAgICAgIGtzOiB7XHJcbiAgICAgICAgICAgICAgICBrOiBwYXRoTWFrZXIucGF0aCxcclxuICAgICAgICAgICAgICAgIGE6IDBcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbm06IGRvbS5pZCxcclxuICAgICAgICAgICAgaGQ6IGZhbHNlXHJcbiAgICAgICAgfSlcclxuICAgICAgICBjb25zdCBzdHlsZXMgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShkb20pXHJcbiAgICAgICAgYWRkVmlzdWFsRW5jb2RpbmdzKGdyb3VwLml0ISBhcyBWaXN1YWxHcm91cEl0ZW1bXSwgc3R5bGVzLCBkb20sIGJhc2VEb20pXHJcbiAgICB9XHJcbiAgICBpZiAoZG9tIGluc3RhbmNlb2YgU1ZHQ2lyY2xlRWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IHN2Z0xlbmd0aCA9IGRvbS5yLmJhc2VWYWxcclxuICAgICAgICBzdmdMZW5ndGguY29udmVydFRvU3BlY2lmaWVkVW5pdHMoU1ZHTGVuZ3RoLlNWR19MRU5HVEhUWVBFX1BYKVxyXG4gICAgICAgIGNvbnN0IHIgPSBzdmdMZW5ndGgudmFsdWVJblNwZWNpZmllZFVuaXRzXHJcbiAgICAgICAgY29uc3QgcGF0aE1ha2VyID0gbmV3IFBhdGhNYWtlcigpXHJcbiAgICAgICAgcGF0aE1ha2VyLm1vdmVUbyhyLCAwKVxyXG4gICAgICAgIHBhdGhNYWtlci5hcmNUbyhyLCByLCAwLCAxLCAwLCByLCAyICogcilcclxuICAgICAgICBwYXRoTWFrZXIuYXJjVG8ociwgciwgMCwgMSwgMCwgciwgMClcclxuICAgICAgICBwYXRoTWFrZXIuY2xvc2VQYXRoKClcclxuICAgICAgICBwb3N0QWN0aW9ucyhwYXRoTWFrZXIpXHJcbiAgICB9IGVsc2UgaWYgKGRvbSBpbnN0YW5jZW9mIFNWR0VsbGlwc2VFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgbWFwS2V5OiAoJ3J4JyB8ICdyeScpW10gPSBbJ3J4JywgJ3J5J11cclxuICAgICAgICBjb25zdCBbcngsIHJ5XSA9IG1hcEtleS5tYXAoa2V5ID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgc3ZnTGVuZ3RoID0gZG9tW2tleV0uYmFzZVZhbFxyXG4gICAgICAgICAgICBzdmdMZW5ndGguY29udmVydFRvU3BlY2lmaWVkVW5pdHMoU1ZHTGVuZ3RoLlNWR19MRU5HVEhUWVBFX1BYKVxyXG4gICAgICAgICAgICByZXR1cm4gc3ZnTGVuZ3RoLnZhbHVlSW5TcGVjaWZpZWRVbml0c1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgY29uc3QgcGF0aE1ha2VyID0gbmV3IFBhdGhNYWtlcigpXHJcbiAgICAgICAgcGF0aE1ha2VyLm1vdmVUbyhyeCwgMClcclxuICAgICAgICBwYXRoTWFrZXIuYXJjVG8ocngsIHJ5LCAwLCAxLCAwLCByeCwgMiAqIHJ5KVxyXG4gICAgICAgIHBhdGhNYWtlci5hcmNUbyhyeCwgcnksIDAsIDEsIDAsIHJ4LCAwKVxyXG4gICAgICAgIHBhdGhNYWtlci5jbG9zZVBhdGgoKVxyXG4gICAgICAgIHBvc3RBY3Rpb25zKHBhdGhNYWtlcilcclxuICAgIH0gZWxzZSBpZiAoZG9tIGluc3RhbmNlb2YgU1ZHTGluZUVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBtYXBLZXk6ICgneDEnIHwgJ3gyJyB8ICd5MScgfCAneTInKVtdID0gWyd4MScsICd4MicsICd5MScsICd5MiddXHJcbiAgICAgICAgY29uc3QgW3gxLCB4MiwgeTEsIHkyXSA9IG1hcEtleS5tYXAoa2V5ID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgc3ZnTGVuZ3RoID0gZG9tW2tleV0uYmFzZVZhbFxyXG4gICAgICAgICAgICBzdmdMZW5ndGguY29udmVydFRvU3BlY2lmaWVkVW5pdHMoU1ZHTGVuZ3RoLlNWR19MRU5HVEhUWVBFX1BYKVxyXG4gICAgICAgICAgICByZXR1cm4gc3ZnTGVuZ3RoLnZhbHVlSW5TcGVjaWZpZWRVbml0c1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgY29uc3Qgb2Zmc2V0WCA9IE1hdGgubWluKHgxLCB4MilcclxuICAgICAgICBjb25zdCBvZmZzZXRZID0gTWF0aC5taW4oeTEsIHkyKVxyXG4gICAgICAgIGNvbnN0IHBhdGhNYWtlciA9IG5ldyBQYXRoTWFrZXIoKVxyXG4gICAgICAgIHBhdGhNYWtlci5tb3ZlVG8oeDEgLSBvZmZzZXRYLCB5MSAtIG9mZnNldFkpXHJcbiAgICAgICAgcGF0aE1ha2VyLmxpbmVUbyh4MiAtIG9mZnNldFgsIHkyIC0gb2Zmc2V0WSlcclxuICAgICAgICBwb3N0QWN0aW9ucyhwYXRoTWFrZXIpXHJcbiAgICB9IGVsc2UgaWYgKGRvbSBpbnN0YW5jZW9mIFNWR1BhdGhFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgcGF0aERhdGEgPSBkb20uZ2V0QXR0cmlidXRlKCdkJykgfHwgJydcclxuICAgICAgICBjb25zdCBwYXRoRGF0YVNlcmllcyA9IHBhcnNlU1ZHKHBhdGhEYXRhKVxyXG4gICAgICAgIGNvbnN0IHBhdGhNYWtlciA9IG5ldyBQYXRoTWFrZXIoKVxyXG4gICAgICAgIGxldCBwYXRoRGF0YVdpdGhUeXBlO1xyXG4gICAgICAgIHBhdGhEYXRhU2VyaWVzLmZvckVhY2gocGF0aERhdGFJdGVtID0+IHtcclxuICAgICAgICAgICAgc3dpdGNoIChwYXRoRGF0YUl0ZW0uY29kZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnTSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aERhdGFXaXRoVHlwZSA9IHBhdGhEYXRhSXRlbSBhcyBNb3ZlVG9Db21tYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aE1ha2VyLm1vdmVUbyhwYXRoRGF0YVdpdGhUeXBlLngsIHBhdGhEYXRhV2l0aFR5cGUueSlcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnTCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aERhdGFXaXRoVHlwZSA9IHBhdGhEYXRhSXRlbSBhcyBMaW5lVG9Db21tYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aE1ha2VyLmxpbmVUbyhwYXRoRGF0YVdpdGhUeXBlLngsIHBhdGhEYXRhV2l0aFR5cGUueSlcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnbCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aERhdGFXaXRoVHlwZSA9IHBhdGhEYXRhSXRlbSBhcyBMaW5lVG9Db21tYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aE1ha2VyLmxpbmVUb1JlbGF0aXZlKHBhdGhEYXRhV2l0aFR5cGUueCwgcGF0aERhdGFXaXRoVHlwZS55KVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICBjYXNlICdIJzpcclxuICAgICAgICAgICAgICAgICAgICBwYXRoRGF0YVdpdGhUeXBlID0gcGF0aERhdGFJdGVtIGFzIEhvcml6b250YWxMaW5lVG9Db21tYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aE1ha2VyLmhvcml6b250YWxUbyhwYXRoRGF0YVdpdGhUeXBlLngpXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2gnOlxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhEYXRhV2l0aFR5cGUgPSBwYXRoRGF0YUl0ZW0gYXMgSG9yaXpvbnRhbExpbmVUb0NvbW1hbmRcclxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIuaG9yaXpvbnRhbFRvUmVsYXRpdmUocGF0aERhdGFXaXRoVHlwZS54KVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICBjYXNlICdWJzpcclxuICAgICAgICAgICAgICAgICAgICBwYXRoRGF0YVdpdGhUeXBlID0gcGF0aERhdGFJdGVtIGFzIFZlcnRpY2FsTGluZVRvQ29tbWFuZFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci52ZXJ0aWNhbFRvKHBhdGhEYXRhV2l0aFR5cGUueSlcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgY2FzZSAndic6XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aERhdGFXaXRoVHlwZSA9IHBhdGhEYXRhSXRlbSBhcyBWZXJ0aWNhbExpbmVUb0NvbW1hbmRcclxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIudmVydGljYWxUb1JlbGF0aXZlKHBhdGhEYXRhV2l0aFR5cGUueSlcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnQyc6XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aERhdGFXaXRoVHlwZSA9IHBhdGhEYXRhSXRlbSBhcyBDdXJ2ZVRvQ29tbWFuZFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5jdWJpY0JlemllckN1cnZlVG8ocGF0aERhdGFXaXRoVHlwZS54MSwgcGF0aERhdGFXaXRoVHlwZS55MSwgcGF0aERhdGFXaXRoVHlwZS54MiwgcGF0aERhdGFXaXRoVHlwZS55MiwgcGF0aERhdGFXaXRoVHlwZS54LCBwYXRoRGF0YVdpdGhUeXBlLnkpXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2MnOlxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhEYXRhV2l0aFR5cGUgPSBwYXRoRGF0YUl0ZW0gYXMgQ3VydmVUb0NvbW1hbmRcclxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIuY3ViaWNCZXppZXJDdXJ2ZVRvUmVsYXRpdmUocGF0aERhdGFXaXRoVHlwZS54MSwgcGF0aERhdGFXaXRoVHlwZS55MSwgcGF0aERhdGFXaXRoVHlwZS54MiwgcGF0aERhdGFXaXRoVHlwZS55MiwgcGF0aERhdGFXaXRoVHlwZS54LCBwYXRoRGF0YVdpdGhUeXBlLnkpXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ1EnOlxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhEYXRhV2l0aFR5cGUgPSBwYXRoRGF0YUl0ZW0gYXMgUXVhZHJhdGljQ3VydmVUb0NvbW1hbmRcclxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIucXVhZHJhdGljQmV6aWVyQ3VydmVUbyhwYXRoRGF0YVdpdGhUeXBlLngxLCBwYXRoRGF0YVdpdGhUeXBlLnkxLCBwYXRoRGF0YVdpdGhUeXBlLngsIHBhdGhEYXRhV2l0aFR5cGUueSlcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgY2FzZSAncSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aERhdGFXaXRoVHlwZSA9IHBhdGhEYXRhSXRlbSBhcyBRdWFkcmF0aWNDdXJ2ZVRvQ29tbWFuZFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5xdWFkcmF0aWNCZXppZXJDdXJ2ZVRvUmVsYXRpdmUocGF0aERhdGFXaXRoVHlwZS54MSwgcGF0aERhdGFXaXRoVHlwZS55MSwgcGF0aERhdGFXaXRoVHlwZS54LCBwYXRoRGF0YVdpdGhUeXBlLnkpXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0EnOlxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhEYXRhV2l0aFR5cGUgPSBwYXRoRGF0YUl0ZW0gYXMgRWxsaXB0aWNhbEFyY0NvbW1hbmRcclxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIuYXJjVG8ocGF0aERhdGFXaXRoVHlwZS5yeCwgcGF0aERhdGFXaXRoVHlwZS5yeSwgcGF0aERhdGFXaXRoVHlwZS54QXhpc1JvdGF0aW9uLCB+fnBhdGhEYXRhV2l0aFR5cGUubGFyZ2VBcmMsIH5+cGF0aERhdGFXaXRoVHlwZS5zd2VlcCwgcGF0aERhdGFXaXRoVHlwZS54LCBwYXRoRGF0YVdpdGhUeXBlLnkpXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2EnOlxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhEYXRhV2l0aFR5cGUgPSBwYXRoRGF0YUl0ZW0gYXMgRWxsaXB0aWNhbEFyY0NvbW1hbmRcclxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIuYXJjVG9SZWxhdGl2ZShwYXRoRGF0YVdpdGhUeXBlLnJ4LCBwYXRoRGF0YVdpdGhUeXBlLnJ5LCBwYXRoRGF0YVdpdGhUeXBlLnhBeGlzUm90YXRpb24sIH5+cGF0aERhdGFXaXRoVHlwZS5sYXJnZUFyYywgfn5wYXRoRGF0YVdpdGhUeXBlLnN3ZWVwLCBwYXRoRGF0YVdpdGhUeXBlLngsIHBhdGhEYXRhV2l0aFR5cGUueSlcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnWic6XHJcbiAgICAgICAgICAgICAgICBjYXNlICd6JzpcclxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIuY2xvc2VQYXRoKClcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKHBhdGhEYXRhSXRlbSlcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGltcGxlbWVudGF0aW9uIGZvdW5kIGZvciB0aGlzIHBhdGggY29tbWFuZC4nKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICBwb3N0QWN0aW9ucyhwYXRoTWFrZXIpXHJcbiAgICB9IGVsc2UgaWYgKGRvbSBpbnN0YW5jZW9mIFNWR1BvbHlnb25FbGVtZW50IHx8IGRvbSBpbnN0YW5jZW9mIFNWR1BvbHlsaW5lRWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IHBvaW50cyA9IGRvbS5wb2ludHNcclxuICAgICAgICBpZiAocG9pbnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVyYWJsZVBvaW50czogRE9NUG9pbnRbXSA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHBvaW50cylcclxuICAgICAgICAgICAgY29uc3Qgb2Zmc2V0WCA9IGl0ZXJhYmxlUG9pbnRzLnJlZHVjZSgocCwgdikgPT4gTWF0aC5taW4ocCwgdi54KSwgMClcclxuICAgICAgICAgICAgY29uc3Qgb2Zmc2V0WSA9IGl0ZXJhYmxlUG9pbnRzLnJlZHVjZSgocCwgdikgPT4gTWF0aC5taW4ocCwgdi55KSwgMClcclxuICAgICAgICAgICAgY29uc3QgcGF0aE1ha2VyID0gbmV3IFBhdGhNYWtlcigpXHJcbiAgICAgICAgICAgIHBhdGhNYWtlci5tb3ZlVG8ocG9pbnRzWzBdLnggLSBvZmZzZXRYLCBwb2ludHNbMF0ueSAtIG9mZnNldFkpXHJcbiAgICAgICAgICAgIGl0ZXJhYmxlUG9pbnRzLmZvckVhY2goKHYsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChpIDw9IDApIHJldHVyblxyXG4gICAgICAgICAgICAgICAgcGF0aE1ha2VyLmxpbmVUbyh2LnggLSBvZmZzZXRYLCB2LnkgLSBvZmZzZXRZKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICBpZiAoZG9tIGluc3RhbmNlb2YgU1ZHUG9seWdvbkVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHBhdGhNYWtlci5jbG9zZVBhdGgoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBvc3RBY3Rpb25zKHBhdGhNYWtlcilcclxuICAgICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKGRvbSBpbnN0YW5jZW9mIFNWR1JlY3RFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgbWFwS2V5OiAoJ3dpZHRoJyB8ICdoZWlnaHQnKVtdID0gWyd3aWR0aCcsICdoZWlnaHQnXVxyXG4gICAgICAgIGNvbnN0IFt3aWR0aCwgaGVpZ2h0XSA9IG1hcEtleS5tYXAoa2V5ID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgc3ZnTGVuZ3RoID0gZG9tW2tleV0uYmFzZVZhbFxyXG4gICAgICAgICAgICBzdmdMZW5ndGguY29udmVydFRvU3BlY2lmaWVkVW5pdHMoU1ZHTGVuZ3RoLlNWR19MRU5HVEhUWVBFX1BYKVxyXG4gICAgICAgICAgICByZXR1cm4gc3ZnTGVuZ3RoLnZhbHVlSW5TcGVjaWZpZWRVbml0c1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgY29uc3QgcGF0aE1ha2VyID0gbmV3IFBhdGhNYWtlcigpXHJcbiAgICAgICAgcGF0aE1ha2VyLm1vdmVUbygwLCAwKVxyXG4gICAgICAgIHBhdGhNYWtlci5saW5lVG8od2lkdGgsIDApXHJcbiAgICAgICAgcGF0aE1ha2VyLmxpbmVUbyh3aWR0aCwgaGVpZ2h0KVxyXG4gICAgICAgIHBhdGhNYWtlci5saW5lVG8oMCwgaGVpZ2h0KVxyXG4gICAgICAgIHBhdGhNYWtlci5jbG9zZVBhdGgoKVxyXG4gICAgICAgIHBvc3RBY3Rpb25zKHBhdGhNYWtlcilcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihkb20pXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBpbXBsZW1lbnRhdGlvbiBmb3VuZCBmb3Igc3ZnIGdyYXBoaWNzIGVsZW1lbnQuJylcclxuICAgIH1cclxuICAgIHJldHVybiBbZ3JvdXBdXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlckdyb3VwKGRvbTogU1ZHR0VsZW1lbnQsIGJhc2VEb20/OiBTVkdHcmFwaGljc0VsZW1lbnQpOiBHcm91cFNoYXBlW10ge1xyXG4gICAgbGV0IGl0ZW1zOiBHcm91cFNoYXBlW10gPSBbXVxyXG4gICAgZG9tLmNoaWxkTm9kZXMuZm9yRWFjaChub2RlID0+IHtcclxuICAgICAgICBpZiAobm9kZSBpbnN0YW5jZW9mIFNWR0dyYXBoaWNzRWxlbWVudCkge1xyXG4gICAgICAgICAgICBpdGVtcyA9IHJlbmRlcihub2RlLCBiYXNlRG9tIHx8IGRvbSkuY29uY2F0KGl0ZW1zKVxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiAgICByZXR1cm4gaXRlbXNcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlclBsYWluR2x5cGgodHlwZTogJ3JlY3QnIHwgJ2VsbGlwc2UnLCBhcmdzOiBudW1iZXJbXSk6IEdyb3VwU2hhcGUge1xyXG4gICAgY29uc3QgZ3JvdXA6IEdyb3VwU2hhcGUgPSB7XHJcbiAgICAgICAgdHk6IFwiZ3JcIixcclxuICAgICAgICBpdDogW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0eTogJ3NoJyxcclxuICAgICAgICAgICAgICAgIGtzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgazogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBhOiAwXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgaGQ6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHR5OiAnc3QnLFxyXG4gICAgICAgICAgICAgICAgYzoge1xyXG4gICAgICAgICAgICAgICAgICAgIGs6IFsxLCAxLCAxLCAxXVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHc6IHtcclxuICAgICAgICAgICAgICAgICAgICBrOiAxXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgbzoge1xyXG4gICAgICAgICAgICAgICAgICAgIGs6IDEwMFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGxjOiBlbmNvZGVMaW5lQ2FwKCdidXR0JyksXHJcbiAgICAgICAgICAgICAgICBsajogZW5jb2RlTGluZUpvaW4oJ21pdGVyJylcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdHk6ICdmbCcsXHJcbiAgICAgICAgICAgICAgICBjOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgazogWzEsIDEsIDEsIDFdXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgbzoge1xyXG4gICAgICAgICAgICAgICAgICAgIGs6IDEwMFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0eTogJ3RyJyxcclxuICAgICAgICAgICAgICAgIHA6IHtcclxuICAgICAgICAgICAgICAgICAgICBrOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDBcclxuICAgICAgICAgICAgICAgICAgICBdXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYToge1xyXG4gICAgICAgICAgICAgICAgICAgIGs6IFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgMFxyXG4gICAgICAgICAgICAgICAgICAgIF1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgazogW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAxMDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDEwMFxyXG4gICAgICAgICAgICAgICAgICAgIF1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgazogMFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG86IHtcclxuICAgICAgICAgICAgICAgICAgICBrOiAxMDBcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzazoge1xyXG4gICAgICAgICAgICAgICAgICAgIGs6IDBcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzYToge1xyXG4gICAgICAgICAgICAgICAgICAgIGs6IDBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgYm06IDAsXHJcbiAgICAgICAgaGQ6IGZhbHNlXHJcbiAgICB9XHJcbiAgICBjb25zdCBwYXRoTWFrZXIgPSBuZXcgUGF0aE1ha2VyKClcclxuICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgIGNhc2UgJ3JlY3QnOlxyXG4gICAgICAgICAgICBwYXRoTWFrZXIubW92ZVRvKDAsIDApXHJcbiAgICAgICAgICAgIHBhdGhNYWtlci5saW5lVG8oYXJnc1swXSwgMClcclxuICAgICAgICAgICAgcGF0aE1ha2VyLmxpbmVUbyhhcmdzWzBdLCBhcmdzWzFdKVxyXG4gICAgICAgICAgICBwYXRoTWFrZXIubGluZVRvKDAsIGFyZ3NbMV0pXHJcbiAgICAgICAgICAgIHBhdGhNYWtlci5jbG9zZVBhdGgoKVxyXG4gICAgICAgICAgICBicmVha1xyXG4gICAgICAgIGNhc2UgJ2VsbGlwc2UnOlxyXG4gICAgICAgICAgICBwYXRoTWFrZXIubW92ZVRvKGFyZ3NbMF0sIDApXHJcbiAgICAgICAgICAgIHBhdGhNYWtlci5hcmNUbyhhcmdzWzBdLCBhcmdzWzFdLCAwLCAxLCAwLCBhcmdzWzBdLCAyICogYXJnc1sxXSlcclxuICAgICAgICAgICAgcGF0aE1ha2VyLmFyY1RvKGFyZ3NbMF0sIGFyZ3NbMV0sIDAsIDEsIDAsIGFyZ3NbMF0sIDApXHJcbiAgICAgICAgICAgIHBhdGhNYWtlci5jbG9zZVBhdGgoKVxyXG4gICAgfVxyXG4gICAgcGF0aE1ha2VyLnVuaWZvcm0oKTtcclxuICAgIChncm91cC5pdCFbMF0gYXMgUGF0aFNoYXBlKS5rcyEuayA9IHBhdGhNYWtlci5wYXRoXHJcbiAgICByZXR1cm4gZ3JvdXBcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlclRleHQoZG9tOiBTVkdUZXh0RWxlbWVudCwgZm9udExpc3Q/OiBGb250cyk6IFtUZXh0RGF0YSwgRm9udDFdIHtcclxuICAgIGNvbnN0IGNvbXB1dGVkU3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKGRvbSlcclxuICAgIGNvbnN0IGZvbnRTaXplID0gcGFyc2VGbG9hdChjb21wdXRlZFN0eWxlLmZvbnRTaXplKSxcclxuICAgICAgICBmb250RmFtaWx5ID0gY29tcHV0ZWRTdHlsZS5mb250RmFtaWx5LnNwbGl0KCcsJylbMF0udHJpbSgpLFxyXG4gICAgICAgIGZvbnRTdHlsZSA9IGNvbXB1dGVkU3R5bGUuZm9udFN0eWxlLFxyXG4gICAgICAgIGZvbnRXZWlnaHQgPSBjb21wdXRlZFN0eWxlLmZvbnRXZWlnaHQsXHJcbiAgICAgICAgZm9udENvbG9yID0gKGNvbXB1dGVkU3R5bGUuZmlsbCB8fCAncmdiKDAsMCwwKScpLnNwbGl0KCcoJylbMV0uc3BsaXQoJyknKVswXS5zcGxpdCgnLCcpLm1hcChpID0+IHBhcnNlSW50KGkpIC8gMjU1KVxyXG4gICAgbGV0IGZvbnROYW1lID0gdXVpZCgpXHJcbiAgICBpZiAoZm9udExpc3QpIHtcclxuICAgICAgICBjb25zdCBmb250RXhpc3QgPSBmb250TGlzdC5saXN0IS5maWx0ZXIoZm9udCA9PiBmb250LmZGYW1pbHkgPT0gZm9udEZhbWlseSAmJiBmb250LmZTdHlsZSA9PSBmb250U3R5bGUgJiYgZm9udC5mV2VpZ2h0ID09IGZvbnRXZWlnaHQpXHJcbiAgICAgICAgaWYgKGZvbnRFeGlzdC5sZW5ndGgpXHJcbiAgICAgICAgICAgIGZvbnROYW1lID0gZm9udEV4aXN0WzBdLmZOYW1lIVxyXG4gICAgfVxyXG4gICAgY29uc3QgdGV4dERhdGE6IFRleHREYXRhID0ge1xyXG4gICAgICAgIGQ6IHtcclxuICAgICAgICAgICAgazogW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHQ6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzOiBmb250U2l6ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZjogZm9udE5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQ6IGRvbS5pbm5lckhUTUwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGo6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsczogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmM6IGZvbnRDb2xvclxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcDoge30sXHJcbiAgICAgICAgbToge1xyXG4gICAgICAgICAgICBhOiB7XHJcbiAgICAgICAgICAgICAgICBrOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgMCxcclxuICAgICAgICAgICAgICAgICAgICAwXHJcbiAgICAgICAgICAgICAgICBdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGE6IFtdXHJcbiAgICB9XHJcbiAgICBjb25zdCBmb250RGVmOiBGb250MSA9IHtcclxuICAgICAgICBmRmFtaWx5OiBmb250RmFtaWx5LFxyXG4gICAgICAgIGZXZWlnaHQ6IGAke2ZvbnRXZWlnaHR9YCxcclxuICAgICAgICBmU3R5bGU6IGZvbnRTdHlsZSxcclxuICAgICAgICBmTmFtZTogZm9udE5hbWVcclxuICAgIH1cclxuICAgIHJldHVybiBbdGV4dERhdGEsIGZvbnREZWZdXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJJbWFnZShkb206IFNWR0ltYWdlRWxlbWVudCwgYXNzZXRMaXN0PzogQXNzZXRzKTogW1JlZmVyZW5jZUlELCBJbWFnZUFzc2V0XSB7XHJcbiAgICBsZXQgaWQgPSB1dWlkKClcclxuICAgIGNvbnN0IGRvbUhlaWdodFZhbCA9IGRvbS5oZWlnaHQuYmFzZVZhbFxyXG4gICAgZG9tSGVpZ2h0VmFsLmNvbnZlcnRUb1NwZWNpZmllZFVuaXRzKFNWR0xlbmd0aC5TVkdfTEVOR1RIVFlQRV9QWClcclxuICAgIGNvbnN0IGRvbVdpZHRoVmFsID0gZG9tLndpZHRoLmJhc2VWYWxcclxuICAgIGRvbVdpZHRoVmFsLmNvbnZlcnRUb1NwZWNpZmllZFVuaXRzKFNWR0xlbmd0aC5TVkdfTEVOR1RIVFlQRV9QWClcclxuICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpXHJcbiAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKVxyXG5cclxuICAgIGNhbnZhcy53aWR0aCA9IGRvbVdpZHRoVmFsLnZhbHVlSW5TcGVjaWZpZWRVbml0cyAqIDNcclxuICAgIGNhbnZhcy5oZWlnaHQgPSBkb21IZWlnaHRWYWwudmFsdWVJblNwZWNpZmllZFVuaXRzICogM1xyXG4gICAgY3R4IS5kcmF3SW1hZ2UoZG9tLCAwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpXHJcblxyXG4gICAgY29uc3QgZGF0YVVybCA9IGNhbnZhcy50b0RhdGFVUkwoKVxyXG4gICAgaWYgKGFzc2V0TGlzdCkge1xyXG4gICAgICAgIGNvbnN0IGFzc2V0RXhpc3QgPSBhc3NldExpc3QhLmZpbHRlcihhc3NldCA9PiBhc3NldC5wID09IGRhdGFVcmwpXHJcbiAgICAgICAgaWYgKGFzc2V0RXhpc3QubGVuZ3RoKVxyXG4gICAgICAgICAgICBpZCA9IGFzc2V0RXhpc3RbMF0uaWQhXHJcbiAgICB9XHJcbiAgICBjb25zdCBhc3NldCA9IHtcclxuICAgICAgICBoOiBkb21IZWlnaHRWYWwudmFsdWVJblNwZWNpZmllZFVuaXRzLFxyXG4gICAgICAgIHc6IGRvbVdpZHRoVmFsLnZhbHVlSW5TcGVjaWZpZWRVbml0cyxcclxuICAgICAgICBpZCxcclxuICAgICAgICBwOiBkYXRhVXJsLFxyXG4gICAgICAgIGU6IDFcclxuICAgIH1cclxuICAgIHJldHVybiBbaWQsIGFzc2V0XVxyXG59Il19
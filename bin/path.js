"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.PathMaker = void 0;

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var PathMaker =
/*#__PURE__*/
function () {
  function PathMaker() {
    _classCallCheck(this, PathMaker);

    _defineProperty(this, "path", {
      c: false,
      i: [],
      o: [],
      v: []
    });

    _defineProperty(this, "currentX", 0);

    _defineProperty(this, "currentY", 0);
  }

  _createClass(PathMaker, [{
    key: "moveTo",
    value: function moveTo(x, y) {
      this.path.c = false;
      this.path.i = [[0, 0]];
      this.path.o = [];
      this.path.v = [[x, y]];
      this.currentX = x;
      this.currentY = y;
    }
  }, {
    key: "lineTo",
    value: function lineTo(x, y) {
      this.path.i.push([0, 0]);
      this.path.o.push([0, 0]);
      this.path.v.push([x, y]);
      this.currentX = x;
      this.currentY = y;
    }
  }, {
    key: "lineToRelative",
    value: function lineToRelative(x, y) {
      this.lineTo(this.currentX + x, this.currentY + y);
    }
  }, {
    key: "horizontalTo",
    value: function horizontalTo(x) {
      this.lineTo(x, this.currentY);
    }
  }, {
    key: "horizontalToRelative",
    value: function horizontalToRelative(x) {
      this.horizontalTo(this.currentX + x);
    }
  }, {
    key: "verticalTo",
    value: function verticalTo(y) {
      this.lineTo(this.currentX, y);
    }
  }, {
    key: "verticalToRelative",
    value: function verticalToRelative(y) {
      this.verticalTo(this.currentY + y);
    }
  }, {
    key: "cubicBezierCurveTo",
    value: function cubicBezierCurveTo(c1x, c1y, c2x, c2y, x, y) {
      this.path.i.push([c2x - x, c2y - y]);
      this.path.o.push([c1x - this.currentX, c1y - this.currentY]);
      this.path.v.push([x, y]);
      this.currentX = x;
      this.currentY = y;
    }
  }, {
    key: "cubicBezierCurveToRelative",
    value: function cubicBezierCurveToRelative(c1x, c1y, c2x, c2y, x, y) {
      this.cubicBezierCurveTo(this.currentX + c1x, this.currentY + c1y, this.currentX + c2x, this.currentY + c2y, this.currentX + x, this.currentY + y);
    }
  }, {
    key: "quadraticBezierCurveTo",
    value: function quadraticBezierCurveTo(cx, cy, x, y) {
      this.path.i.push([cx - x, cy - y]);
      this.path.o.push([cx - this.currentX, cy - this.currentY]);
      this.path.v.push([x, y]);
      this.currentX = x;
      this.currentY = y;
    }
  }, {
    key: "quadraticBezierCurveToRelative",
    value: function quadraticBezierCurveToRelative(cx, cy, x, y) {
      this.quadraticBezierCurveTo(this.currentX + cx, this.currentY + cy, this.currentX + x, this.currentY + y);
    }
  }, {
    key: "arcTo",
    value: function arcTo(rx, ry, xAxisRotation, largeArcFlag, sweepFlag, x, y) {
      var cSeries = PathMaker.a2c(this.currentX, this.currentY, rx, ry, xAxisRotation, largeArcFlag, sweepFlag, x, y);

      while (cSeries.length >= 6) {
        var iovList = cSeries.splice(0, 6);
        this.path.i.push([iovList[2] - iovList[4], iovList[3] - iovList[5]]);
        this.path.o.push([iovList[0] - this.currentX, iovList[1] - this.currentY]);
        this.path.v.push([iovList[4], iovList[5]]);
        this.currentX = iovList[4];
        this.currentY = iovList[5];
      }
    }
  }, {
    key: "arcToRelative",
    value: function arcToRelative(rx, ry, xAxisRotation, largeArcFlag, sweepFlag, x, y) {
      this.arcTo(rx, ry, xAxisRotation, largeArcFlag, sweepFlag, this.currentX + x, this.currentY + y);
    }
  }, {
    key: "closePath",
    value: function closePath() {
      this.path.c = true;
    }
  }, {
    key: "uniform",
    value: function uniform() {
      while (this.path.o.length < this.path.i.length) {
        this.path.o.push([0, 0]);
      }
    }
  }], [{
    key: "a2c",
    value: function a2c(x1, y1, rx, ry, angle, large_arc_flag, sweep_flag, x2, y2, recursive) {
      // for more information of where this Math came from visit:
      // http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes
      var _120 = Math.PI * 120 / 180,
          rad = Math.PI / 180 * (+angle || 0),
          res = [],
          xy,
          rotate = function rotate(x, y, rad) {
        var X = x * Math.cos(rad) - y * Math.sin(rad),
            Y = x * Math.sin(rad) + y * Math.cos(rad);
        return {
          x: X,
          y: Y
        };
      };

      if (!rx || !ry) {
        return [x1, y1, x2, y2, x2, y2];
      }

      if (!recursive) {
        xy = rotate(x1, y1, -rad);
        x1 = xy.x;
        y1 = xy.y;
        xy = rotate(x2, y2, -rad);
        x2 = xy.x;
        y2 = xy.y;
        var cos = Math.cos(Math.PI / 180 * angle),
            sin = Math.sin(Math.PI / 180 * angle),
            x = (x1 - x2) / 2,
            y = (y1 - y2) / 2;
        var h = x * x / (rx * rx) + y * y / (ry * ry);

        if (h > 1) {
          h = Math.sqrt(h);
          rx = h * rx;
          ry = h * ry;
        }

        var rx2 = rx * rx,
            ry2 = ry * ry,
            k = (large_arc_flag == sweep_flag ? -1 : 1) * Math.sqrt(Math.abs((rx2 * ry2 - rx2 * y * y - ry2 * x * x) / (rx2 * y * y + ry2 * x * x))),
            cx = k * rx * y / ry + (x1 + x2) / 2,
            cy = k * -ry * x / rx + (y1 + y2) / 2,
            f1 = Math.asin((y1 - cy) / ry),
            f2 = Math.asin((y2 - cy) / ry);
        f1 = x1 < cx ? Math.PI - f1 : f1;
        f2 = x2 < cx ? Math.PI - f2 : f2;
        f1 < 0 && (f1 = Math.PI * 2 + f1);
        f2 < 0 && (f2 = Math.PI * 2 + f2);

        if (sweep_flag && f1 > f2) {
          f1 = f1 - Math.PI * 2;
        }

        if (!sweep_flag && f2 > f1) {
          f2 = f2 - Math.PI * 2;
        }
      } else {
        f1 = recursive[0];
        f2 = recursive[1];
        cx = recursive[2];
        cy = recursive[3];
      }

      var df = f2 - f1;

      if (Math.abs(df) > _120) {
        var f2old = f2,
            x2old = x2,
            y2old = y2;
        f2 = f1 + _120 * (sweep_flag && f2 > f1 ? 1 : -1);
        x2 = cx + rx * Math.cos(f2);
        y2 = cy + ry * Math.sin(f2);
        res = this.a2c(x2, y2, rx, ry, angle, 0, sweep_flag, x2old, y2old, [f2, f2old, cx, cy]);
      }

      df = f2 - f1;
      var c1 = Math.cos(f1),
          s1 = Math.sin(f1),
          c2 = Math.cos(f2),
          s2 = Math.sin(f2),
          t = Math.tan(df / 4),
          hx = 4 / 3 * rx * t,
          hy = 4 / 3 * ry * t,
          m1 = [x1, y1],
          m2 = [x1 + hx * s1, y1 - hy * c1],
          m3 = [x2 + hx * s2, y2 - hy * c2],
          m4 = [x2, y2];
      m2[0] = 2 * m1[0] - m2[0];
      m2[1] = 2 * m1[1] - m2[1];

      if (recursive) {
        return [m2, m3, m4].concat(res);
      } else {
        res = [m2, m3, m4].concat(res).join().split(",").map(function (x) {
          return parseFloat(x);
        });
        var newres = [];

        for (var i = 0, ii = res.length; i < ii; i++) {
          newres[i] = i % 2 ? rotate(res[i - 1], res[i], rad).y : rotate(res[i], res[i + 1], rad).x;
        }

        return newres;
      }
    }
  }]);

  return PathMaker;
}();

exports.PathMaker = PathMaker;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9wYXRoLnRzIl0sIm5hbWVzIjpbIlBhdGhNYWtlciIsImMiLCJpIiwibyIsInYiLCJ4IiwieSIsInBhdGgiLCJjdXJyZW50WCIsImN1cnJlbnRZIiwicHVzaCIsImxpbmVUbyIsImhvcml6b250YWxUbyIsInZlcnRpY2FsVG8iLCJjMXgiLCJjMXkiLCJjMngiLCJjMnkiLCJjdWJpY0JlemllckN1cnZlVG8iLCJjeCIsImN5IiwicXVhZHJhdGljQmV6aWVyQ3VydmVUbyIsInJ4IiwicnkiLCJ4QXhpc1JvdGF0aW9uIiwibGFyZ2VBcmNGbGFnIiwic3dlZXBGbGFnIiwiY1NlcmllcyIsImEyYyIsImxlbmd0aCIsImlvdkxpc3QiLCJzcGxpY2UiLCJhcmNUbyIsIngxIiwieTEiLCJhbmdsZSIsImxhcmdlX2FyY19mbGFnIiwic3dlZXBfZmxhZyIsIngyIiwieTIiLCJyZWN1cnNpdmUiLCJfMTIwIiwiTWF0aCIsIlBJIiwicmFkIiwicmVzIiwieHkiLCJyb3RhdGUiLCJYIiwiY29zIiwic2luIiwiWSIsImgiLCJzcXJ0IiwicngyIiwicnkyIiwiayIsImFicyIsImYxIiwiYXNpbiIsImYyIiwiZGYiLCJmMm9sZCIsIngyb2xkIiwieTJvbGQiLCJjMSIsInMxIiwiYzIiLCJzMiIsInQiLCJ0YW4iLCJoeCIsImh5IiwibTEiLCJtMiIsIm0zIiwibTQiLCJjb25jYXQiLCJqb2luIiwic3BsaXQiLCJtYXAiLCJwYXJzZUZsb2F0IiwibmV3cmVzIiwiaWkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztJQUVhQSxTOzs7Ozs7a0NBQ2M7QUFDbkJDLE1BQUFBLENBQUMsRUFBRSxLQURnQjtBQUVuQkMsTUFBQUEsQ0FBQyxFQUFFLEVBRmdCO0FBR25CQyxNQUFBQSxDQUFDLEVBQUUsRUFIZ0I7QUFJbkJDLE1BQUFBLENBQUMsRUFBRTtBQUpnQixLOztzQ0FPRyxDOztzQ0FDQSxDOzs7OzsyQkFFWkMsQyxFQUFXQyxDLEVBQVc7QUFDaEMsV0FBS0MsSUFB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QUFTMkMsR0FBRyxDQUFDM0MsQ0FBQyxHQUFHLENBQUwsQ0FBWixFQUFxQjBDLEdBQXJCLENBQU4sQ0FBZ0N2QyxDQUF4RjtBQUNIOztBQUNELGVBQU82RSxNQUFQO0FBQ0g7QUFDSiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhdGhEZWYgfSBmcm9tICcuL2FuaW1hdGlvbidcclxuXHJcbmV4cG9ydCBjbGFzcyBQYXRoTWFrZXIge1xyXG4gICAgcHVibGljIHBhdGg6IFBhdGhEZWYgPSB7XHJcbiAgICAgICAgYzogZmFsc2UsXHJcbiAgICAgICAgaTogW10sXHJcbiAgICAgICAgbzogW10sXHJcbiAgICAgICAgdjogW11cclxuICAgIH07XHJcblxyXG4gICAgcHVibGljIGN1cnJlbnRYOiBudW1iZXIgPSAwO1xyXG4gICAgcHVibGljIGN1cnJlbnRZOiBudW1iZXIgPSAwO1xyXG5cclxuICAgIHB1YmxpYyBtb3ZlVG8oeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLnBhdGguYyA9IGZhbHNlXHJcbiAgICAgICAgdGhpcy5wYXRoLmkgPSBbWzAsIDBdXVxyXG4gICAgICAgIHRoaXMucGF0aC5vID0gW11cclxuICAgICAgICB0aGlzLnBhdGgudiA9IFtbeCwgeV1dXHJcbiAgICAgICAgdGhpcy5jdXJyZW50WCA9IHhcclxuICAgICAgICB0aGlzLmN1cnJlbnRZID0geVxyXG4gICAgfVxyXG4gICAgcHVibGljIGxpbmVUbyh4OiBudW1iZXIsIHk6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMucGF0aC5pIS5wdXNoKFswLCAwXSlcclxuICAgICAgICB0aGlzLnBhdGgubyEucHVzaChbMCwgMF0pXHJcbiAgICAgICAgdGhpcy5wYXRoLnYhLnB1c2goW3gsIHldKVxyXG4gICAgICAgIHRoaXMuY3VycmVudFggPSB4XHJcbiAgICAgICAgdGhpcy5jdXJyZW50WSA9IHlcclxuICAgIH1cclxuICAgIHB1YmxpYyBsaW5lVG9SZWxhdGl2ZSh4OiBudW1iZXIsIHk6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMubGluZVRvKHRoaXMuY3VycmVudFggKyB4LCB0aGlzLmN1cnJlbnRZICsgeSlcclxuICAgIH1cclxuICAgIHB1YmxpYyBob3Jpem9udGFsVG8oeDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5saW5lVG8oeCwgdGhpcy5jdXJyZW50WSlcclxuICAgIH1cclxuICAgIHB1YmxpYyBob3Jpem9udGFsVG9SZWxhdGl2ZSh4OiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLmhvcml6b250YWxUbyh0aGlzLmN1cnJlbnRYICsgeClcclxuICAgIH1cclxuICAgIHB1YmxpYyB2ZXJ0aWNhbFRvKHk6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMubGluZVRvKHRoaXMuY3VycmVudFgsIHkpXHJcbiAgICB9XHJcbiAgICBwdWJsaWMgdmVydGljYWxUb1JlbGF0aXZlKHk6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMudmVydGljYWxUbyh0aGlzLmN1cnJlbnRZICsgeSlcclxuICAgIH1cclxuICAgIHB1YmxpYyBjdWJpY0JlemllckN1cnZlVG8oXHJcbiAgICAgICAgYzF4OiBudW1iZXIsXHJcbiAgICAgICAgYzF5OiBudW1iZXIsXHJcbiAgICAgICAgYzJ4OiBudW1iZXIsXHJcbiAgICAgICAgYzJ5OiBudW1iZXIsXHJcbiAgICAgICAgeDogbnVtYmVyLFxyXG4gICAgICAgIHk6IG51bWJlclxyXG4gICAgKSB7XHJcbiAgICAgICAgdGhpcy5wYXRoLmkhLnB1c2goW2MyeCAtIHgsIGMyeSAtIHldKVxyXG4gICAgICAgIHRoaXMucGF0aC5vIS5wdXNoKFtjMXggLSB0aGlzLmN1cnJlbnRYLCBjMXkgLSB0aGlzLmN1cnJlbnRZXSlcclxuICAgICAgICB0aGlzLnBhdGgudiEucHVzaChbeCwgeV0pXHJcbiAgICAgICAgdGhpcy5jdXJyZW50WCA9IHhcclxuICAgICAgICB0aGlzLmN1cnJlbnRZID0geVxyXG4gICAgfVxyXG4gICAgcHVibGljIGN1YmljQmV6aWVyQ3VydmVUb1JlbGF0aXZlKFxyXG4gICAgICAgIGMxeDogbnVtYmVyLFxyXG4gICAgICAgIGMxeTogbnVtYmVyLFxyXG4gICAgICAgIGMyeDogbnVtYmVyLFxyXG4gICAgICAgIGMyeTogbnVtYmVyLFxyXG4gICAgICAgIHg6IG51bWJlcixcclxuICAgICAgICB5OiBudW1iZXJcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuY3ViaWNCZXppZXJDdXJ2ZVRvKHRoaXMuY3VycmVudFggKyBjMXgsIHRoaXMuY3VycmVudFkgKyBjMXksIHRoaXMuY3VycmVudFggKyBjMngsIHRoaXMuY3VycmVudFkgKyBjMnksIHRoaXMuY3VycmVudFggKyB4LCB0aGlzLmN1cnJlbnRZICsgeSlcclxuICAgIH1cclxuICAgIHB1YmxpYyBxdWFkcmF0aWNCZXppZXJDdXJ2ZVRvKGN4OiBudW1iZXIsIGN5OiBudW1iZXIsIHg6IG51bWJlciwgeTogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5wYXRoLmkhLnB1c2goW2N4IC0geCwgY3kgLSB5XSlcclxuICAgICAgICB0aGlzLnBhdGgubyEucHVzaChbY3ggLSB0aGlzLmN1cnJlbnRYLCBjeSAtIHRoaXMuY3VycmVudFldKVxyXG4gICAgICAgIHRoaXMucGF0aC52IS5wdXNoKFt4LCB5XSlcclxuICAgICAgICB0aGlzLmN1cnJlbnRYID0geFxyXG4gICAgICAgIHRoaXMuY3VycmVudFkgPSB5XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgcXVhZHJhdGljQmV6aWVyQ3VydmVUb1JlbGF0aXZlKGN4OiBudW1iZXIsIGN5OiBudW1iZXIsIHg6IG51bWJlciwgeTogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5xdWFkcmF0aWNCZXppZXJDdXJ2ZVRvKHRoaXMuY3VycmVudFggKyBjeCwgdGhpcy5jdXJyZW50WSArIGN5LCB0aGlzLmN1cnJlbnRYICsgeCwgdGhpcy5jdXJyZW50WSArIHkpXHJcbiAgICB9XHJcbiAgICBwdWJsaWMgYXJjVG8oXHJcbiAgICAgICAgcng6IG51bWJlcixcclxuICAgICAgICByeTogbnVtYmVyLFxyXG4gICAgICAgIHhBeGlzUm90YXRpb246IG51bWJlcixcclxuICAgICAgICBsYXJnZUFyY0ZsYWc6IG51bWJlcixcclxuICAgICAgICBzd2VlcEZsYWc6IG51bWJlcixcclxuICAgICAgICB4OiBudW1iZXIsXHJcbiAgICAgICAgeTogbnVtYmVyXHJcbiAgICApIHtcclxuICAgICAgICBjb25zdCBjU2VyaWVzID0gUGF0aE1ha2VyLmEyYyh0aGlzLmN1cnJlbnRYLCB0aGlzLmN1cnJlbnRZLCByeCwgcnksIHhBeGlzUm90YXRpb24sIGxhcmdlQXJjRmxhZywgc3dlZXBGbGFnLCB4LCB5KSBhcyBudW1iZXJbXVxyXG4gICAgICAgIHdoaWxlIChjU2VyaWVzLmxlbmd0aCA+PSA2KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlvdkxpc3QgPSBjU2VyaWVzLnNwbGljZSgwLCA2KVxyXG4gICAgICAgICAgICB0aGlzLnBhdGguaSEucHVzaChbaW92TGlzdFsyXSAtIGlvdkxpc3RbNF0sIGlvdkxpc3RbM10gLSBpb3ZMaXN0WzVdXSlcclxuICAgICAgICAgICAgdGhpcy5wYXRoLm8hLnB1c2goW2lvdkxpc3RbMF0gLSB0aGlzLmN1cnJlbnRYLCBpb3ZMaXN0WzFdIC0gdGhpcy5jdXJyZW50WV0pXHJcbiAgICAgICAgICAgIHRoaXMucGF0aC52IS5wdXNoKFtpb3ZMaXN0WzRdLCBpb3ZMaXN0WzVdXSlcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50WCA9IGlvdkxpc3RbNF1cclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50WSA9IGlvdkxpc3RbNV1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgYXJjVG9SZWxhdGl2ZShcclxuICAgICAgICByeDogbnVtYmVyLFxyXG4gICAgICAgIHJ5OiBudW1iZXIsXHJcbiAgICAgICAgeEF4aXNSb3RhdGlvbjogbnVtYmVyLFxyXG4gICAgICAgIGxhcmdlQXJjRmxhZzogbnVtYmVyLFxyXG4gICAgICAgIHN3ZWVwRmxhZzogbnVtYmVyLFxyXG4gICAgICAgIHg6IG51bWJlcixcclxuICAgICAgICB5OiBudW1iZXJcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuYXJjVG8ocngsIHJ5LCB4QXhpc1JvdGF0aW9uLCBsYXJnZUFyY0ZsYWcsIHN3ZWVwRmxhZywgdGhpcy5jdXJyZW50WCArIHgsIHRoaXMuY3VycmVudFkgKyB5KVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIGEyYyh4MTogbnVtYmVyLCB5MTogbnVtYmVyLCByeDogbnVtYmVyLCByeTogbnVtYmVyLCBhbmdsZTogbnVtYmVyLCBsYXJnZV9hcmNfZmxhZzogbnVtYmVyLCBzd2VlcF9mbGFnOiBudW1iZXIsIHgyOiBudW1iZXIsIHkyOiBudW1iZXIsIHJlY3Vyc2l2ZT86IG51bWJlcltdKTogbnVtYmVyW10gfCBudW1iZXJbXVtdIHtcclxuICAgICAgICAvLyBmb3IgbW9yZSBpbmZvcm1hdGlvbiBvZiB3aGVyZSB0aGlzIE1hdGggY2FtZSBmcm9tIHZpc2l0OlxyXG4gICAgICAgIC8vIGh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ltcGxub3RlLmh0bWwjQXJjSW1wbGVtZW50YXRpb25Ob3Rlc1xyXG4gICAgICAgIHZhciBfMTIwID0gTWF0aC5QSSAqIDEyMCAvIDE4MCxcclxuICAgICAgICAgICAgcmFkID0gTWF0aC5QSSAvIDE4MCAqICgrYW5nbGUgfHwgMCksXHJcbiAgICAgICAgICAgIHJlczogbnVtYmVyW10gPSBbXSxcclxuICAgICAgICAgICAgeHksXHJcbiAgICAgICAgICAgIHJvdGF0ZSA9ICh4OiBudW1iZXIsIHk6IG51bWJlciwgcmFkOiBudW1iZXIpID0+IHtcclxuICAgICAgICAgICAgICAgIHZhciBYID0geCAqIE1hdGguY29zKHJhZCkgLSB5ICogTWF0aC5zaW4ocmFkKSxcclxuICAgICAgICAgICAgICAgICAgICBZID0geCAqIE1hdGguc2luKHJhZCkgKyB5ICogTWF0aC5jb3MocmFkKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7IHg6IFgsIHk6IFkgfTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICBpZiAoIXJ4IHx8ICFyeSkge1xyXG4gICAgICAgICAgICByZXR1cm4gW3gxLCB5MSwgeDIsIHkyLCB4MiwgeTJdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXJlY3Vyc2l2ZSkge1xyXG4gICAgICAgICAgICB4eSA9IHJvdGF0ZSh4MSwgeTEsIC1yYWQpO1xyXG4gICAgICAgICAgICB4MSA9IHh5Lng7XHJcbiAgICAgICAgICAgIHkxID0geHkueTtcclxuICAgICAgICAgICAgeHkgPSByb3RhdGUoeDIsIHkyLCAtcmFkKTtcclxuICAgICAgICAgICAgeDIgPSB4eS54O1xyXG4gICAgICAgICAgICB5MiA9IHh5Lnk7XHJcbiAgICAgICAgICAgIHZhciBjb3MgPSBNYXRoLmNvcyhNYXRoLlBJIC8gMTgwICogYW5nbGUpLFxyXG4gICAgICAgICAgICAgICAgc2luID0gTWF0aC5zaW4oTWF0aC5QSSAvIDE4MCAqIGFuZ2xlKSxcclxuICAgICAgICAgICAgICAgIHggPSAoeDEgLSB4MikgLyAyLFxyXG4gICAgICAgICAgICAgICAgeSA9ICh5MSAtIHkyKSAvIDI7XHJcbiAgICAgICAgICAgIHZhciBoID0geCAqIHggLyAocnggKiByeCkgKyB5ICogeSAvIChyeSAqIHJ5KTtcclxuICAgICAgICAgICAgaWYgKGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICBoID0gTWF0aC5zcXJ0KGgpO1xyXG4gICAgICAgICAgICAgICAgcnggPSBoICogcng7XHJcbiAgICAgICAgICAgICAgICByeSA9IGggKiByeTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgcngyID0gcnggKiByeCxcclxuICAgICAgICAgICAgICAgIHJ5MiA9IHJ5ICogcnksXHJcbiAgICAgICAgICAgICAgICBrID0gKGxhcmdlX2FyY19mbGFnID09IHN3ZWVwX2ZsYWcgPyAtMSA6IDEpICpcclxuICAgICAgICAgICAgICAgICAgICBNYXRoLnNxcnQoTWF0aC5hYnMoKHJ4MiAqIHJ5MiAtIHJ4MiAqIHkgKiB5IC0gcnkyICogeCAqIHgpIC8gKHJ4MiAqIHkgKiB5ICsgcnkyICogeCAqIHgpKSksXHJcbiAgICAgICAgICAgICAgICBjeCA9IGsgKiByeCAqIHkgLyByeSArICh4MSArIHgyKSAvIDIsXHJcbiAgICAgICAgICAgICAgICBjeSA9IGsgKiAtcnkgKiB4IC8gcnggKyAoeTEgKyB5MikgLyAyLFxyXG4gICAgICAgICAgICAgICAgZjEgPSBNYXRoLmFzaW4oKHkxIC0gY3kpIC8gcnkpLFxyXG4gICAgICAgICAgICAgICAgZjIgPSBNYXRoLmFzaW4oKHkyIC0gY3kpIC8gcnkpO1xyXG5cclxuICAgICAgICAgICAgZjEgPSB4MSA8IGN4ID8gTWF0aC5QSSAtIGYxIDogZjE7XHJcbiAgICAgICAgICAgIGYyID0geDIgPCBjeCA/IE1hdGguUEkgLSBmMiA6IGYyO1xyXG4gICAgICAgICAgICBmMSA8IDAgJiYgKGYxID0gTWF0aC5QSSAqIDIgKyBmMSk7XHJcbiAgICAgICAgICAgIGYyIDwgMCAmJiAoZjIgPSBNYXRoLlBJICogMiArIGYyKTtcclxuICAgICAgICAgICAgaWYgKHN3ZWVwX2ZsYWcgJiYgZjEgPiBmMikge1xyXG4gICAgICAgICAgICAgICAgZjEgPSBmMSAtIE1hdGguUEkgKiAyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghc3dlZXBfZmxhZyAmJiBmMiA+IGYxKSB7XHJcbiAgICAgICAgICAgICAgICBmMiA9IGYyIC0gTWF0aC5QSSAqIDI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBmMSA9IHJlY3Vyc2l2ZVswXTtcclxuICAgICAgICAgICAgZjIgPSByZWN1cnNpdmVbMV07XHJcbiAgICAgICAgICAgIGN4ID0gcmVjdXJzaXZlWzJdO1xyXG4gICAgICAgICAgICBjeSA9IHJlY3Vyc2l2ZVszXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGRmID0gZjIgLSBmMTtcclxuICAgICAgICBpZiAoTWF0aC5hYnMoZGYpID4gXzEyMCkge1xyXG4gICAgICAgICAgICB2YXIgZjJvbGQgPSBmMixcclxuICAgICAgICAgICAgICAgIHgyb2xkID0geDIsXHJcbiAgICAgICAgICAgICAgICB5Mm9sZCA9IHkyO1xyXG4gICAgICAgICAgICBmMiA9IGYxICsgXzEyMCAqIChzd2VlcF9mbGFnICYmIGYyID4gZjEgPyAxIDogLTEpO1xyXG4gICAgICAgICAgICB4MiA9IGN4ICsgcnggKiBNYXRoLmNvcyhmMik7XHJcbiAgICAgICAgICAgIHkyID0gY3kgKyByeSAqIE1hdGguc2luKGYyKTtcclxuICAgICAgICAgICAgcmVzID0gdGhpcy5hMmMoeDIsIHkyLCByeCwgcnksIGFuZ2xlLCAwLCBzd2VlcF9mbGFnLCB4Mm9sZCwgeTJvbGQsIFtmMiwgZjJvbGQsIGN4LCBjeV0pIGFzIG51bWJlcltdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkZiA9IGYyIC0gZjE7XHJcbiAgICAgICAgdmFyIGMxID0gTWF0aC5jb3MoZjEpLFxyXG4gICAgICAgICAgICBzMSA9IE1hdGguc2luKGYxKSxcclxuICAgICAgICAgICAgYzIgPSBNYXRoLmNvcyhmMiksXHJcbiAgICAgICAgICAgIHMyID0gTWF0aC5zaW4oZjIpLFxyXG4gICAgICAgICAgICB0ID0gTWF0aC50YW4oZGYgLyA0KSxcclxuICAgICAgICAgICAgaHggPSA0IC8gMyAqIHJ4ICogdCxcclxuICAgICAgICAgICAgaHkgPSA0IC8gMyAqIHJ5ICogdCxcclxuICAgICAgICAgICAgbTEgPSBbeDEsIHkxXSxcclxuICAgICAgICAgICAgbTIgPSBbeDEgKyBoeCAqIHMxLCB5MSAtIGh5ICogYzFdLFxyXG4gICAgICAgICAgICBtMyA9IFt4MiArIGh4ICogczIsIHkyIC0gaHkgKiBjMl0sXHJcbiAgICAgICAgICAgIG00ID0gW3gyLCB5Ml07XHJcbiAgICAgICAgbTJbMF0gPSAyICogbTFbMF0gLSBtMlswXTtcclxuICAgICAgICBtMlsxXSA9IDIgKiBtMVsxXSAtIG0yWzFdO1xyXG4gICAgICAgIGlmIChyZWN1cnNpdmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFttMiwgbTMsIG00XS5jb25jYXQocmVzKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXMgPSBbbTIsIG0zLCBtNF0uY29uY2F0KHJlcykuam9pbigpLnNwbGl0KFwiLFwiKS5tYXAoeCA9PiBwYXJzZUZsb2F0KHgpKTtcclxuICAgICAgICAgICAgdmFyIG5ld3JlcyA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSByZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgbmV3cmVzW2ldID0gaSAlIDIgPyByb3RhdGUocmVzW2kgLSAxXSwgcmVzW2ldLCByYWQpLnkgOiByb3RhdGUocmVzW2ldLCByZXNbaSArIDFdLCByYWQpLng7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG5ld3JlcztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsb3NlUGF0aCgpIHtcclxuICAgICAgICB0aGlzLnBhdGguYyA9IHRydWVcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgdW5pZm9ybSgpIHtcclxuICAgICAgICB3aGlsZSAodGhpcy5wYXRoLm8hLmxlbmd0aCA8IHRoaXMucGF0aC5pIS5sZW5ndGgpXHJcbiAgICAgICAgICAgIHRoaXMucGF0aC5vIS5wdXNoKFswLCAwXSlcclxuICAgIH1cclxufSJdfQ==
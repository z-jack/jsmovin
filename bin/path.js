"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.PathMaker = void 0;

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var PathMaker =
/*#__PURE__*/
function () {
  function PathMaker() {
    _classCallCheck(this, PathMaker);

    _defineProperty(this, "path", {
      c: false,
      i: [],
      o: [],
      v: []
    });

    _defineProperty(this, "currentX", 0);

    _defineProperty(this, "currentY", 0);
  }

  _createClass(PathMaker, [{
    key: "moveTo",
    value: function moveTo(x, y) {
      this.path.c = false;
      this.path.i = [[0, 0]];
      this.path.o = [];
      this.path.v = [[x, y]];
      this.currentX = x;
      this.currentY = y;
    }
  }, {
    key: "lineTo",
    value: function lineTo(x, y) {
      this.path.i.push([0, 0]);
      this.path.o.push([0, 0]);
      this.path.v.push([x, y]);
      this.currentX = x;
      this.currentY = y;
    }
  }, {
    key: "lineToRelative",
    value: function lineToRelative(x, y) {
      this.lineTo(this.currentX + x, this.currentY + y);
    }
  }, {
    key: "horizontalTo",
    value: function horizontalTo(x) {
      this.lineTo(x, this.currentY);
    }
  }, {
    key: "horizontalToRelative",
    value: function horizontalToRelative(x) {
      this.horizontalTo(this.currentX + x);
    }
  }, {
    key: "verticalTo",
    value: function verticalTo(y) {
      this.lineTo(this.currentX, y);
    }
  }, {
    key: "verticalToRelative",
    value: function verticalToRelative(y) {
      this.verticalTo(this.currentY + y);
    }
  }, {
    key: "cubicBezierCurveTo",
    value: function cubicBezierCurveTo(c1x, c1y, c2x, c2y, x, y) {
      this.path.i.push([c2x - x, c2y - y]);
      this.path.o.push([c1x - this.currentX, c1y - this.currentY]);
      this.path.v.push([x, y]);
      this.currentX = x;
      this.currentY = y;
    }
  }, {
    key: "cubicBezierCurveToRelative",
    value: function cubicBezierCurveToRelative(c1x, c1y, c2x, c2y, x, y) {
      this.cubicBezierCurveTo(this.currentX + c1x, this.currentY + c1y, this.currentX + c2x, this.currentY + c2y, this.currentX + x, this.currentY + y);
    }
  }, {
    key: "quadraticBezierCurveTo",
    value: function quadraticBezierCurveTo(cx, cy, x, y) {
      this.path.i.push([cx - x, cy - y]);
      this.path.o.push([cx - this.currentX, cy - this.currentY]);
      this.path.v.push([x, y]);
      this.currentX = x;
      this.currentY = y;
    }
  }, {
    key: "quadraticBezierCurveToRelative",
    value: function quadraticBezierCurveToRelative(cx, cy, x, y) {
      this.quadraticBezierCurveTo(this.currentX + cx, this.currentY + cy, this.currentX + x, this.currentY + y);
    }
  }, {
    key: "arcTo",
    value: function arcTo(rx, ry, xAxisRotation, largeArcFlag, sweepFlag, x, y) {
      var cSeries = PathMaker.a2c(this.currentX, this.currentY, rx, ry, xAxisRotation, largeArcFlag, sweepFlag, x, y);

      while (cSeries.length >= 6) {
        var iovList = cSeries.splice(0, 6);
        this.path.i.push([iovList[2] - iovList[4], iovList[3] - iovList[5]]);
        this.path.o.push([iovList[0] - this.currentX, iovList[1] - this.currentY]);
        this.path.v.push([iovList[4], iovList[5]]);
        this.currentX = iovList[4];
        this.currentY = iovList[5];
      }
    }
  }, {
    key: "arcToRelative",
    value: function arcToRelative(rx, ry, xAxisRotation, largeArcFlag, sweepFlag, x, y) {
      this.arcTo(rx, ry, xAxisRotation, largeArcFlag, sweepFlag, this.currentX + x, this.currentY + y);
    }
  }, {
    key: "closePath",
    value: function closePath() {
      this.path.c = true;
    }
  }, {
    key: "uniform",
    value: function uniform() {
      while (this.path.o.length < this.path.i.length) {
        this.path.o.push([0, 0]);
      }
    }
  }], [{
    key: "a2c",
    value: function a2c(x1, y1, rx, ry, angle, large_arc_flag, sweep_flag, x2, y2, recursive) {
      // for more information of where this Math came from visit:
      // http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes
      var _120 = Math.PI * 120 / 180,
          rad = Math.PI / 180 * (+angle || 0),
          res = [],
          xy,
          rotate = function rotate(x, y, rad) {
        var X = x * Math.cos(rad) - y * Math.sin(rad),
            Y = x * Math.sin(rad) + y * Math.cos(rad);
        return {
          x: X,
          y: Y
        };
      };

      if (!rx || !ry) {
        return [x1, y1, x2, y2, x2, y2];
      }

      if (!recursive) {
        xy = rotate(x1, y1, -rad);
        x1 = xy.x;
        y1 = xy.y;
        xy = rotate(x2, y2, -rad);
        x2 = xy.x;
        y2 = xy.y;
        var cos = Math.cos(Math.PI / 180 * angle),
            sin = Math.sin(Math.PI / 180 * angle),
            x = (x1 - x2) / 2,
            y = (y1 - y2) / 2;
        var h = x * x / (rx * rx) + y * y / (ry * ry);

        if (h > 1) {
          h = Math.sqrt(h);
          rx = h * rx;
          ry = h * ry;
        }

        var rx2 = rx * rx,
            ry2 = ry * ry,
            k = (large_arc_flag == sweep_flag ? -1 : 1) * Math.sqrt(Math.abs((rx2 * ry2 - rx2 * y * y - ry2 * x * x) / (rx2 * y * y + ry2 * x * x))),
            cx = k * rx * y / ry + (x1 + x2) / 2,
            cy = k * -ry * x / rx + (y1 + y2) / 2,
            f1 = Math.asin((y1 - cy) / ry),
            f2 = Math.asin((y2 - cy) / ry);
        f1 = x1 < cx ? Math.PI - f1 : f1;
        f2 = x2 < cx ? Math.PI - f2 : f2;
        f1 < 0 && (f1 = Math.PI * 2 + f1);
        f2 < 0 && (f2 = Math.PI * 2 + f2);

        if (sweep_flag && f1 > f2) {
          f1 = f1 - Math.PI * 2;
        }

        if (!sweep_flag && f2 > f1) {
          f2 = f2 - Math.PI * 2;
        }
      } else {
        f1 = recursive[0];
        f2 = recursive[1];
        cx = recursive[2];
        cy = recursive[3];
      }

      var df = f2 - f1;

      if (Math.abs(df) > _120) {
        var f2old = f2,
            x2old = x2,
            y2old = y2;
        f2 = f1 + _120 * (sweep_flag && f2 > f1 ? 1 : -1);
        x2 = cx + rx * Math.cos(f2);
        y2 = cy + ry * Math.sin(f2);
        res = this.a2c(x2, y2, rx, ry, angle, 0, sweep_flag, x2old, y2old, [f2, f2old, cx, cy]);
      }

      df = f2 - f1;
      var c1 = Math.cos(f1),
          s1 = Math.sin(f1),
          c2 = Math.cos(f2),
          s2 = Math.sin(f2),
          t = Math.tan(df / 4),
          hx = 4 / 3 * rx * t,
          hy = 4 / 3 * ry * t,
          m1 = [x1, y1],
          m2 = [x1 + hx * s1, y1 - hy * c1],
          m3 = [x2 + hx * s2, y2 - hy * c2],
          m4 = [x2, y2];
      m2[0] = 2 * m1[0] - m2[0];
      m2[1] = 2 * m1[1] - m2[1];

      if (recursive) {
        return [m2, m3, m4].concat(res);
      } else {
        res = [m2, m3, m4].concat(res).join().split(",").map(function (x) {
          return parseFloat(x);
        });
        var newres = [];

        for (var i = 0, ii = res.length; i < ii; i++) {
          newres[i] = i % 2 ? rotate(res[i - 1], res[i], rad).y : rotate(res[i], res[i + 1], rad).x;
        }

        return newres;
      }
    }
  }]);

  return PathMaker;
}();

exports.PathMaker = PathMaker;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9wYXRoLnRzIl0sIm5hbWVzIjpbIlBhdGhNYWtlciIsImMiLCJpIiwibyIsInYiLCJ4IiwieSIsInBhdGgiLCJjdXJyZW50WCIsImN1cnJlbnRZIiwicHVzaCIsImxpbmVUbyIsImhvcml6b250YWxUbyIsInZlcnRpY2FsVG8iLCJjMXgiLCJjMXkiLCJjMngiLCJjMnkiLCJjdWJpY0JlemllckN1cnZlVG8iLCJjeCIsImN5IiwicXVhZHJhdGljQmV6aWVyQ3VydmVUbyIsInJ4IiwicnkiLCJ4QXhpc1JvdGF0aW9uIiwibGFyZ2VBcmNGbGFnIiwic3dlZXBGbGFnIiwiY1NlcmllcyIsImEyYyIsImxlbmd0aCIsImlvdkxpc3QiLCJzcGxpY2UiLCJhcmNUbyIsIngxIiwieTEiLCJhbmdsZSIsImxhcmdlX2FyY19mbGFnIiwic3dlZXBfZmxhZyIsIngyIiwieTIiLCJyZWN1cnNpdmUiLCJfMTIwIiwiTWF0aCIsIlBJIiwicmFkIiwicmVzIiwieHkiLCJyb3RhdGUiLCJYIiwiY29zIiwic2luIiwiWSIsImgiLCJzcXJ0IiwicngyIiwicnkyIiwiayIsImFicyIsImYxIiwiYXNpbiIsImYyIiwiZGYiLCJmMm9sZCIsIngyb2xkIiwieTJvbGQiLCJjMSIsInMxIiwiYzIiLCJzMiIsInQiLCJ0YW4iLCJoeCIsImh5IiwibTEiLCJtMiIsIm0zIiwibTQiLCJjb25jYXQiLCJqb2luIiwic3BsaXQiLCJtYXAiLCJwYXJzZUZsb2F0IiwibmV3cmVzIiwiaWkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztJQUVhQSxTOzs7Ozs7a0NBQ2M7QUFDbkJDLE1BQUFBLENBQUMsRUFBRSxLQURnQjtBQUVuQkMsTUFBQUEsQ0FBQyxFQUFFLEVBRmdCO0FBR25CQyxNQUFBQSxDQUFDLEVBQUUsRUFIZ0I7QUFJbkJDLE1BQUFBLENBQUMsRUFBRTtBQUpnQixLOztzQ0FPRyxDOztzQ0FDQSxDOzs7OzsyQkFFWkMsQyxFQUFXQyxDLEVBQVc7QUFDaEMsV0FBS0MsSUFB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QUFTMkMsR0FBRyxDQUFDM0MsQ0FBQyxHQUFHLENBQUwsQ0FBWixFQUFxQjBDLEdBQXJCLENBQU4sQ0FBZ0N2QyxDQUF4RjtBQUNIOztBQUNELGVBQU82RSxNQUFQO0FBQ0g7QUFDSiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhdGhEZWYgfSBmcm9tICcuL2FuaW1hdGlvbidcblxuZXhwb3J0IGNsYXNzIFBhdGhNYWtlciB7XG4gICAgcHVibGljIHBhdGg6IFBhdGhEZWYgPSB7XG4gICAgICAgIGM6IGZhbHNlLFxuICAgICAgICBpOiBbXSxcbiAgICAgICAgbzogW10sXG4gICAgICAgIHY6IFtdXG4gICAgfTtcblxuICAgIHB1YmxpYyBjdXJyZW50WDogbnVtYmVyID0gMDtcbiAgICBwdWJsaWMgY3VycmVudFk6IG51bWJlciA9IDA7XG5cbiAgICBwdWJsaWMgbW92ZVRvKHg6IG51bWJlciwgeTogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMucGF0aC5jID0gZmFsc2VcbiAgICAgICAgdGhpcy5wYXRoLmkgPSBbWzAsIDBdXVxuICAgICAgICB0aGlzLnBhdGgubyA9IFtdXG4gICAgICAgIHRoaXMucGF0aC52ID0gW1t4LCB5XV1cbiAgICAgICAgdGhpcy5jdXJyZW50WCA9IHhcbiAgICAgICAgdGhpcy5jdXJyZW50WSA9IHlcbiAgICB9XG4gICAgcHVibGljIGxpbmVUbyh4OiBudW1iZXIsIHk6IG51bWJlcikge1xuICAgICAgICB0aGlzLnBhdGguaSEucHVzaChbMCwgMF0pXG4gICAgICAgIHRoaXMucGF0aC5vIS5wdXNoKFswLCAwXSlcbiAgICAgICAgdGhpcy5wYXRoLnYhLnB1c2goW3gsIHldKVxuICAgICAgICB0aGlzLmN1cnJlbnRYID0geFxuICAgICAgICB0aGlzLmN1cnJlbnRZID0geVxuICAgIH1cbiAgICBwdWJsaWMgbGluZVRvUmVsYXRpdmUoeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5saW5lVG8odGhpcy5jdXJyZW50WCArIHgsIHRoaXMuY3VycmVudFkgKyB5KVxuICAgIH1cbiAgICBwdWJsaWMgaG9yaXpvbnRhbFRvKHg6IG51bWJlcikge1xuICAgICAgICB0aGlzLmxpbmVUbyh4LCB0aGlzLmN1cnJlbnRZKVxuICAgIH1cbiAgICBwdWJsaWMgaG9yaXpvbnRhbFRvUmVsYXRpdmUoeDogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMuaG9yaXpvbnRhbFRvKHRoaXMuY3VycmVudFggKyB4KVxuICAgIH1cbiAgICBwdWJsaWMgdmVydGljYWxUbyh5OiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5saW5lVG8odGhpcy5jdXJyZW50WCwgeSlcbiAgICB9XG4gICAgcHVibGljIHZlcnRpY2FsVG9SZWxhdGl2ZSh5OiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy52ZXJ0aWNhbFRvKHRoaXMuY3VycmVudFkgKyB5KVxuICAgIH1cbiAgICBwdWJsaWMgY3ViaWNCZXppZXJDdXJ2ZVRvKFxuICAgICAgICBjMXg6IG51bWJlcixcbiAgICAgICAgYzF5OiBudW1iZXIsXG4gICAgICAgIGMyeDogbnVtYmVyLFxuICAgICAgICBjMnk6IG51bWJlcixcbiAgICAgICAgeDogbnVtYmVyLFxuICAgICAgICB5OiBudW1iZXJcbiAgICApIHtcbiAgICAgICAgdGhpcy5wYXRoLmkhLnB1c2goW2MyeCAtIHgsIGMyeSAtIHldKVxuICAgICAgICB0aGlzLnBhdGgubyEucHVzaChbYzF4IC0gdGhpcy5jdXJyZW50WCwgYzF5IC0gdGhpcy5jdXJyZW50WV0pXG4gICAgICAgIHRoaXMucGF0aC52IS5wdXNoKFt4LCB5XSlcbiAgICAgICAgdGhpcy5jdXJyZW50WCA9IHhcbiAgICAgICAgdGhpcy5jdXJyZW50WSA9IHlcbiAgICB9XG4gICAgcHVibGljIGN1YmljQmV6aWVyQ3VydmVUb1JlbGF0aXZlKFxuICAgICAgICBjMXg6IG51bWJlcixcbiAgICAgICAgYzF5OiBudW1iZXIsXG4gICAgICAgIGMyeDogbnVtYmVyLFxuICAgICAgICBjMnk6IG51bWJlcixcbiAgICAgICAgeDogbnVtYmVyLFxuICAgICAgICB5OiBudW1iZXJcbiAgICApIHtcbiAgICAgICAgdGhpcy5jdWJpY0JlemllckN1cnZlVG8odGhpcy5jdXJyZW50WCArIGMxeCwgdGhpcy5jdXJyZW50WSArIGMxeSwgdGhpcy5jdXJyZW50WCArIGMyeCwgdGhpcy5jdXJyZW50WSArIGMyeSwgdGhpcy5jdXJyZW50WCArIHgsIHRoaXMuY3VycmVudFkgKyB5KVxuICAgIH1cbiAgICBwdWJsaWMgcXVhZHJhdGljQmV6aWVyQ3VydmVUbyhjeDogbnVtYmVyLCBjeTogbnVtYmVyLCB4OiBudW1iZXIsIHk6IG51bWJlcikge1xuICAgICAgICB0aGlzLnBhdGguaSEucHVzaChbY3ggLSB4LCBjeSAtIHldKVxuICAgICAgICB0aGlzLnBhdGgubyEucHVzaChbY3ggLSB0aGlzLmN1cnJlbnRYLCBjeSAtIHRoaXMuY3VycmVudFldKVxuICAgICAgICB0aGlzLnBhdGgudiEucHVzaChbeCwgeV0pXG4gICAgICAgIHRoaXMuY3VycmVudFggPSB4XG4gICAgICAgIHRoaXMuY3VycmVudFkgPSB5XG4gICAgfVxuICAgIHB1YmxpYyBxdWFkcmF0aWNCZXppZXJDdXJ2ZVRvUmVsYXRpdmUoY3g6IG51bWJlciwgY3k6IG51bWJlciwgeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5xdWFkcmF0aWNCZXppZXJDdXJ2ZVRvKHRoaXMuY3VycmVudFggKyBjeCwgdGhpcy5jdXJyZW50WSArIGN5LCB0aGlzLmN1cnJlbnRYICsgeCwgdGhpcy5jdXJyZW50WSArIHkpXG4gICAgfVxuICAgIHB1YmxpYyBhcmNUbyhcbiAgICAgICAgcng6IG51bWJlcixcbiAgICAgICAgcnk6IG51bWJlcixcbiAgICAgICAgeEF4aXNSb3RhdGlvbjogbnVtYmVyLFxuICAgICAgICBsYXJnZUFyY0ZsYWc6IG51bWJlcixcbiAgICAgICAgc3dlZXBGbGFnOiBudW1iZXIsXG4gICAgICAgIHg6IG51bWJlcixcbiAgICAgICAgeTogbnVtYmVyXG4gICAgKSB7XG4gICAgICAgIGNvbnN0IGNTZXJpZXMgPSBQYXRoTWFrZXIuYTJjKHRoaXMuY3VycmVudFgsIHRoaXMuY3VycmVudFksIHJ4LCByeSwgeEF4aXNSb3RhdGlvbiwgbGFyZ2VBcmNGbGFnLCBzd2VlcEZsYWcsIHgsIHkpIGFzIG51bWJlcltdXG4gICAgICAgIHdoaWxlIChjU2VyaWVzLmxlbmd0aCA+PSA2KSB7XG4gICAgICAgICAgICBjb25zdCBpb3ZMaXN0ID0gY1Nlcmllcy5zcGxpY2UoMCwgNilcbiAgICAgICAgICAgIHRoaXMucGF0aC5pIS5wdXNoKFtpb3ZMaXN0WzJdIC0gaW92TGlzdFs0XSwgaW92TGlzdFszXSAtIGlvdkxpc3RbNV1dKVxuICAgICAgICAgICAgdGhpcy5wYXRoLm8hLnB1c2goW2lvdkxpc3RbMF0gLSB0aGlzLmN1cnJlbnRYLCBpb3ZMaXN0WzFdIC0gdGhpcy5jdXJyZW50WV0pXG4gICAgICAgICAgICB0aGlzLnBhdGgudiEucHVzaChbaW92TGlzdFs0XSwgaW92TGlzdFs1XV0pXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRYID0gaW92TGlzdFs0XVxuICAgICAgICAgICAgdGhpcy5jdXJyZW50WSA9IGlvdkxpc3RbNV1cbiAgICAgICAgfVxuICAgIH1cbiAgICBwdWJsaWMgYXJjVG9SZWxhdGl2ZShcbiAgICAgICAgcng6IG51bWJlcixcbiAgICAgICAgcnk6IG51bWJlcixcbiAgICAgICAgeEF4aXNSb3RhdGlvbjogbnVtYmVyLFxuICAgICAgICBsYXJnZUFyY0ZsYWc6IG51bWJlcixcbiAgICAgICAgc3dlZXBGbGFnOiBudW1iZXIsXG4gICAgICAgIHg6IG51bWJlcixcbiAgICAgICAgeTogbnVtYmVyXG4gICAgKSB7XG4gICAgICAgIHRoaXMuYXJjVG8ocngsIHJ5LCB4QXhpc1JvdGF0aW9uLCBsYXJnZUFyY0ZsYWcsIHN3ZWVwRmxhZywgdGhpcy5jdXJyZW50WCArIHgsIHRoaXMuY3VycmVudFkgKyB5KVxuICAgIH1cblxuICAgIHByaXZhdGUgc3RhdGljIGEyYyh4MTogbnVtYmVyLCB5MTogbnVtYmVyLCByeDogbnVtYmVyLCByeTogbnVtYmVyLCBhbmdsZTogbnVtYmVyLCBsYXJnZV9hcmNfZmxhZzogbnVtYmVyLCBzd2VlcF9mbGFnOiBudW1iZXIsIHgyOiBudW1iZXIsIHkyOiBudW1iZXIsIHJlY3Vyc2l2ZT86IG51bWJlcltdKTogbnVtYmVyW10gfCBudW1iZXJbXVtdIHtcbiAgICAgICAgLy8gZm9yIG1vcmUgaW5mb3JtYXRpb24gb2Ygd2hlcmUgdGhpcyBNYXRoIGNhbWUgZnJvbSB2aXNpdDpcbiAgICAgICAgLy8gaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvaW1wbG5vdGUuaHRtbCNBcmNJbXBsZW1lbnRhdGlvbk5vdGVzXG4gICAgICAgIHZhciBfMTIwID0gTWF0aC5QSSAqIDEyMCAvIDE4MCxcbiAgICAgICAgICAgIHJhZCA9IE1hdGguUEkgLyAxODAgKiAoK2FuZ2xlIHx8IDApLFxuICAgICAgICAgICAgcmVzOiBudW1iZXJbXSA9IFtdLFxuICAgICAgICAgICAgeHksXG4gICAgICAgICAgICByb3RhdGUgPSAoeDogbnVtYmVyLCB5OiBudW1iZXIsIHJhZDogbnVtYmVyKSA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIFggPSB4ICogTWF0aC5jb3MocmFkKSAtIHkgKiBNYXRoLnNpbihyYWQpLFxuICAgICAgICAgICAgICAgICAgICBZID0geCAqIE1hdGguc2luKHJhZCkgKyB5ICogTWF0aC5jb3MocmFkKTtcbiAgICAgICAgICAgICAgICByZXR1cm4geyB4OiBYLCB5OiBZIH07XG4gICAgICAgICAgICB9O1xuICAgICAgICBpZiAoIXJ4IHx8ICFyeSkge1xuICAgICAgICAgICAgcmV0dXJuIFt4MSwgeTEsIHgyLCB5MiwgeDIsIHkyXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXJlY3Vyc2l2ZSkge1xuICAgICAgICAgICAgeHkgPSByb3RhdGUoeDEsIHkxLCAtcmFkKTtcbiAgICAgICAgICAgIHgxID0geHkueDtcbiAgICAgICAgICAgIHkxID0geHkueTtcbiAgICAgICAgICAgIHh5ID0gcm90YXRlKHgyLCB5MiwgLXJhZCk7XG4gICAgICAgICAgICB4MiA9IHh5Lng7XG4gICAgICAgICAgICB5MiA9IHh5Lnk7XG4gICAgICAgICAgICB2YXIgY29zID0gTWF0aC5jb3MoTWF0aC5QSSAvIDE4MCAqIGFuZ2xlKSxcbiAgICAgICAgICAgICAgICBzaW4gPSBNYXRoLnNpbihNYXRoLlBJIC8gMTgwICogYW5nbGUpLFxuICAgICAgICAgICAgICAgIHggPSAoeDEgLSB4MikgLyAyLFxuICAgICAgICAgICAgICAgIHkgPSAoeTEgLSB5MikgLyAyO1xuICAgICAgICAgICAgdmFyIGggPSB4ICogeCAvIChyeCAqIHJ4KSArIHkgKiB5IC8gKHJ5ICogcnkpO1xuICAgICAgICAgICAgaWYgKGggPiAxKSB7XG4gICAgICAgICAgICAgICAgaCA9IE1hdGguc3FydChoKTtcbiAgICAgICAgICAgICAgICByeCA9IGggKiByeDtcbiAgICAgICAgICAgICAgICByeSA9IGggKiByeTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByeDIgPSByeCAqIHJ4LFxuICAgICAgICAgICAgICAgIHJ5MiA9IHJ5ICogcnksXG4gICAgICAgICAgICAgICAgayA9IChsYXJnZV9hcmNfZmxhZyA9PSBzd2VlcF9mbGFnID8gLTEgOiAxKSAqXG4gICAgICAgICAgICAgICAgICAgIE1hdGguc3FydChNYXRoLmFicygocngyICogcnkyIC0gcngyICogeSAqIHkgLSByeTIgKiB4ICogeCkgLyAocngyICogeSAqIHkgKyByeTIgKiB4ICogeCkpKSxcbiAgICAgICAgICAgICAgICBjeCA9IGsgKiByeCAqIHkgLyByeSArICh4MSArIHgyKSAvIDIsXG4gICAgICAgICAgICAgICAgY3kgPSBrICogLXJ5ICogeCAvIHJ4ICsgKHkxICsgeTIpIC8gMixcbiAgICAgICAgICAgICAgICBmMSA9IE1hdGguYXNpbigoeTEgLSBjeSkgLyByeSksXG4gICAgICAgICAgICAgICAgZjIgPSBNYXRoLmFzaW4oKHkyIC0gY3kpIC8gcnkpO1xuXG4gICAgICAgICAgICBmMSA9IHgxIDwgY3ggPyBNYXRoLlBJIC0gZjEgOiBmMTtcbiAgICAgICAgICAgIGYyID0geDIgPCBjeCA/IE1hdGguUEkgLSBmMiA6IGYyO1xuICAgICAgICAgICAgZjEgPCAwICYmIChmMSA9IE1hdGguUEkgKiAyICsgZjEpO1xuICAgICAgICAgICAgZjIgPCAwICYmIChmMiA9IE1hdGguUEkgKiAyICsgZjIpO1xuICAgICAgICAgICAgaWYgKHN3ZWVwX2ZsYWcgJiYgZjEgPiBmMikge1xuICAgICAgICAgICAgICAgIGYxID0gZjEgLSBNYXRoLlBJICogMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghc3dlZXBfZmxhZyAmJiBmMiA+IGYxKSB7XG4gICAgICAgICAgICAgICAgZjIgPSBmMiAtIE1hdGguUEkgKiAyO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZjEgPSByZWN1cnNpdmVbMF07XG4gICAgICAgICAgICBmMiA9IHJlY3Vyc2l2ZVsxXTtcbiAgICAgICAgICAgIGN4ID0gcmVjdXJzaXZlWzJdO1xuICAgICAgICAgICAgY3kgPSByZWN1cnNpdmVbM107XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRmID0gZjIgLSBmMTtcbiAgICAgICAgaWYgKE1hdGguYWJzKGRmKSA+IF8xMjApIHtcbiAgICAgICAgICAgIHZhciBmMm9sZCA9IGYyLFxuICAgICAgICAgICAgICAgIHgyb2xkID0geDIsXG4gICAgICAgICAgICAgICAgeTJvbGQgPSB5MjtcbiAgICAgICAgICAgIGYyID0gZjEgKyBfMTIwICogKHN3ZWVwX2ZsYWcgJiYgZjIgPiBmMSA/IDEgOiAtMSk7XG4gICAgICAgICAgICB4MiA9IGN4ICsgcnggKiBNYXRoLmNvcyhmMik7XG4gICAgICAgICAgICB5MiA9IGN5ICsgcnkgKiBNYXRoLnNpbihmMik7XG4gICAgICAgICAgICByZXMgPSB0aGlzLmEyYyh4MiwgeTIsIHJ4LCByeSwgYW5nbGUsIDAsIHN3ZWVwX2ZsYWcsIHgyb2xkLCB5Mm9sZCwgW2YyLCBmMm9sZCwgY3gsIGN5XSkgYXMgbnVtYmVyW107XG4gICAgICAgIH1cbiAgICAgICAgZGYgPSBmMiAtIGYxO1xuICAgICAgICB2YXIgYzEgPSBNYXRoLmNvcyhmMSksXG4gICAgICAgICAgICBzMSA9IE1hdGguc2luKGYxKSxcbiAgICAgICAgICAgIGMyID0gTWF0aC5jb3MoZjIpLFxuICAgICAgICAgICAgczIgPSBNYXRoLnNpbihmMiksXG4gICAgICAgICAgICB0ID0gTWF0aC50YW4oZGYgLyA0KSxcbiAgICAgICAgICAgIGh4ID0gNCAvIDMgKiByeCAqIHQsXG4gICAgICAgICAgICBoeSA9IDQgLyAzICogcnkgKiB0LFxuICAgICAgICAgICAgbTEgPSBbeDEsIHkxXSxcbiAgICAgICAgICAgIG0yID0gW3gxICsgaHggKiBzMSwgeTEgLSBoeSAqIGMxXSxcbiAgICAgICAgICAgIG0zID0gW3gyICsgaHggKiBzMiwgeTIgLSBoeSAqIGMyXSxcbiAgICAgICAgICAgIG00ID0gW3gyLCB5Ml07XG4gICAgICAgIG0yWzBdID0gMiAqIG0xWzBdIC0gbTJbMF07XG4gICAgICAgIG0yWzFdID0gMiAqIG0xWzFdIC0gbTJbMV07XG4gICAgICAgIGlmIChyZWN1cnNpdmUpIHtcbiAgICAgICAgICAgIHJldHVybiBbbTIsIG0zLCBtNF0uY29uY2F0KHJlcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXMgPSBbbTIsIG0zLCBtNF0uY29uY2F0KHJlcykuam9pbigpLnNwbGl0KFwiLFwiKS5tYXAoeCA9PiBwYXJzZUZsb2F0KHgpKTtcbiAgICAgICAgICAgIHZhciBuZXdyZXMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHJlcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbmV3cmVzW2ldID0gaSAlIDIgPyByb3RhdGUocmVzW2kgLSAxXSwgcmVzW2ldLCByYWQpLnkgOiByb3RhdGUocmVzW2ldLCByZXNbaSArIDFdLCByYWQpLng7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3cmVzO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGNsb3NlUGF0aCgpIHtcbiAgICAgICAgdGhpcy5wYXRoLmMgPSB0cnVlXG4gICAgfVxuXG4gICAgcHVibGljIHVuaWZvcm0oKSB7XG4gICAgICAgIHdoaWxlICh0aGlzLnBhdGgubyEubGVuZ3RoIDwgdGhpcy5wYXRoLmkhLmxlbmd0aClcbiAgICAgICAgICAgIHRoaXMucGF0aC5vIS5wdXNoKFswLCAwXSlcbiAgICB9XG59Il19
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.render = render;
exports.renderText = renderText;
exports.renderImage = renderImage;

var _path = require("./path");

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance"); }

function _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

var parseSVG = require('svg-path-parser');

function render(dom) {
  if (dom instanceof SVGTextElement || dom instanceof SVGImageElement) {
    return {};
  } else if (dom instanceof SVGGElement) {
    return renderGroup(dom);
  } else {
    return renderGlyph(dom);
  }
}

function encodeLineCap(type) {
  switch (type) {
    case 'square':
      return 3;

    case 'butt':
      return 1;

    default:
      return 2;
  }
}

function encodeLineJoin(type) {
  switch (type) {
    case 'miter':
      return 1;

    case 'bevel':
      return 3;

    default:
      return 2;
  }
}

function addVisualEncodings(items, styles) {
  if (styles.stroke && styles.stroke !== 'none') {
    items.push({
      ty: 'st',
      c: {
        k: styles.stroke.split('(')[1].split(')')[0].split(',').slice(0, 3).map(function (raw) {
          return parseInt(raw) / 255;
        }).concat(1)
      },
      o: {
        k: parseFloat(styles.strokeOpacity || '1') * 100
      },
      w: {
        k: parseFloat(styles.strokeWidth || '1')
      },
      lc: encodeLineCap(styles.strokeLinecap),
      lj: encodeLineJoin(styles.strokeLinejoin)
    });
  }

  if (styles.fill && styles.fill !== 'none') {
    items.push({
      ty: 'fl',
      c: {
        k: styles.fill.split('(')[1].split(')')[0].split(',').slice(0, 3).map(function (raw) {
          return parseInt(raw) / 255;
        }).concat(1)
      },
      o: {
        k: parseFloat(styles.fillOpacity || '1') * 100
      }
    });
  }

  items.push({
    ty: "tr",
    p: {
      k: [0, 0]
    },
    a: {
      k: [0, 0]
    },
    s: {
      k: [100, 100]
    },
    r: {
      k: 0
    },
    o: {
      k: 100
    },
    sk: {
      k: 0
    },
    sa: {
      k: 0
    }
  });
}

function renderGlyph(dom) {
  var group = {
    ty: "gr",
    it: [],
    bm: 0,
    hd: false
  };

  var postActions = function postActions(pathMaker) {
    pathMaker.uniform();
    group.it.push({
      ty: 'sh',
      ks: {
        k: pathMaker.path,
        a: 0
      },
      nm: dom.id,
      hd: false
    });
    var styles = window.getComputedStyle(dom);
    addVisualEncodings(group.it, styles);
  };

  if (dom instanceof SVGCircleElement) {
    var svgLength = dom.r.baseVal;
    svgLength.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
    var r = svgLength.valueInSpecifiedUnits;
    var pathMaker = new _path.PathMaker();
    pathMaker.moveTo(r, 0);
    pathMaker.arcTo(r, r, 0, 1, 0, r, 2 * r);
    pathMaker.arcTo(r, r, 0, 1, 0, r, 0);
    pathMaker.closePath();
    postActions(pathMaker);
  } else if (dom instanceof SVGEllipseElement) {
    var mapKey = ['rx', 'ry'];

    var _mapKey$map = mapKey.map(function (key) {
      var svgLength = dom[key].baseVal;
      svgLength.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
      return svgLength.valueInSpecifiedUnits;
    }),
        _mapKey$map2 = _slicedToArray(_mapKey$map, 2),
        rx = _mapKey$map2[0],
        ry = _mapKey$map2[1];

    var _pathMaker = new _path.PathMaker();

    _pathMaker.moveTo(rx, 0);

    _pathMaker.arcTo(rx, ry, 0, 1, 0, rx, 2 * ry);

    _pathMaker.arcTo(rx, ry, 0, 1, 0, rx, 0);

    _pathMaker.closePath();

    postActions(_pathMaker);
  } else if (dom instanceof SVGLineElement) {
    var _mapKey = ['x1', 'x2', 'y1', 'y2'];

    var _mapKey$map3 = _mapKey.map(function (key) {
      var svgLength = dom[key].baseVal;
      svgLength.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
      return svgLength.valueInSpecifiedUnits;
    }),
        _mapKey$map4 = _slicedToArray(_mapKey$map3, 4),
        x1 = _mapKey$map4[0],
        x2 = _mapKey$map4[1],
        y1 = _mapKey$map4[2],
        y2 = _mapKey$map4[3];

    var offsetX = Math.min(x1, x2);
    var offsetY = Math.min(y1, y2);

    var _pathMaker2 = new _path.PathMaker();

    _pathMaker2.moveTo(x1 - offsetX, y1 - offsetY);

    _pathMaker2.lineTo(x2 - offsetX, y2 - offsetY);

    postActions(_pathMaker2);
  } else if (dom instanceof SVGPathElement) {
    var pathData = dom.getAttribute('d');
    var pathDataSeries = parseSVG(pathData);

    var _pathMaker3 = new _path.PathMaker();

    pathDataSeries.forEach(function (pathDataItem) {
      switch (pathDataItem.code) {
        case 'M':
          _pathMaker3.moveTo(pathDataItem.x, pathDataItem.y);

          break;

        case 'L':
          _pathMaker3.lineTo(pathDataItem.x, pathDataItem.y);

          break;

        case 'l':
          _pathMaker3.lineToRelative(pathDataItem.x, pathDataItem.y);

          break;

        case 'H':
          _pathMaker3.horizontalTo(pathDataItem.x);

          break;

        case 'h':
          _pathMaker3.horizontalToRelative(pathDataItem.x);

          break;

        case 'V':
          _pathMaker3.verticalTo(pathDataItem.y);

          break;

        case 'v':
          _pathMaker3.verticalToRelative(pathDataItem.y);

          break;

        case 'C':
          _pathMaker3.cubicBezierCurveTo(pathDataItem.x1, pathDataItem.y1, pathDataItem.x2, pathDataItem.y2, pathDataItem.x, pathDataItem.y);

          break;

        case 'c':
          _pathMaker3.cubicBezierCurveToRelative(pathDataItem.x1, pathDataItem.y1, pathDataItem.x2, pathDataItem.y2, pathDataItem.x, pathDataItem.y);

          break;

        case 'Q':
          _pathMaker3.quadraticBezierCurveTo(pathDataItem.x1, pathDataItem.y1, pathDataItem.x, pathDataItem.y);

          break;

        case 'q':
          _pathMaker3.quadraticBezierCurveToRelative(pathDataItem.x1, pathDataItem.y1, pathDataItem.x, pathDataItem.y);

          break;

        case 'A':
          _pathMaker3.arcTo(pathDataItem.rx, pathDataItem.ry, pathDataItem.xAsisRotation, ~~pathDataItem.largeArc, ~~pathDataItem.sweep, pathDataItem.x, pathDataItem.y);

          break;

        case 'a':
          _pathMaker3.arcToRelative(pathDataItem.rx, pathDataItem.ry, pathDataItem.xAsisRotation, ~~pathDataItem.largeArc, ~~pathDataItem.sweep, pathDataItem.x, pathDataItem.y);

          break;

        case 'Z':
        case 'z':
          _pathMaker3.closePath();

          break;

        default:
          console.error(pathDataItem);
          throw new Error('No implementation found for this path command.');
      }
    });
    postActions(_pathMaker3);
  } else if (dom instanceof SVGPolygonElement || dom instanceof SVGPolylineElement) {
    var points = dom.points;

    if (points.length) {
      var iterablePoints = Array.prototype.slice.call(points);

      var _offsetX = iterablePoints.reduce(function (p, v) {
        return Math.min(p, v.x);
      }, 0);

      var _offsetY = iterablePoints.reduce(function (p, v) {
        return Math.min(p, v.y);
      }, 0);

      var _pathMaker4 = new _path.PathMaker();

      _pathMaker4.moveTo(points[0].x - _offsetX, points[0].y - _offsetY);

      iterablePoints.forEach(function (v, i) {
        if (i <= 0) return;

        _pathMaker4.lineTo(v.x - _offsetX, v.y - _offsetY);
      });

      if (dom instanceof SVGPolygonElement) {
        _pathMaker4.closePath();
      }

      postActions(_pathMaker4);
    }
  } else if (dom instanceof SVGRectElement) {
    var _mapKey2 = ['width', 'height'];

    var _mapKey2$map = _mapKey2.map(function (key) {
      var svgLength = dom[key].baseVal;
      svgLength.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
      return svgLength.valueInSpecifiedUnits;
    }),
        _mapKey2$map2 = _slicedToArray(_mapKey2$map, 2),
        width = _mapKey2$map2[0],
        height = _mapKey2$map2[1];

    var _pathMaker5 = new _path.PathMaker();

    _pathMaker5.moveTo(0, 0);

    _pathMaker5.lineTo(width, 0);

    _pathMaker5.lineTo(width, height);

    _pathMaker5.lineTo(0, height);

    _pathMaker5.closePath();

    postActions(_pathMaker5);
  } else {
    console.error(dom);
    throw new Error('No implementation found for svg graphics element.');
  }

  return group;
}

function renderGroup(dom) {
  var group = {
    ty: 'gr',
    it: [],
    nm: dom.id,
    bm: 0,
    hd: false
  };
  dom.childNodes.forEach(function (node) {
    if (node instanceof SVGGraphicsElement) {
      var child = render(node);

      if (child.ty) {
        group.it.push(child);
      }
    }
  });
  return group;
}

function renderText(dom) {
  return {};
}

function renderImage(dom) {
  return "";
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9yZW5kZXIudHMiXSwibmFtZXMiOlsicGFyc2VTVkciLCJyZXF1aXJlIiwicmVuZGVyIiwiZG9tIiwiU1ZHVGV4dEVsZW1lbnQiLCJTVkdJbWFnZUVsZW1lbnQiLCJTVkdHRWxlbWVudCIsInJlbmRlckdyb3VwIiwicmVuZGVyR2x5cGgiLCJlbmNvZGVMaW5lQ2FwIiwidHlwZSIsImVuY29kZUxpbmVKb2luIiwiYWRkVmlzdWFsRW5jb2RpbmdzIiwiaXRlbXMiLCJzdHlsZXMiLCJzdHJva2UiLCJwdXNoIiwidHkiLCJjIiwiayIsInNwbGl0Iiwic2xpY2UiLCJtYXAiLCJyYXciLCJwYXJzZUludCIsImNvbmNhdCIsIm8iLCJwYXJzZUZsb2F0Iiwic3Ryb2tlT3BhY2l0eSIsInciLCJzdHJva2VXaWR0aCIsImxjIiwic3Ryb2tlTGluZWNhcCIsImxqIiwic3Ryb2tlTGluZWpvaW4iLCJmaWxsIiwiZmlsbE9wYWNpdHkiLCJwIiwiYSIsInMiLCJyIiwic2siLCJzYSIsImdyb3VwIiwiaXQiLCJibSIsImhkIiwicG9zdEFjdGlvbnMiLCJwYXRoTWFrZXIiLCJ1bmlmb3JtIiwia3MiLCJwYXRoIiwibm0iLCJpZCIsIndpbmRvdyIsImdldENvbXB1dGVkU3R5bGUiLCJTVkdDaXJjbGVFbGVtZW50Iiwic3ZnTGVuZ3RoIiwiYmFzZVZhbCIsImNvbnZlcnRUb1NwZWNpZmllZFVuaXRzIiwiU1ZHTGVuZ3RoIiwiU1ZHX0xFTkdUSFRZUEVfUFgiLCJ2YWx1ZUluU3BlY2lmaWVkVW5pdHMiLCJQYXRoTWFrZXIiLCJtb3ZlVG8iLCJhcmNUbyIsImNsb3NlUGF0aCIsIlNWR0VsbGlwc2VFbGVtZW50IiwibWFwS2V5Iiwia2V5IiwicngiLCJyeSIsIlNWR0xpbmVFbGVtZW50IiwieDEiLCJ4MiIsInkxIiwieTIiLCJvZmZzZXRYIiwiTWF0aCIsIm1pbiIsIm9mZnNldFkiLCJsaW5lVG8iLCJTVkdQYXRoRWxlbWVudCIsInBhdGhEYXRhIiwiZ2V0QXR0cmlidXRlIiwicGF0aERhdGFTZXJpZXMiLCJmb3JFYWNoIiwicGF0aERhdGFJdGVtIiwiY29kZSIsIngiLCJ5IiwibGluZVRvUmVsYXRpdmUiLCJob3Jpem9udGFsVG8iLCJob3Jpem9udGFsVG9SZWxhdGl2ZSIsInZlcnRpY2FsVG8iLCJ2ZXJ0aWNhbFRvUmVsYXRpdmUiLCJjdWJpY0JlemllckN1cnZlVG8iLCJjdWJpY0JlemllckN1cnZlVG9SZWxhdGl2ZSIsInF1YWRyYXRpY0JlemllckN1cnZlVG8iLCJxdWFkcmF0aWNCZXppZXJDdXJ2ZVRvUmVsYXRpdmUiLCJ4QXNpc1JvdGF0aW9uIiwibGFyZ2VBcmMiLCJzd2VlcCIsImFyY1RvUmVsYXRpdmUiLCJjb25zb2xlIiwiZXJyb3IiLCJFcnJvciIsIlNWR1BvbHlnb25FbGVtZW50IiwiU1ZHUG9seWxpbmVFbGVtZW50IiwicG9pbnRzIiwibGVuZ3RoIiwiaXRlcmFibGVQb2ludHMiLCJBcnJheSIsInByb3RvdHlwZSIsImNhbGwiLCJyZWR1Y2UiLCJ2IiwiaSIsIlNWR1JlY3RFbGVtZW50Iiwid2lkdGgiLCJoZWlnaHQiLCJjaGlsZE5vZGVzIiwibm9kZSIsIlNWR0dyYXBoaWNzRWxlbWVudCIsImNoaWxkIiwicmVuZGVyVGV4dCIsInJlbmRlckltYWdlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFDQTs7Ozs7Ozs7OztBQUVBLElBQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLGlCQUFELENBQXhCOztBQWlDTyxTQUFTQyxNQUFULENBQWdCQyxHQUFoQixFQUFxRDtBQUN4RCxNQUFJQSxHQUFHLFlBQVlDLGNBQWYsSUFBaUNELEdBQUcsWUFBWUUsZUFBcEQsRUFBcUU7QUFDakUsV0FBTyxFQUFQO0FBQ0gsR0FGRCxNQUVPLElBQUlGLEdBQUcsWUFBWUcsV0FBbkIsRUFBZ0M7QUFDbkMsV0FBT0MsV0FBVyxDQUFDSixHQUFELENBQWxCO0FBQ0gsR0FGTSxNQUVBO0FBQ0gsV0FBT0ssV0FBVyxDQUFDTCxHQUFELENBQWxCO0FBQ0g7QUFDSjs7QUFFRCxTQUFT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LENBQUNDLEtBQVIsQ0FBY3RHLEdBQWQ7QUFDQSxVQUFNLElBQUl1RyxLQUFKLENBQVUsbURBQVYsQ0FBTjtBQUNIOztBQUNELFNBQU8vRCxLQUFQO0FBQ0g7O0FBRUQsU0FBU3BDLFdBQVQsQ0FBcUJKLEdBQXJCLEVBQW1EO0FBQy9DLE1BQUl3QyxLQUFpQixHQUFHO0FBQ3BCMUIsSUFBQUEsRUFBRSxFQUFFLElBRGdCO0FBRXBCMkIsSUFBQUEsRUFBRSxFQUFFLEVBRmdCO0FBR3BCUSxJQUFBQSxFQUFFLEVBQUVqRCxHQUFHLENBQUNrRCxFQUhZO0FBSXBCUixJQUFBQSxFQUFFLEVBQUUsQ0FKZ0I7QUFLcEJDLElBQUFBLEVBQUUsRUFBRTtBQUxnQixHQUF4QjtBQU9BM0MsRUFBQUEsR0FBRyxDQUFDc0gsVUFBSixDQUFlbkMsT0FBZixDQUF1QixVQUFBb0MsSUFBSSxFQUFJO0FBQzNCLFFBQUlBLElBQUksWUFBWUMsa0JBQXBCLEVBQXdDO0FBQ3BDLFVBQUlDLEtBQUssR0FBRzFILE1BQU0sQ0FBQ3dILElBQUQsQ0FBbEI7O0FBQ0EsVUFBSUUsS0FBSyxDQUFDM0csRUFBVixFQUFjO0FBQ1YwQixRQUFBQSxLQUFLLENBQUNDLEVBQU4sQ0FBVTVCLElBQVYsQ0FBZTRHLEtBQWY7QUFDSDtBQUNKO0FBQ0osR0FQRDtBQVFBLFNBQU9qRixLQUFQO0FBQ0g7O0FBRU0sU0FBU2tGLFVBQVQsQ0FBb0IxSCxHQUFwQixFQUFtRDtBQUN0RCxTQUFPLEVBQVA7QUFDSDs7QUFFTSxTQUFTMkgsV0FBVCxDQUFxQjNILEdBQXJCLEVBQXdEO0FBQzNELFNBQU8sRUFBUDtBQUNIIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgR3JvdXBTaGFwZSwgVGV4dERhdGEsIFJlZmVyZW5jZUlELCBQYXRoU2hhcGUsIEZpbGxTaGFwZSwgU3Ryb2tlU2hhcGUsIFRyYW5zZm9ybVNoYXBlIH0gZnJvbSAnLi9hbmltYXRpb24nXG5pbXBvcnQgeyBQYXRoTWFrZXIgfSBmcm9tICcuL3BhdGgnXG5cbmNvbnN0IHBhcnNlU1ZHID0gcmVxdWlyZSgnc3ZnLXBhdGgtcGFyc2VyJylcbnR5cGUgUGF0aFBhcnNlclJlc3VsdCA9IHtcbiAgICBjb2RlOiAnTScgfCAnTCcgfCAnSCcgfCAnVicgfCAnbScgfCAnbCcgfCAnaCcgfCAndicsXG4gICAgY29tbWFuZDogc3RyaW5nLFxuICAgIHg6IG51bWJlcixcbiAgICB5OiBudW1iZXIsXG4gICAgcmVsYXRpdmU6IGJvb2xlYW5cbn0gfCB7XG4gICAgY29kZTogJ0MnIHwgJ2MnIHwgJ1MnIHwgJ3MnIHwgJ1EnIHwgJ3EnIHwgJ1QnIHwgJ3QnLFxuICAgIGNvbW1hbmQ6IHN0cmluZyxcbiAgICB4OiBudW1iZXIsXG4gICAgeTogbnVtYmVyLFxuICAgIHJlbGF0aXZlOiBib29sZWFuLFxuICAgIHgxOiBudW1iZXIsXG4gICAgeDI6IG51bWJlcixcbiAgICB5MTogbnVtYmVyLFxuICAgIHkyOiBudW1iZXJcbn0gfCB7XG4gICAgY29kZTogJ0EnIHwgJ2EnLFxuICAgIGNvbW1hbmQ6IHN0cmluZyxcbiAgICB4OiBudW1iZXIsXG4gICAgeTogbnVtYmVyLFxuICAgIHJlbGF0aXZlOiBib29sZWFuLFxuICAgIHJ4OiBudW1iZXIsXG4gICAgcnk6IG51bWJlcixcbiAgICB4QXNpc1JvdGF0aW9uOiBudW1iZXIsXG4gICAgbGFyZ2VBcmM6IGJvb2xlYW4sXG4gICAgc3dlZXA6IGJvb2xlYW5cbn0gfCB7XG4gICAgY29kZTogJ1onIHwgJ3onLFxuICAgIGNvbW1hbmQ6IHN0cmluZ1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyKGRvbTogU1ZHR3JhcGhpY3NFbGVtZW50KTogR3JvdXBTaGFwZSB7XG4gICAgaWYgKGRvbSBpbnN0YW5jZW9mIFNWR1RleHRFbGVtZW50IHx8IGRvbSBpbnN0YW5jZW9mIFNWR0ltYWdlRWxlbWVudCkge1xuICAgICAgICByZXR1cm4ge31cbiAgICB9IGVsc2UgaWYgKGRvbSBpbnN0YW5jZW9mIFNWR0dFbGVtZW50KSB7XG4gICAgICAgIHJldHVybiByZW5kZXJHcm91cChkb20pXG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHJlbmRlckdseXBoKGRvbSlcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGVuY29kZUxpbmVDYXAodHlwZT86IHN0cmluZyB8IG51bGwpOiBudW1iZXIge1xuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICBjYXNlICdzcXVhcmUnOlxuICAgICAgICAgICAgcmV0dXJuIDNcbiAgICAgICAgY2FzZSAnYnV0dCc6XG4gICAgICAgICAgICByZXR1cm4gMVxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIDJcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGVuY29kZUxpbmVKb2luKHR5cGU/OiBzdHJpbmcgfCBudWxsKTogbnVtYmVyIHtcbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgY2FzZSAnbWl0ZXInOlxuICAgICAgICAgICAgcmV0dXJuIDFcbiAgICAgICAgY2FzZSAnYmV2ZWwnOlxuICAgICAgICAgICAgcmV0dXJuIDNcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiAyXG4gICAgfVxufVxuXG50eXBlIFZpc3VhbEdyb3VwSXRlbSA9IFBhdGhTaGFwZSB8IEZpbGxTaGFwZSB8IFN0cm9rZVNoYXBlIHwgVHJhbnNmb3JtU2hhcGVcblxuZnVuY3Rpb24gYWRkVmlzdWFsRW5jb2RpbmdzKGl0ZW1zOiBWaXN1YWxHcm91cEl0ZW1bXSwgc3R5bGVzOiBDU1NTdHlsZURlY2xhcmF0aW9uKSB7XG4gICAgaWYgKHN0eWxlcy5zdHJva2UgJiYgc3R5bGVzLnN0cm9rZSAhPT0gJ25vbmUnKSB7XG4gICAgICAgIGl0ZW1zLnB1c2goe1xuICAgICAgICAgICAgdHk6ICdzdCcsXG4gICAgICAgICAgICBjOiB7XG4gICAgICAgICAgICAgICAgazogc3R5bGVzLnN0cm9rZSEuc3BsaXQoJygnKVsxXS5zcGxpdCgnKScpWzBdLnNwbGl0KCcsJykuc2xpY2UoMCwgMykubWFwKChyYXc6IHN0cmluZykgPT4gcGFyc2VJbnQocmF3KSAvIDI1NSkuY29uY2F0KDEpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbzoge1xuICAgICAgICAgICAgICAgIGs6IHBhcnNlRmxvYXQoc3R5bGVzLnN0cm9rZU9wYWNpdHkgfHwgJzEnKSAqIDEwMFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHc6IHtcbiAgICAgICAgICAgICAgICBrOiBwYXJzZUZsb2F0KHN0eWxlcy5zdHJva2VXaWR0aCB8fCAnMScpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGM6IGVuY29kZUxpbmVDYXAoc3R5bGVzLnN0cm9rZUxpbmVjYXApLFxuICAgICAgICAgICAgbGo6IGVuY29kZUxpbmVKb2luKHN0eWxlcy5zdHJva2VMaW5lam9pbilcbiAgICAgICAgfSlcbiAgICB9XG4gICAgaWYgKHN0eWxlcy5maWxsICYmIHN0eWxlcy5maWxsICE9PSAnbm9uZScpIHtcbiAgICAgICAgaXRlbXMucHVzaCh7XG4gICAgICAgICAgICB0eTogJ2ZsJyxcbiAgICAgICAgICAgIGM6IHtcbiAgICAgICAgICAgICAgICBrOiBzdHlsZXMuZmlsbCEuc3BsaXQoJygnKVsxXS5zcGxpdCgnKScpWzBdLnNwbGl0KCcsJykuc2xpY2UoMCwgMykubWFwKChyYXc6IHN0cmluZykgPT4gcGFyc2VJbnQocmF3KSAvIDI1NSkuY29uY2F0KDEpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbzoge1xuICAgICAgICAgICAgICAgIGs6IHBhcnNlRmxvYXQoc3R5bGVzLmZpbGxPcGFjaXR5IHx8ICcxJykgKiAxMDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG4gICAgaXRlbXMucHVzaCh7XG4gICAgICAgIHR5OiBcInRyXCIsXG4gICAgICAgIHA6IHtcbiAgICAgICAgICAgIGs6IFtcbiAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgIDBcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSxcbiAgICAgICAgYToge1xuICAgICAgICAgICAgazogW1xuICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgMFxuICAgICAgICAgICAgXVxuICAgICAgICB9LFxuICAgICAgICBzOiB7XG4gICAgICAgICAgICBrOiBbXG4gICAgICAgICAgICAgICAgMTAwLFxuICAgICAgICAgICAgICAgIDEwMFxuICAgICAgICAgICAgXVxuICAgICAgICB9LFxuICAgICAgICByOiB7XG4gICAgICAgICAgICBrOiAwXG4gICAgICAgIH0sXG4gICAgICAgIG86IHtcbiAgICAgICAgICAgIGs6IDEwMFxuICAgICAgICB9LFxuICAgICAgICBzazoge1xuICAgICAgICAgICAgazogMFxuICAgICAgICB9LFxuICAgICAgICBzYToge1xuICAgICAgICAgICAgazogMFxuICAgICAgICB9XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gcmVuZGVyR2x5cGgoZG9tOiBTVkdHcmFwaGljc0VsZW1lbnQpOiBHcm91cFNoYXBlIHtcbiAgICBjb25zdCBncm91cDogR3JvdXBTaGFwZSA9IHtcbiAgICAgICAgdHk6IFwiZ3JcIixcbiAgICAgICAgaXQ6IFtdLFxuICAgICAgICBibTogMCxcbiAgICAgICAgaGQ6IGZhbHNlXG4gICAgfVxuICAgIGNvbnN0IHBvc3RBY3Rpb25zID0gKHBhdGhNYWtlcjogUGF0aE1ha2VyKSA9PiB7XG4gICAgICAgIHBhdGhNYWtlci51bmlmb3JtKClcbiAgICAgICAgZ3JvdXAuaXQhLnB1c2goe1xuICAgICAgICAgICAgdHk6ICdzaCcsXG4gICAgICAgICAgICBrczoge1xuICAgICAgICAgICAgICAgIGs6IHBhdGhNYWtlci5wYXRoLFxuICAgICAgICAgICAgICAgIGE6IDBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBubTogZG9tLmlkLFxuICAgICAgICAgICAgaGQ6IGZhbHNlXG4gICAgICAgIH0pXG4gICAgICAgIGNvbnN0IHN0eWxlcyA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGRvbSlcbiAgICAgICAgYWRkVmlzdWFsRW5jb2RpbmdzKGdyb3VwLml0ISBhcyBWaXN1YWxHcm91cEl0ZW1bXSwgc3R5bGVzKVxuICAgIH1cbiAgICBpZiAoZG9tIGluc3RhbmNlb2YgU1ZHQ2lyY2xlRWxlbWVudCkge1xuICAgICAgICBjb25zdCBzdmdMZW5ndGggPSBkb20uci5iYXNlVmFsXG4gICAgICAgIHN2Z0xlbmd0aC5jb252ZXJ0VG9TcGVjaWZpZWRVbml0cyhTVkdMZW5ndGguU1ZHX0xFTkdUSFRZUEVfUFgpXG4gICAgICAgIGNvbnN0IHIgPSBzdmdMZW5ndGgudmFsdWVJblNwZWNpZmllZFVuaXRzXG4gICAgICAgIGNvbnN0IHBhdGhNYWtlciA9IG5ldyBQYXRoTWFrZXIoKVxuICAgICAgICBwYXRoTWFrZXIubW92ZVRvKHIsIDApXG4gICAgICAgIHBhdGhNYWtlci5hcmNUbyhyLCByLCAwLCAxLCAwLCByLCAyICogcilcbiAgICAgICAgcGF0aE1ha2VyLmFyY1RvKHIsIHIsIDAsIDEsIDAsIHIsIDApXG4gICAgICAgIHBhdGhNYWtlci5jbG9zZVBhdGgoKVxuICAgICAgICBwb3N0QWN0aW9ucyhwYXRoTWFrZXIpXG4gICAgfSBlbHNlIGlmIChkb20gaW5zdGFuY2VvZiBTVkdFbGxpcHNlRWxlbWVudCkge1xuICAgICAgICBjb25zdCBtYXBLZXk6ICgncngnIHwgJ3J5JylbXSA9IFsncngnLCAncnknXVxuICAgICAgICBjb25zdCBbcngsIHJ5XSA9IG1hcEtleS5tYXAoa2V5ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN2Z0xlbmd0aCA9IGRvbVtrZXldLmJhc2VWYWxcbiAgICAgICAgICAgIHN2Z0xlbmd0aC5jb252ZXJ0VG9TcGVjaWZpZWRVbml0cyhTVkdMZW5ndGguU1ZHX0xFTkdUSFRZUEVfUFgpXG4gICAgICAgICAgICByZXR1cm4gc3ZnTGVuZ3RoLnZhbHVlSW5TcGVjaWZpZWRVbml0c1xuICAgICAgICB9KVxuICAgICAgICBjb25zdCBwYXRoTWFrZXIgPSBuZXcgUGF0aE1ha2VyKClcbiAgICAgICAgcGF0aE1ha2VyLm1vdmVUbyhyeCwgMClcbiAgICAgICAgcGF0aE1ha2VyLmFyY1RvKHJ4LCByeSwgMCwgMSwgMCwgcngsIDIgKiByeSlcbiAgICAgICAgcGF0aE1ha2VyLmFyY1RvKHJ4LCByeSwgMCwgMSwgMCwgcngsIDApXG4gICAgICAgIHBhdGhNYWtlci5jbG9zZVBhdGgoKVxuICAgICAgICBwb3N0QWN0aW9ucyhwYXRoTWFrZXIpXG4gICAgfSBlbHNlIGlmIChkb20gaW5zdGFuY2VvZiBTVkdMaW5lRWxlbWVudCkge1xuICAgICAgICBjb25zdCBtYXBLZXk6ICgneDEnIHwgJ3gyJyB8ICd5MScgfCAneTInKVtdID0gWyd4MScsICd4MicsICd5MScsICd5MiddXG4gICAgICAgIGNvbnN0IFt4MSwgeDIsIHkxLCB5Ml0gPSBtYXBLZXkubWFwKGtleSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzdmdMZW5ndGggPSBkb21ba2V5XS5iYXNlVmFsXG4gICAgICAgICAgICBzdmdMZW5ndGguY29udmVydFRvU3BlY2lmaWVkVW5pdHMoU1ZHTGVuZ3RoLlNWR19MRU5HVEhUWVBFX1BYKVxuICAgICAgICAgICAgcmV0dXJuIHN2Z0xlbmd0aC52YWx1ZUluU3BlY2lmaWVkVW5pdHNcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3Qgb2Zmc2V0WCA9IE1hdGgubWluKHgxLCB4MilcbiAgICAgICAgY29uc3Qgb2Zmc2V0WSA9IE1hdGgubWluKHkxLCB5MilcbiAgICAgICAgY29uc3QgcGF0aE1ha2VyID0gbmV3IFBhdGhNYWtlcigpXG4gICAgICAgIHBhdGhNYWtlci5tb3ZlVG8oeDEgLSBvZmZzZXRYLCB5MSAtIG9mZnNldFkpXG4gICAgICAgIHBhdGhNYWtlci5saW5lVG8oeDIgLSBvZmZzZXRYLCB5MiAtIG9mZnNldFkpXG4gICAgICAgIHBvc3RBY3Rpb25zKHBhdGhNYWtlcilcbiAgICB9IGVsc2UgaWYgKGRvbSBpbnN0YW5jZW9mIFNWR1BhdGhFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IHBhdGhEYXRhID0gZG9tLmdldEF0dHJpYnV0ZSgnZCcpXG4gICAgICAgIGNvbnN0IHBhdGhEYXRhU2VyaWVzOiBQYXRoUGFyc2VyUmVzdWx0W10gPSBwYXJzZVNWRyhwYXRoRGF0YSlcbiAgICAgICAgY29uc3QgcGF0aE1ha2VyID0gbmV3IFBhdGhNYWtlcigpXG4gICAgICAgIHBhdGhEYXRhU2VyaWVzLmZvckVhY2gocGF0aERhdGFJdGVtID0+IHtcbiAgICAgICAgICAgIHN3aXRjaCAocGF0aERhdGFJdGVtLmNvZGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdNJzpcbiAgICAgICAgICAgICAgICAgICAgcGF0aE1ha2VyLm1vdmVUbyhwYXRoRGF0YUl0ZW0ueCwgcGF0aERhdGFJdGVtLnkpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgY2FzZSAnTCc6XG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5saW5lVG8ocGF0aERhdGFJdGVtLngsIHBhdGhEYXRhSXRlbS55KVxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIGNhc2UgJ2wnOlxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIubGluZVRvUmVsYXRpdmUocGF0aERhdGFJdGVtLngsIHBhdGhEYXRhSXRlbS55KVxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIGNhc2UgJ0gnOlxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIuaG9yaXpvbnRhbFRvKHBhdGhEYXRhSXRlbS54KVxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIGNhc2UgJ2gnOlxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIuaG9yaXpvbnRhbFRvUmVsYXRpdmUocGF0aERhdGFJdGVtLngpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgY2FzZSAnVic6XG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci52ZXJ0aWNhbFRvKHBhdGhEYXRhSXRlbS55KVxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIGNhc2UgJ3YnOlxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIudmVydGljYWxUb1JlbGF0aXZlKHBhdGhEYXRhSXRlbS55KVxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIGNhc2UgJ0MnOlxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIuY3ViaWNCZXppZXJDdXJ2ZVRvKHBhdGhEYXRhSXRlbS54MSwgcGF0aERhdGFJdGVtLnkxLCBwYXRoRGF0YUl0ZW0ueDIsIHBhdGhEYXRhSXRlbS55MiwgcGF0aERhdGFJdGVtLngsIHBhdGhEYXRhSXRlbS55KVxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIGNhc2UgJ2MnOlxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIuY3ViaWNCZXppZXJDdXJ2ZVRvUmVsYXRpdmUocGF0aERhdGFJdGVtLngxLCBwYXRoRGF0YUl0ZW0ueTEsIHBhdGhEYXRhSXRlbS54MiwgcGF0aERhdGFJdGVtLnkyLCBwYXRoRGF0YUl0ZW0ueCwgcGF0aERhdGFJdGVtLnkpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgY2FzZSAnUSc6XG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5xdWFkcmF0aWNCZXppZXJDdXJ2ZVRvKHBhdGhEYXRhSXRlbS54MSwgcGF0aERhdGFJdGVtLnkxLCBwYXRoRGF0YUl0ZW0ueCwgcGF0aERhdGFJdGVtLnkpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgY2FzZSAncSc6XG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5xdWFkcmF0aWNCZXppZXJDdXJ2ZVRvUmVsYXRpdmUocGF0aERhdGFJdGVtLngxLCBwYXRoRGF0YUl0ZW0ueTEsIHBhdGhEYXRhSXRlbS54LCBwYXRoRGF0YUl0ZW0ueSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICBjYXNlICdBJzpcbiAgICAgICAgICAgICAgICAgICAgcGF0aE1ha2VyLmFyY1RvKHBhdGhEYXRhSXRlbS5yeCwgcGF0aERhdGFJdGVtLnJ5LCBwYXRoRGF0YUl0ZW0ueEFzaXNSb3RhdGlvbiwgfn5wYXRoRGF0YUl0ZW0ubGFyZ2VBcmMsIH5+cGF0aERhdGFJdGVtLnN3ZWVwLCBwYXRoRGF0YUl0ZW0ueCwgcGF0aERhdGFJdGVtLnkpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgY2FzZSAnYSc6XG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5hcmNUb1JlbGF0aXZlKHBhdGhEYXRhSXRlbS5yeCwgcGF0aERhdGFJdGVtLnJ5LCBwYXRoRGF0YUl0ZW0ueEFzaXNSb3RhdGlvbiwgfn5wYXRoRGF0YUl0ZW0ubGFyZ2VBcmMsIH5+cGF0aERhdGFJdGVtLnN3ZWVwLCBwYXRoRGF0YUl0ZW0ueCwgcGF0aERhdGFJdGVtLnkpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgY2FzZSAnWic6XG4gICAgICAgICAgICAgICAgY2FzZSAneic6XG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5jbG9zZVBhdGgoKVxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IocGF0aERhdGFJdGVtKVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGltcGxlbWVudGF0aW9uIGZvdW5kIGZvciB0aGlzIHBhdGggY29tbWFuZC4nKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICBwb3N0QWN0aW9ucyhwYXRoTWFrZXIpXG4gICAgfSBlbHNlIGlmIChkb20gaW5zdGFuY2VvZiBTVkdQb2x5Z29uRWxlbWVudCB8fCBkb20gaW5zdGFuY2VvZiBTVkdQb2x5bGluZUVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgcG9pbnRzID0gZG9tLnBvaW50c1xuICAgICAgICBpZiAocG9pbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgaXRlcmFibGVQb2ludHM6IERPTVBvaW50W10gPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChwb2ludHMpXG4gICAgICAgICAgICBjb25zdCBvZmZzZXRYID0gaXRlcmFibGVQb2ludHMucmVkdWNlKChwLCB2KSA9PiBNYXRoLm1pbihwLCB2LngpLCAwKVxuICAgICAgICAgICAgY29uc3Qgb2Zmc2V0WSA9IGl0ZXJhYmxlUG9pbnRzLnJlZHVjZSgocCwgdikgPT4gTWF0aC5taW4ocCwgdi55KSwgMClcbiAgICAgICAgICAgIGNvbnN0IHBhdGhNYWtlciA9IG5ldyBQYXRoTWFrZXIoKVxuICAgICAgICAgICAgcGF0aE1ha2VyLm1vdmVUbyhwb2ludHNbMF0ueCAtIG9mZnNldFgsIHBvaW50c1swXS55IC0gb2Zmc2V0WSlcbiAgICAgICAgICAgIGl0ZXJhYmxlUG9pbnRzLmZvckVhY2goKHYsIGkpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoaSA8PSAwKSByZXR1cm5cbiAgICAgICAgICAgICAgICBwYXRoTWFrZXIubGluZVRvKHYueCAtIG9mZnNldFgsIHYueSAtIG9mZnNldFkpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgaWYgKGRvbSBpbnN0YW5jZW9mIFNWR1BvbHlnb25FbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgcGF0aE1ha2VyLmNsb3NlUGF0aCgpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwb3N0QWN0aW9ucyhwYXRoTWFrZXIpXG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGRvbSBpbnN0YW5jZW9mIFNWR1JlY3RFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IG1hcEtleTogKCd3aWR0aCcgfCAnaGVpZ2h0JylbXSA9IFsnd2lkdGgnLCAnaGVpZ2h0J11cbiAgICAgICAgY29uc3QgW3dpZHRoLCBoZWlnaHRdID0gbWFwS2V5Lm1hcChrZXkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3ZnTGVuZ3RoID0gZG9tW2tleV0uYmFzZVZhbFxuICAgICAgICAgICAgc3ZnTGVuZ3RoLmNvbnZlcnRUb1NwZWNpZmllZFVuaXRzKFNWR0xlbmd0aC5TVkdfTEVOR1RIVFlQRV9QWClcbiAgICAgICAgICAgIHJldHVybiBzdmdMZW5ndGgudmFsdWVJblNwZWNpZmllZFVuaXRzXG4gICAgICAgIH0pXG4gICAgICAgIGNvbnN0IHBhdGhNYWtlciA9IG5ldyBQYXRoTWFrZXIoKVxuICAgICAgICBwYXRoTWFrZXIubW92ZVRvKDAsIDApXG4gICAgICAgIHBhdGhNYWtlci5saW5lVG8od2lkdGgsIDApXG4gICAgICAgIHBhdGhNYWtlci5saW5lVG8od2lkdGgsIGhlaWdodClcbiAgICAgICAgcGF0aE1ha2VyLmxpbmVUbygwLCBoZWlnaHQpXG4gICAgICAgIHBhdGhNYWtlci5jbG9zZVBhdGgoKVxuICAgICAgICBwb3N0QWN0aW9ucyhwYXRoTWFrZXIpXG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihkb20pXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gaW1wbGVtZW50YXRpb24gZm91bmQgZm9yIHN2ZyBncmFwaGljcyBlbGVtZW50LicpXG4gICAgfVxuICAgIHJldHVybiBncm91cFxufVxuXG5mdW5jdGlvbiByZW5kZXJHcm91cChkb206IFNWR0dFbGVtZW50KTogR3JvdXBTaGFwZSB7XG4gICAgbGV0IGdyb3VwOiBHcm91cFNoYXBlID0ge1xuICAgICAgICB0eTogJ2dyJyxcbiAgICAgICAgaXQ6IFtdLFxuICAgICAgICBubTogZG9tLmlkLFxuICAgICAgICBibTogMCxcbiAgICAgICAgaGQ6IGZhbHNlXG4gICAgfVxuICAgIGRvbS5jaGlsZE5vZGVzLmZvckVhY2gobm9kZSA9PiB7XG4gICAgICAgIGlmIChub2RlIGluc3RhbmNlb2YgU1ZHR3JhcGhpY3NFbGVtZW50KSB7XG4gICAgICAgICAgICBsZXQgY2hpbGQgPSByZW5kZXIobm9kZSlcbiAgICAgICAgICAgIGlmIChjaGlsZC50eSkge1xuICAgICAgICAgICAgICAgIGdyb3VwLml0IS5wdXNoKGNoaWxkKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbiAgICByZXR1cm4gZ3JvdXBcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlclRleHQoZG9tOiBTVkdUZXh0RWxlbWVudCk6IFRleHREYXRhIHtcbiAgICByZXR1cm4ge31cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlckltYWdlKGRvbTogU1ZHSW1hZ2VFbGVtZW50KTogUmVmZXJlbmNlSUQge1xuICAgIHJldHVybiBcIlwiXG59Il19
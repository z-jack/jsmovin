"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.render = render;
exports.renderText = renderText;
exports.renderImage = renderImage;

var _path = require("./path");

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance"); }

function _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

var parseSVG = require('svg-path-parser');

function render(dom) {
  if (dom instanceof SVGTextElement || dom instanceof SVGImageElement) {
    return {};
  } else if (dom instanceof SVGGElement) {
    return renderGroup(dom);
  } else {
    return renderGlyph(dom);
  }
}

function encodeLineCap(type) {
  switch (type) {
    case 'square':
      return 3;

    case 'butt':
      return 1;

    default:
      return 2;
  }
}

function encodeLineJoin(type) {
  switch (type) {
    case 'miter':
      return 1;

    case 'bevel':
      return 3;

    default:
      return 2;
  }
}

function addVisualEncodings(items, styles) {
  if (styles.stroke && styles.stroke !== 'none') {
    items.push({
      ty: 'st',
      c: {
        k: styles.stroke.split('(')[1].split(')')[0].split(',').slice(0, 3).map(function (raw) {
          return parseInt(raw) / 255;
        }).concat(1)
      },
      o: {
        k: parseFloat(styles.strokeOpacity || '1') * 100
      },
      w: {
        k: parseFloat(styles.strokeWidth || '1')
      },
      lc: encodeLineCap(styles.strokeLinecap),
      lj: encodeLineJoin(styles.strokeLinejoin)
    });
  }

  if (styles.fill && styles.fill !== 'none') {
    items.push({
      ty: 'fl',
      c: {
        k: styles.fill.split('(')[1].split(')')[0].split(',').slice(0, 3).map(function (raw) {
          return parseInt(raw) / 255;
        }).concat(1)
      },
      o: {
        k: parseFloat(styles.fillOpacity || '1') * 100
      }
    });
  }

  items.push({
    ty: "tr",
    p: {
      k: [0, 0]
    },
    a: {
      k: [0, 0]
    },
    s: {
      k: [100, 100]
    },
    r: {
      k: 0
    },
    o: {
      k: 100
    },
    sk: {
      k: 0
    },
    sa: {
      k: 0
    }
  });
}

function renderGlyph(dom) {
  var group = {
    ty: "gr",
    it: [],
    bm: 0,
    hd: false
  };

  var postActions = function postActions(pathMaker) {
    pathMaker.uniform();
    group.it.push({
      ty: 'sh',
      ks: {
        k: pathMaker.path,
        a: 0
      },
      nm: dom.id,
      hd: false
    });
    var styles = window.getComputedStyle(dom);
    addVisualEncodings(group.it, styles);
  };

  if (dom instanceof SVGCircleElement) {
    var svgLength = dom.r.baseVal;
    svgLength.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
    var r = svgLength.valueInSpecifiedUnits;
    var pathMaker = new _path.PathMaker();
    pathMaker.moveTo(r, 0);
    pathMaker.arcTo(r, r, 0, 1, 0, r, 2 * r);
    pathMaker.arcTo(r, r, 0, 1, 0, r, 0);
    pathMaker.closePath();
    postActions(pathMaker);
  } else if (dom instanceof SVGEllipseElement) {
    var mapKey = ['rx', 'ry'];

    var _mapKey$map = mapKey.map(function (key) {
      var svgLength = dom[key].baseVal;
      svgLength.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
      return svgLength.valueInSpecifiedUnits;
    }),
        _mapKey$map2 = _slicedToArray(_mapKey$map, 2),
        rx = _mapKey$map2[0],
        ry = _mapKey$map2[1];

    var _pathMaker = new _path.PathMaker();

    _pathMaker.moveTo(rx, 0);

    _pathMaker.arcTo(rx, ry, 0, 1, 0, rx, 2 * ry);

    _pathMaker.arcTo(rx, ry, 0, 1, 0, rx, 0);

    _pathMaker.closePath();

    postActions(_pathMaker);
  } else if (dom instanceof SVGLineElement) {
    var _mapKey = ['x1', 'x2', 'y1', 'y2'];

    var _mapKey$map3 = _mapKey.map(function (key) {
      var svgLength = dom[key].baseVal;
      svgLength.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
      return svgLength.valueInSpecifiedUnits;
    }),
        _mapKey$map4 = _slicedToArray(_mapKey$map3, 4),
        x1 = _mapKey$map4[0],
        x2 = _mapKey$map4[1],
        y1 = _mapKey$map4[2],
        y2 = _mapKey$map4[3];

    var offsetX = Math.min(x1, x2);
    var offsetY = Math.min(y1, y2);

    var _pathMaker2 = new _path.PathMaker();

    _pathMaker2.moveTo(x1 - offsetX, y1 - offsetY);

    _pathMaker2.lineTo(x2 - offsetX, y2 - offsetY);

    postActions(_pathMaker2);
  } else if (dom instanceof SVGPathElement) {
    var pathData = dom.getAttribute('d');
    var pathDataSeries = parseSVG(pathData);

    var _pathMaker3 = new _path.PathMaker();

    pathDataSeries.forEach(function (pathDataItem) {
      switch (pathDataItem.code) {
        case 'M':
          _pathMaker3.moveTo(pathDataItem.x, pathDataItem.y);

          break;

        case 'L':
          _pathMaker3.lineTo(pathDataItem.x, pathDataItem.y);

          break;

        case 'l':
          _pathMaker3.lineToRelative(pathDataItem.x, pathDataItem.y);

          break;

        case 'H':
          _pathMaker3.horizontalTo(pathDataItem.x);

          break;

        case 'h':
          _pathMaker3.horizontalToRelative(pathDataItem.x);

          break;

        case 'V':
          _pathMaker3.verticalTo(pathDataItem.y);

          break;

        case 'v':
          _pathMaker3.verticalToRelative(pathDataItem.y);

          break;

        case 'C':
          _pathMaker3.cubicBezierCurveTo(pathDataItem.x1, pathDataItem.y1, pathDataItem.x2, pathDataItem.y2, pathDataItem.x, pathDataItem.y);

          break;

        case 'c':
          _pathMaker3.cubicBezierCurveToRelative(pathDataItem.x1, pathDataItem.y1, pathDataItem.x2, pathDataItem.y2, pathDataItem.x, pathDataItem.y);

          break;

        case 'Q':
          _pathMaker3.quadraticBezierCurveTo(pathDataItem.x1, pathDataItem.y1, pathDataItem.x, pathDataItem.y);

          break;

        case 'q':
          _pathMaker3.quadraticBezierCurveToRelative(pathDataItem.x1, pathDataItem.y1, pathDataItem.x, pathDataItem.y);

          break;

        case 'A':
          _pathMaker3.arcTo(pathDataItem.rx, pathDataItem.ry, pathDataItem.xAsisRotation, ~~pathDataItem.largeArc, ~~pathDataItem.sweep, pathDataItem.x, pathDataItem.y);

          break;

        case 'a':
          _pathMaker3.arcToRelative(pathDataItem.rx, pathDataItem.ry, pathDataItem.xAsisRotation, ~~pathDataItem.largeArc, ~~pathDataItem.sweep, pathDataItem.x, pathDataItem.y);

          break;

        case 'Z':
        case 'z':
          _pathMaker3.closePath();

          break;

        default:
          console.error(pathDataItem);
          throw new Error('No implementation found for this path command.');
      }
    });
  } else if (dom instanceof SVGPolygonElement || dom instanceof SVGPolylineElement) {
    var points = dom.points;

    if (points.length) {
      var iterablePoints = Array.prototype.slice.call(points);

      var _offsetX = iterablePoints.reduce(function (p, v) {
        return Math.min(p, v.x);
      }, 0);

      var _offsetY = iterablePoints.reduce(function (p, v) {
        return Math.min(p, v.y);
      }, 0);

      var _pathMaker4 = new _path.PathMaker();

      _pathMaker4.moveTo(points[0].x - _offsetX, points[0].y - _offsetY);

      iterablePoints.forEach(function (v, i) {
        if (i <= 0) return;

        _pathMaker4.lineTo(v.x - _offsetX, v.y - _offsetY);
      });

      if (dom instanceof SVGPolygonElement) {
        _pathMaker4.closePath();
      }

      postActions(_pathMaker4);
    }
  } else if (dom instanceof SVGRectElement) {
    var _mapKey2 = ['width', 'height'];

    var _mapKey2$map = _mapKey2.map(function (key) {
      var svgLength = dom[key].baseVal;
      svgLength.convertToSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX);
      return svgLength.valueInSpecifiedUnits;
    }),
        _mapKey2$map2 = _slicedToArray(_mapKey2$map, 2),
        width = _mapKey2$map2[0],
        height = _mapKey2$map2[1];

    var _pathMaker5 = new _path.PathMaker();

    _pathMaker5.moveTo(0, 0);

    _pathMaker5.lineTo(width, 0);

    _pathMaker5.lineTo(width, height);

    _pathMaker5.lineTo(0, height);

    _pathMaker5.closePath();

    postActions(_pathMaker5);
  } else {
    console.error(dom);
    throw new Error('No implementation found for svg graphics element.');
  }

  return group;
}

function renderGroup(dom) {
  var group = {
    ty: 'gr',
    it: [],
    nm: dom.id,
    bm: 0,
    hd: false
  };
  dom.childNodes.forEach(function (node) {
    if (node instanceof SVGGraphicsElement) {
      var child = render(node);

      if (child.ty) {
        group.it.push(child);
      }
    }
  });
  return group;
}

function renderText(dom) {
  return {};
}

function renderImage(dom) {
  return "";
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9yZW5kZXIudHMiXSwibmFtZXMiOlsicGFyc2VTVkciLCJyZXF1aXJlIiwicmVuZGVyIiwiZG9tIiwiU1ZHVGV4dEVsZW1lbnQiLCJTVkdJbWFnZUVsZW1lbnQiLCJTVkdHRWxlbWVudCIsInJlbmRlckdyb3VwIiwicmVuZGVyR2x5cGgiLCJlbmNvZGVMaW5lQ2FwIiwidHlwZSIsImVuY29kZUxpbmVKb2luIiwiYWRkVmlzdWFsRW5jb2RpbmdzIiwiaXRlbXMiLCJzdHlsZXMiLCJzdHJva2UiLCJwdXNoIiwidHkiLCJjIiwiayIsInNwbGl0Iiwic2xpY2UiLCJtYXAiLCJyYXciLCJwYXJzZUludCIsImNvbmNhdCIsIm8iLCJwYXJzZUZsb2F0Iiwic3Ryb2tlT3BhY2l0eSIsInciLCJzdHJva2VXaWR0aCIsImxjIiwic3Ryb2tlTGluZWNhcCIsImxqIiwic3Ryb2tlTGluZWpvaW4iLCJmaWxsIiwiZmlsbE9wYWNpdHkiLCJwIiwiYSIsInMiLCJyIiwic2siLCJzYSIsImdyb3VwIiwiaXQiLCJibSIsImhkIiwicG9zdEFjdGlvbnMiLCJwYXRoTWFrZXIiLCJ1bmlmb3JtIiwia3MiLCJwYXRoIiwibm0iLCJpZCIsIndpbmRvdyIsImdldENvbXB1dGVkU3R5bGUiLCJTVkdDaXJjbGVFbGVtZW50Iiwic3ZnTGVuZ3RoIiwiYmFzZVZhbCIsImNvbnZlcnRUb1NwZWNpZmllZFVuaXRzIiwiU1ZHTGVuZ3RoIiwiU1ZHX0xFTkdUSFRZUEVfUFgiLCJ2YWx1ZUluU3BlY2lmaWVkVW5pdHMiLCJQYXRoTWFrZXIiLCJtb3ZlVG8iLCJhcmNUbyIsImNsb3NlUGF0aCIsIlNWR0VsbGlwc2VFbGVtZW50IiwibWFwS2V5Iiwia2V5IiwicngiLCJyeSIsIlNWR0xpbmVFbGVtZW50IiwieDEiLCJ4MiIsInkxIiwieTIiLCJvZmZzZXRYIiwiTWF0aCIsIm1pbiIsIm9mZnNldFkiLCJsaW5lVG8iLCJTVkdQYXRoRWxlbWVudCIsInBhdGhEYXRhIiwiZ2V0QXR0cmlidXRlIiwicGF0aERhdGFTZXJpZXMiLCJmb3JFYWNoIiwicGF0aERhdGFJdGVtIiwiY29kZSIsIngiLCJ5IiwibGluZVRvUmVsYXRpdmUiLCJob3Jpem9udGFsVG8iLCJob3Jpem9udGFsVG9SZWxhdGl2ZSIsInZlcnRpY2FsVG8iLCJ2ZXJ0aWNhbFRvUmVsYXRpdmUiLCJjdWJpY0JlemllckN1cnZlVG8iLCJjdWJpY0JlemllckN1cnZlVG9SZWxhdGl2ZSIsInF1YWRyYXRpY0JlemllckN1cnZlVG8iLCJxdWFkcmF0aWNCZXppZXJDdXJ2ZVRvUmVsYXRpdmUiLCJ4QXNpc1JvdGF0aW9uIiwibGFyZ2VBcmMiLCJzd2VlcCIsImFyY1RvUmVsYXRpdmUiLCJjb25zb2xlIiwiZXJyb3IiLCJFcnJvciIsIlNWR1BvbHlnb25FbGVtZW50IiwiU1ZHUG9seWxpbmVFbGVtZW50IiwicG9pbnRzIiwibGVuZ3RoIiwiaXRlcmFibGVQb2ludHMiLCJBcnJheSIsInByb3RvdHlwZSIsImNhbGwiLCJyZWR1Y2UiLCJ2IiwiaSIsIlNWR1JlY3RFbGVtZW50Iiwid2lkdGgiLCJoZWlnaHQiLCJjaGlsZE5vZGVzIiwibm9kZSIsIlNWR0dyYXBoaWNzRWxlbWVudCIsImNoaWxkIiwicmVuZGVyVGV4dCIsInJlbmRlckltYWdlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFDQTs7Ozs7Ozs7OztBQUVBLElBQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLGlCQUFELENBQXhCOztBQWlDTyxTQUFTQyxNQUFULENBQWdCQyxHQUFoQixFQUFxRDtBQUN4RCxNQUFJQSxHQUFHLFlBQVlDLGNBQWYsSUFBaUNELEdBQUcsWUFBWUUsZUFBcEQsRUFBcUU7QUFDakUsV0FBTyxFQUFQO0FBQ0gsR0FGRCxNQUVPLElBQUlGLEdBQUcsWUFBWUcsV0FBbkIsRUFBZ0M7QUFDbkMsV0FBT0MsV0FBVyxDQUFDSixHQUFELENBQWxCO0FBQ0gsR0FGTSxNQUVBO0FBQ0gsV0FBT0ssV0FBVyxDQUFDTCxHQUFELENBQWxCO0FBQ0g7QUFDSjs7QUFFRCxTQUFT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SUFBSXVHLEtBQUosQ0FBVSxtREFBVixDQUFOO0FBQ0g7O0FBQ0QsU0FBTy9ELEtBQVA7QUFDSDs7QUFFRCxTQUFTcEMsV0FBVCxDQUFxQkosR0FBckIsRUFBbUQ7QUFDL0MsTUFBSXdDLEtBQWlCLEdBQUc7QUFDcEIxQixJQUFBQSxFQUFFLEVBQUUsSUFEZ0I7QUFFcEIyQixJQUFBQSxFQUFFLEVBQUUsRUFGZ0I7QUFHcEJRLElBQUFBLEVBQUUsRUFBRWpELEdBQUcsQ0FBQ2tELEVBSFk7QUFJcEJSLElBQUFBLEVBQUUsRUFBRSxDQUpnQjtBQUtwQkMsSUFBQUEsRUFBRSxFQUFFO0FBTGdCLEdBQXhCO0FBT0EzQyxFQUFBQSxHQUFHLENBQUNzSCxVQUFKLENBQWVuQyxPQUFmLENBQXVCLFVBQUFvQyxJQUFJLEVBQUk7QUFDM0IsUUFBSUEsSUFBSSxZQUFZQyxrQkFBcEIsRUFBd0M7QUFDcEMsVUFBSUMsS0FBSyxHQUFHMUgsTUFBTSxDQUFDd0gsSUFBRCxDQUFsQjs7QUFDQSxVQUFJRSxLQUFLLENBQUMzRyxFQUFWLEVBQWM7QUFDVjBCLFFBQUFBLEtBQUssQ0FBQ0MsRUFBTixDQUFVNUIsSUFBVixDQUFlNEcsS0FBZjtBQUNIO0FBQ0o7QUFDSixHQVBEO0FBUUEsU0FBT2pGLEtBQVA7QUFDSDs7QUFFTSxTQUFTa0YsVUFBVCxDQUFvQjFILEdBQXBCLEVBQW1EO0FBQ3RELFNBQU8sRUFBUDtBQUNIOztBQUVNLFNBQVMySCxXQUFULENBQXFCM0gsR0FBckIsRUFBd0Q7QUFDM0QsU0FBTyxFQUFQO0FBQ0giLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBHcm91cFNoYXBlLCBUZXh0RGF0YSwgUmVmZXJlbmNlSUQsIFBhdGhTaGFwZSwgRmlsbFNoYXBlLCBTdHJva2VTaGFwZSwgVHJhbnNmb3JtU2hhcGUgfSBmcm9tICcuL2FuaW1hdGlvbidcbmltcG9ydCB7IFBhdGhNYWtlciB9IGZyb20gJy4vcGF0aCdcblxuY29uc3QgcGFyc2VTVkcgPSByZXF1aXJlKCdzdmctcGF0aC1wYXJzZXInKVxudHlwZSBQYXRoUGFyc2VyUmVzdWx0ID0ge1xuICAgIGNvZGU6ICdNJyB8ICdMJyB8ICdIJyB8ICdWJyB8ICdtJyB8ICdsJyB8ICdoJyB8ICd2JyxcbiAgICBjb21tYW5kOiBzdHJpbmcsXG4gICAgeDogbnVtYmVyLFxuICAgIHk6IG51bWJlcixcbiAgICByZWxhdGl2ZTogYm9vbGVhblxufSB8IHtcbiAgICBjb2RlOiAnQycgfCAnYycgfCAnUycgfCAncycgfCAnUScgfCAncScgfCAnVCcgfCAndCcsXG4gICAgY29tbWFuZDogc3RyaW5nLFxuICAgIHg6IG51bWJlcixcbiAgICB5OiBudW1iZXIsXG4gICAgcmVsYXRpdmU6IGJvb2xlYW4sXG4gICAgeDE6IG51bWJlcixcbiAgICB4MjogbnVtYmVyLFxuICAgIHkxOiBudW1iZXIsXG4gICAgeTI6IG51bWJlclxufSB8IHtcbiAgICBjb2RlOiAnQScgfCAnYScsXG4gICAgY29tbWFuZDogc3RyaW5nLFxuICAgIHg6IG51bWJlcixcbiAgICB5OiBudW1iZXIsXG4gICAgcmVsYXRpdmU6IGJvb2xlYW4sXG4gICAgcng6IG51bWJlcixcbiAgICByeTogbnVtYmVyLFxuICAgIHhBc2lzUm90YXRpb246IG51bWJlcixcbiAgICBsYXJnZUFyYzogYm9vbGVhbixcbiAgICBzd2VlcDogYm9vbGVhblxufSB8IHtcbiAgICBjb2RlOiAnWicgfCAneicsXG4gICAgY29tbWFuZDogc3RyaW5nXG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW5kZXIoZG9tOiBTVkdHcmFwaGljc0VsZW1lbnQpOiBHcm91cFNoYXBlIHtcbiAgICBpZiAoZG9tIGluc3RhbmNlb2YgU1ZHVGV4dEVsZW1lbnQgfHwgZG9tIGluc3RhbmNlb2YgU1ZHSW1hZ2VFbGVtZW50KSB7XG4gICAgICAgIHJldHVybiB7fVxuICAgIH0gZWxzZSBpZiAoZG9tIGluc3RhbmNlb2YgU1ZHR0VsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHJlbmRlckdyb3VwKGRvbSlcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gcmVuZGVyR2x5cGgoZG9tKVxuICAgIH1cbn1cblxuZnVuY3Rpb24gZW5jb2RlTGluZUNhcCh0eXBlPzogc3RyaW5nIHwgbnVsbCk6IG51bWJlciB7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgIGNhc2UgJ3NxdWFyZSc6XG4gICAgICAgICAgICByZXR1cm4gM1xuICAgICAgICBjYXNlICdidXR0JzpcbiAgICAgICAgICAgIHJldHVybiAxXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gMlxuICAgIH1cbn1cblxuZnVuY3Rpb24gZW5jb2RlTGluZUpvaW4odHlwZT86IHN0cmluZyB8IG51bGwpOiBudW1iZXIge1xuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICBjYXNlICdtaXRlcic6XG4gICAgICAgICAgICByZXR1cm4gMVxuICAgICAgICBjYXNlICdiZXZlbCc6XG4gICAgICAgICAgICByZXR1cm4gM1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIDJcbiAgICB9XG59XG5cbnR5cGUgVmlzdWFsR3JvdXBJdGVtID0gUGF0aFNoYXBlIHwgRmlsbFNoYXBlIHwgU3Ryb2tlU2hhcGUgfCBUcmFuc2Zvcm1TaGFwZVxuXG5mdW5jdGlvbiBhZGRWaXN1YWxFbmNvZGluZ3MoaXRlbXM6IFZpc3VhbEdyb3VwSXRlbVtdLCBzdHlsZXM6IENTU1N0eWxlRGVjbGFyYXRpb24pIHtcbiAgICBpZiAoc3R5bGVzLnN0cm9rZSAmJiBzdHlsZXMuc3Ryb2tlICE9PSAnbm9uZScpIHtcbiAgICAgICAgaXRlbXMucHVzaCh7XG4gICAgICAgICAgICB0eTogJ3N0JyxcbiAgICAgICAgICAgIGM6IHtcbiAgICAgICAgICAgICAgICBrOiBzdHlsZXMuc3Ryb2tlIS5zcGxpdCgnKCcpWzFdLnNwbGl0KCcpJylbMF0uc3BsaXQoJywnKS5zbGljZSgwLCAzKS5tYXAoKHJhdzogc3RyaW5nKSA9PiBwYXJzZUludChyYXcpIC8gMjU1KS5jb25jYXQoMSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvOiB7XG4gICAgICAgICAgICAgICAgazogcGFyc2VGbG9hdChzdHlsZXMuc3Ryb2tlT3BhY2l0eSB8fCAnMScpICogMTAwXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdzoge1xuICAgICAgICAgICAgICAgIGs6IHBhcnNlRmxvYXQoc3R5bGVzLnN0cm9rZVdpZHRoIHx8ICcxJylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsYzogZW5jb2RlTGluZUNhcChzdHlsZXMuc3Ryb2tlTGluZWNhcCksXG4gICAgICAgICAgICBsajogZW5jb2RlTGluZUpvaW4oc3R5bGVzLnN0cm9rZUxpbmVqb2luKVxuICAgICAgICB9KVxuICAgIH1cbiAgICBpZiAoc3R5bGVzLmZpbGwgJiYgc3R5bGVzLmZpbGwgIT09ICdub25lJykge1xuICAgICAgICBpdGVtcy5wdXNoKHtcbiAgICAgICAgICAgIHR5OiAnZmwnLFxuICAgICAgICAgICAgYzoge1xuICAgICAgICAgICAgICAgIGs6IHN0eWxlcy5maWxsIS5zcGxpdCgnKCcpWzFdLnNwbGl0KCcpJylbMF0uc3BsaXQoJywnKS5zbGljZSgwLCAzKS5tYXAoKHJhdzogc3RyaW5nKSA9PiBwYXJzZUludChyYXcpIC8gMjU1KS5jb25jYXQoMSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvOiB7XG4gICAgICAgICAgICAgICAgazogcGFyc2VGbG9hdChzdHlsZXMuZmlsbE9wYWNpdHkgfHwgJzEnKSAqIDEwMFxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cbiAgICBpdGVtcy5wdXNoKHtcbiAgICAgICAgdHk6IFwidHJcIixcbiAgICAgICAgcDoge1xuICAgICAgICAgICAgazogW1xuICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgMFxuICAgICAgICAgICAgXVxuICAgICAgICB9LFxuICAgICAgICBhOiB7XG4gICAgICAgICAgICBrOiBbXG4gICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICAwXG4gICAgICAgICAgICBdXG4gICAgICAgIH0sXG4gICAgICAgIHM6IHtcbiAgICAgICAgICAgIGs6IFtcbiAgICAgICAgICAgICAgICAxMDAsXG4gICAgICAgICAgICAgICAgMTAwXG4gICAgICAgICAgICBdXG4gICAgICAgIH0sXG4gICAgICAgIHI6IHtcbiAgICAgICAgICAgIGs6IDBcbiAgICAgICAgfSxcbiAgICAgICAgbzoge1xuICAgICAgICAgICAgazogMTAwXG4gICAgICAgIH0sXG4gICAgICAgIHNrOiB7XG4gICAgICAgICAgICBrOiAwXG4gICAgICAgIH0sXG4gICAgICAgIHNhOiB7XG4gICAgICAgICAgICBrOiAwXG4gICAgICAgIH1cbiAgICB9KVxufVxuXG5mdW5jdGlvbiByZW5kZXJHbHlwaChkb206IFNWR0dyYXBoaWNzRWxlbWVudCk6IEdyb3VwU2hhcGUge1xuICAgIGNvbnN0IGdyb3VwOiBHcm91cFNoYXBlID0ge1xuICAgICAgICB0eTogXCJnclwiLFxuICAgICAgICBpdDogW10sXG4gICAgICAgIGJtOiAwLFxuICAgICAgICBoZDogZmFsc2VcbiAgICB9XG4gICAgY29uc3QgcG9zdEFjdGlvbnMgPSAocGF0aE1ha2VyOiBQYXRoTWFrZXIpID0+IHtcbiAgICAgICAgcGF0aE1ha2VyLnVuaWZvcm0oKVxuICAgICAgICBncm91cC5pdCEucHVzaCh7XG4gICAgICAgICAgICB0eTogJ3NoJyxcbiAgICAgICAgICAgIGtzOiB7XG4gICAgICAgICAgICAgICAgazogcGF0aE1ha2VyLnBhdGgsXG4gICAgICAgICAgICAgICAgYTogMFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG5tOiBkb20uaWQsXG4gICAgICAgICAgICBoZDogZmFsc2VcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3Qgc3R5bGVzID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZG9tKVxuICAgICAgICBhZGRWaXN1YWxFbmNvZGluZ3MoZ3JvdXAuaXQhIGFzIFZpc3VhbEdyb3VwSXRlbVtdLCBzdHlsZXMpXG4gICAgfVxuICAgIGlmIChkb20gaW5zdGFuY2VvZiBTVkdDaXJjbGVFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IHN2Z0xlbmd0aCA9IGRvbS5yLmJhc2VWYWxcbiAgICAgICAgc3ZnTGVuZ3RoLmNvbnZlcnRUb1NwZWNpZmllZFVuaXRzKFNWR0xlbmd0aC5TVkdfTEVOR1RIVFlQRV9QWClcbiAgICAgICAgY29uc3QgciA9IHN2Z0xlbmd0aC52YWx1ZUluU3BlY2lmaWVkVW5pdHNcbiAgICAgICAgY29uc3QgcGF0aE1ha2VyID0gbmV3IFBhdGhNYWtlcigpXG4gICAgICAgIHBhdGhNYWtlci5tb3ZlVG8ociwgMClcbiAgICAgICAgcGF0aE1ha2VyLmFyY1RvKHIsIHIsIDAsIDEsIDAsIHIsIDIgKiByKVxuICAgICAgICBwYXRoTWFrZXIuYXJjVG8ociwgciwgMCwgMSwgMCwgciwgMClcbiAgICAgICAgcGF0aE1ha2VyLmNsb3NlUGF0aCgpXG4gICAgICAgIHBvc3RBY3Rpb25zKHBhdGhNYWtlcilcbiAgICB9IGVsc2UgaWYgKGRvbSBpbnN0YW5jZW9mIFNWR0VsbGlwc2VFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IG1hcEtleTogKCdyeCcgfCAncnknKVtdID0gWydyeCcsICdyeSddXG4gICAgICAgIGNvbnN0IFtyeCwgcnldID0gbWFwS2V5Lm1hcChrZXkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3ZnTGVuZ3RoID0gZG9tW2tleV0uYmFzZVZhbFxuICAgICAgICAgICAgc3ZnTGVuZ3RoLmNvbnZlcnRUb1NwZWNpZmllZFVuaXRzKFNWR0xlbmd0aC5TVkdfTEVOR1RIVFlQRV9QWClcbiAgICAgICAgICAgIHJldHVybiBzdmdMZW5ndGgudmFsdWVJblNwZWNpZmllZFVuaXRzXG4gICAgICAgIH0pXG4gICAgICAgIGNvbnN0IHBhdGhNYWtlciA9IG5ldyBQYXRoTWFrZXIoKVxuICAgICAgICBwYXRoTWFrZXIubW92ZVRvKHJ4LCAwKVxuICAgICAgICBwYXRoTWFrZXIuYXJjVG8ocngsIHJ5LCAwLCAxLCAwLCByeCwgMiAqIHJ5KVxuICAgICAgICBwYXRoTWFrZXIuYXJjVG8ocngsIHJ5LCAwLCAxLCAwLCByeCwgMClcbiAgICAgICAgcGF0aE1ha2VyLmNsb3NlUGF0aCgpXG4gICAgICAgIHBvc3RBY3Rpb25zKHBhdGhNYWtlcilcbiAgICB9IGVsc2UgaWYgKGRvbSBpbnN0YW5jZW9mIFNWR0xpbmVFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IG1hcEtleTogKCd4MScgfCAneDInIHwgJ3kxJyB8ICd5MicpW10gPSBbJ3gxJywgJ3gyJywgJ3kxJywgJ3kyJ11cbiAgICAgICAgY29uc3QgW3gxLCB4MiwgeTEsIHkyXSA9IG1hcEtleS5tYXAoa2V5ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN2Z0xlbmd0aCA9IGRvbVtrZXldLmJhc2VWYWxcbiAgICAgICAgICAgIHN2Z0xlbmd0aC5jb252ZXJ0VG9TcGVjaWZpZWRVbml0cyhTVkdMZW5ndGguU1ZHX0xFTkdUSFRZUEVfUFgpXG4gICAgICAgICAgICByZXR1cm4gc3ZnTGVuZ3RoLnZhbHVlSW5TcGVjaWZpZWRVbml0c1xuICAgICAgICB9KVxuICAgICAgICBjb25zdCBvZmZzZXRYID0gTWF0aC5taW4oeDEsIHgyKVxuICAgICAgICBjb25zdCBvZmZzZXRZID0gTWF0aC5taW4oeTEsIHkyKVxuICAgICAgICBjb25zdCBwYXRoTWFrZXIgPSBuZXcgUGF0aE1ha2VyKClcbiAgICAgICAgcGF0aE1ha2VyLm1vdmVUbyh4MSAtIG9mZnNldFgsIHkxIC0gb2Zmc2V0WSlcbiAgICAgICAgcGF0aE1ha2VyLmxpbmVUbyh4MiAtIG9mZnNldFgsIHkyIC0gb2Zmc2V0WSlcbiAgICAgICAgcG9zdEFjdGlvbnMocGF0aE1ha2VyKVxuICAgIH0gZWxzZSBpZiAoZG9tIGluc3RhbmNlb2YgU1ZHUGF0aEVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgcGF0aERhdGEgPSBkb20uZ2V0QXR0cmlidXRlKCdkJylcbiAgICAgICAgY29uc3QgcGF0aERhdGFTZXJpZXM6IFBhdGhQYXJzZXJSZXN1bHRbXSA9IHBhcnNlU1ZHKHBhdGhEYXRhKVxuICAgICAgICBjb25zdCBwYXRoTWFrZXIgPSBuZXcgUGF0aE1ha2VyKClcbiAgICAgICAgcGF0aERhdGFTZXJpZXMuZm9yRWFjaChwYXRoRGF0YUl0ZW0gPT4ge1xuICAgICAgICAgICAgc3dpdGNoIChwYXRoRGF0YUl0ZW0uY29kZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ00nOlxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIubW92ZVRvKHBhdGhEYXRhSXRlbS54LCBwYXRoRGF0YUl0ZW0ueSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICBjYXNlICdMJzpcbiAgICAgICAgICAgICAgICAgICAgcGF0aE1ha2VyLmxpbmVUbyhwYXRoRGF0YUl0ZW0ueCwgcGF0aERhdGFJdGVtLnkpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgY2FzZSAnbCc6XG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5saW5lVG9SZWxhdGl2ZShwYXRoRGF0YUl0ZW0ueCwgcGF0aERhdGFJdGVtLnkpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgY2FzZSAnSCc6XG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5ob3Jpem9udGFsVG8ocGF0aERhdGFJdGVtLngpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgY2FzZSAnaCc6XG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5ob3Jpem9udGFsVG9SZWxhdGl2ZShwYXRoRGF0YUl0ZW0ueClcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICBjYXNlICdWJzpcbiAgICAgICAgICAgICAgICAgICAgcGF0aE1ha2VyLnZlcnRpY2FsVG8ocGF0aERhdGFJdGVtLnkpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgY2FzZSAndic6XG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci52ZXJ0aWNhbFRvUmVsYXRpdmUocGF0aERhdGFJdGVtLnkpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgY2FzZSAnQyc6XG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5jdWJpY0JlemllckN1cnZlVG8ocGF0aERhdGFJdGVtLngxLCBwYXRoRGF0YUl0ZW0ueTEsIHBhdGhEYXRhSXRlbS54MiwgcGF0aERhdGFJdGVtLnkyLCBwYXRoRGF0YUl0ZW0ueCwgcGF0aERhdGFJdGVtLnkpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgY2FzZSAnYyc6XG4gICAgICAgICAgICAgICAgICAgIHBhdGhNYWtlci5jdWJpY0JlemllckN1cnZlVG9SZWxhdGl2ZShwYXRoRGF0YUl0ZW0ueDEsIHBhdGhEYXRhSXRlbS55MSwgcGF0aERhdGFJdGVtLngyLCBwYXRoRGF0YUl0ZW0ueTIsIHBhdGhEYXRhSXRlbS54LCBwYXRoRGF0YUl0ZW0ueSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICBjYXNlICdRJzpcbiAgICAgICAgICAgICAgICAgICAgcGF0aE1ha2VyLnF1YWRyYXRpY0JlemllckN1cnZlVG8ocGF0aERhdGFJdGVtLngxLCBwYXRoRGF0YUl0ZW0ueTEsIHBhdGhEYXRhSXRlbS54LCBwYXRoRGF0YUl0ZW0ueSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICBjYXNlICdxJzpcbiAgICAgICAgICAgICAgICAgICAgcGF0aE1ha2VyLnF1YWRyYXRpY0JlemllckN1cnZlVG9SZWxhdGl2ZShwYXRoRGF0YUl0ZW0ueDEsIHBhdGhEYXRhSXRlbS55MSwgcGF0aERhdGFJdGVtLngsIHBhdGhEYXRhSXRlbS55KVxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIGNhc2UgJ0EnOlxuICAgICAgICAgICAgICAgICAgICBwYXRoTWFrZXIuYXJjVG8ocGF0aERhdGFJdGVtLnJ4LCBwYXRoRGF0YUl0ZW0ucnksIHBhdGhEYXRhSXRlbS54QXNpc1JvdGF0aW9uLCB+fnBhdGhEYXRhSXRlbS5sYXJnZUFyYywgfn5wYXRoRGF0YUl0ZW0uc3dlZXAsIHBhdGhEYXRhSXRlbS54LCBwYXRoRGF0YUl0ZW0ueSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICBjYXNlICdhJzpcbiAgICAgICAgICAgICAgICAgICAgcGF0aE1ha2VyLmFyY1RvUmVsYXRpdmUocGF0aERhdGFJdGVtLnJ4LCBwYXRoRGF0YUl0ZW0ucnksIHBhdGhEYXRhSXRlbS54QXNpc1JvdGF0aW9uLCB+fnBhdGhEYXRhSXRlbS5sYXJnZUFyYywgfn5wYXRoRGF0YUl0ZW0uc3dlZXAsIHBhdGhEYXRhSXRlbS54LCBwYXRoRGF0YUl0ZW0ueSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICBjYXNlICdaJzpcbiAgICAgICAgICAgICAgICBjYXNlICd6JzpcbiAgICAgICAgICAgICAgICAgICAgcGF0aE1ha2VyLmNsb3NlUGF0aCgpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihwYXRoRGF0YUl0ZW0pXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gaW1wbGVtZW50YXRpb24gZm91bmQgZm9yIHRoaXMgcGF0aCBjb21tYW5kLicpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfSBlbHNlIGlmIChkb20gaW5zdGFuY2VvZiBTVkdQb2x5Z29uRWxlbWVudCB8fCBkb20gaW5zdGFuY2VvZiBTVkdQb2x5bGluZUVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgcG9pbnRzID0gZG9tLnBvaW50c1xuICAgICAgICBpZiAocG9pbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgaXRlcmFibGVQb2ludHM6IERPTVBvaW50W10gPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChwb2ludHMpXG4gICAgICAgICAgICBjb25zdCBvZmZzZXRYID0gaXRlcmFibGVQb2ludHMucmVkdWNlKChwLCB2KSA9PiBNYXRoLm1pbihwLCB2LngpLCAwKVxuICAgICAgICAgICAgY29uc3Qgb2Zmc2V0WSA9IGl0ZXJhYmxlUG9pbnRzLnJlZHVjZSgocCwgdikgPT4gTWF0aC5taW4ocCwgdi55KSwgMClcbiAgICAgICAgICAgIGNvbnN0IHBhdGhNYWtlciA9IG5ldyBQYXRoTWFrZXIoKVxuICAgICAgICAgICAgcGF0aE1ha2VyLm1vdmVUbyhwb2ludHNbMF0ueCAtIG9mZnNldFgsIHBvaW50c1swXS55IC0gb2Zmc2V0WSlcbiAgICAgICAgICAgIGl0ZXJhYmxlUG9pbnRzLmZvckVhY2goKHYsIGkpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoaSA8PSAwKSByZXR1cm5cbiAgICAgICAgICAgICAgICBwYXRoTWFrZXIubGluZVRvKHYueCAtIG9mZnNldFgsIHYueSAtIG9mZnNldFkpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgaWYgKGRvbSBpbnN0YW5jZW9mIFNWR1BvbHlnb25FbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgcGF0aE1ha2VyLmNsb3NlUGF0aCgpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwb3N0QWN0aW9ucyhwYXRoTWFrZXIpXG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGRvbSBpbnN0YW5jZW9mIFNWR1JlY3RFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IG1hcEtleTogKCd3aWR0aCcgfCAnaGVpZ2h0JylbXSA9IFsnd2lkdGgnLCAnaGVpZ2h0J11cbiAgICAgICAgY29uc3QgW3dpZHRoLCBoZWlnaHRdID0gbWFwS2V5Lm1hcChrZXkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3ZnTGVuZ3RoID0gZG9tW2tleV0uYmFzZVZhbFxuICAgICAgICAgICAgc3ZnTGVuZ3RoLmNvbnZlcnRUb1NwZWNpZmllZFVuaXRzKFNWR0xlbmd0aC5TVkdfTEVOR1RIVFlQRV9QWClcbiAgICAgICAgICAgIHJldHVybiBzdmdMZW5ndGgudmFsdWVJblNwZWNpZmllZFVuaXRzXG4gICAgICAgIH0pXG4gICAgICAgIGNvbnN0IHBhdGhNYWtlciA9IG5ldyBQYXRoTWFrZXIoKVxuICAgICAgICBwYXRoTWFrZXIubW92ZVRvKDAsIDApXG4gICAgICAgIHBhdGhNYWtlci5saW5lVG8od2lkdGgsIDApXG4gICAgICAgIHBhdGhNYWtlci5saW5lVG8od2lkdGgsIGhlaWdodClcbiAgICAgICAgcGF0aE1ha2VyLmxpbmVUbygwLCBoZWlnaHQpXG4gICAgICAgIHBhdGhNYWtlci5jbG9zZVBhdGgoKVxuICAgICAgICBwb3N0QWN0aW9ucyhwYXRoTWFrZXIpXG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihkb20pXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gaW1wbGVtZW50YXRpb24gZm91bmQgZm9yIHN2ZyBncmFwaGljcyBlbGVtZW50LicpXG4gICAgfVxuICAgIHJldHVybiBncm91cFxufVxuXG5mdW5jdGlvbiByZW5kZXJHcm91cChkb206IFNWR0dFbGVtZW50KTogR3JvdXBTaGFwZSB7XG4gICAgbGV0IGdyb3VwOiBHcm91cFNoYXBlID0ge1xuICAgICAgICB0eTogJ2dyJyxcbiAgICAgICAgaXQ6IFtdLFxuICAgICAgICBubTogZG9tLmlkLFxuICAgICAgICBibTogMCxcbiAgICAgICAgaGQ6IGZhbHNlXG4gICAgfVxuICAgIGRvbS5jaGlsZE5vZGVzLmZvckVhY2gobm9kZSA9PiB7XG4gICAgICAgIGlmIChub2RlIGluc3RhbmNlb2YgU1ZHR3JhcGhpY3NFbGVtZW50KSB7XG4gICAgICAgICAgICBsZXQgY2hpbGQgPSByZW5kZXIobm9kZSlcbiAgICAgICAgICAgIGlmIChjaGlsZC50eSkge1xuICAgICAgICAgICAgICAgIGdyb3VwLml0IS5wdXNoKGNoaWxkKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbiAgICByZXR1cm4gZ3JvdXBcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlclRleHQoZG9tOiBTVkdUZXh0RWxlbWVudCk6IFRleHREYXRhIHtcbiAgICByZXR1cm4ge31cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlckltYWdlKGRvbTogU1ZHSW1hZ2VFbGVtZW50KTogUmVmZXJlbmNlSUQge1xuICAgIHJldHVybiBcIlwiXG59Il19